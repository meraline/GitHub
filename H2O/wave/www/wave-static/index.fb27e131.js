var bi=Object.defineProperty,Ei=Object.defineProperties;var wi=Object.getOwnPropertyDescriptors;var Xn=Object.getOwnPropertySymbols;var ki=Object.prototype.hasOwnProperty,Ci=Object.prototype.propertyIsEnumerable;var Un=(e,a,n)=>a in e?bi(e,a,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[a]=n,L=(e,a)=>{for(var n in a||(a={}))ki.call(a,n)&&Un(e,n,a[n]);if(Xn)for(var n of Xn(a))Ci.call(a,n)&&Un(e,n,a[n]);return e},Z=(e,a)=>Ei(e,wi(a));import{t as $i,d as N,g as _e,T as _t,B as st,i as nt,c as Ni,h as Gn,l as Xr,r as Ye,s as F,I as $e,C as Pa,a as Si,H as Ta,b as _i,R as t,m as Pi,e as cn,F as it,S as Re,A as kt,L as ze,f as Et,j as dn,P as Oe,D as Ue,k as Yt,n as He,o as pe,p as Ti,q as Ie,u as Di,v as Ur,w as Li,x as Da,y as Gr,z as Ai,E as La,G as Jt,J as lt,K as qr,M as $n,N as Nn,O as Qr,Q as Sn,U as Aa,V as Ri,W as Ii,X as Ut,Y as Xe,Z as mn,_ as Kr,$ as Yr,a0 as rt,a1 as Jr,a2 as zi,a3 as Zr,a4 as el,a5 as tl,a6 as Zt,a7 as Ea,a8 as Ma,a9 as qn,aa as Bi,ab as Mi,ac as Fi,ad as Wi,ae as Hi,af as Oi,ag as Vi,ah as Qn,ai as ji,aj as Xi,ak as Ui,al as Gi,am as qi,an as al,ao as nl,ap as Qi,aq as rl,ar as Ki,as as _n,at as Pn,au as Yi,av as Kn,aw as Ra,ax as ll,ay as ia,az as Ji,aA as Bt,aB as il,aC as Ia,aD as Zi,aE as eo,aF as to,aG as ao,aH as no,aI as ro,aJ as ol,aK as lo,aL as io,aM as oo,aN as so,aO as co,aP as mo,aQ as sl,aR as cl,aS as dl,aT as uo,aU as go,aV as po,aW as ml,aX as un,aY as fo,aZ as ho,a_ as yo,a$ as vo,b0 as xo,b1 as bo,b2 as Eo,b3 as wo,b4 as ko}from"./vendor.9571d771.js";function gu(){import("data:text/javascript,")}const Co=function(){const a=document.createElement("link").relList;if(a&&a.supports&&a.supports("modulepreload"))return;for(const l of document.querySelectorAll('link[rel="modulepreload"]'))r(l);new MutationObserver(l=>{for(const i of l)if(i.type==="childList")for(const o of i.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function n(l){const i={};return l.integrity&&(i.integrity=l.integrity),l.referrerpolicy&&(i.referrerPolicy=l.referrerpolicy),l.crossorigin==="use-credentials"?i.credentials="include":l.crossorigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function r(l){if(l.ep)return;l.ep=!0;const i=n(l);fetch(l.href,i)}};Co();const ge=e=>`${e}px`,Ne=e=>`${e}%`,ul=e=>`${e}rem`,M=(...e)=>e.join(" "),xe=(e,a)=>`${e}px solid ${a}`,$o=(e,a)=>`${e}px dashed ${a}`,ye=e=>`${e} !important`,be=(...e)=>e.map(ge).join(" "),ve=be,Je=()=>({display:"flex",alignItems:"center",justifyContent:"center"}),f=(e="$gray")=>e.startsWith("$")?`var(--${e.substring(1)}, var(--gray))`:e,ae=e=>e.startsWith("$")?(e=e.substring(1),getComputedStyle(document.body).getPropertyValue(`--${e}`).trim()):e,Nt=e=>(e==null?void 0:e.includes("%"))?"100%":e,gl=24,Ht={amber:"#ffc107",azure:"#03a9f4",black:"#000",blue:"#2196f3",brown:"#795548",cyan:"#00bcd4",gray:"#9e9e9e",green:"#8bc34a",indigo:"#3f51b5",lime:"#cddc39",mint:"#4caf50",orange:"#ff9800",pink:"#e91e63",purple:"#9c27b0",red:"#f44336",tangerine:"#ff5722",teal:"#009688",violet:"#673ab7",white:"#fff",yellow:"#ffeb3b"},Gt=e=>{const a=_e(e.startsWith("$")?ae(e):e);if(!a)return"black";const{r:n,g:r,b:l}=a;return(n*299+r*587+l*114)/1e3>=128?"black":"white"},wa={default:{palette:{card:"#ffffff",page:"#f5f5f5",text:"#323130"},fluentPalette:{black:"#000000",neutralDark:"#201f1e",neutralLight:"#edebe9",neutralLighter:"#f3f2f1",neutralLighterAlt:"#faf9f8",neutralPrimary:"#323130",neutralPrimaryAlt:"#3b3a39",neutralQuaternary:"#d0d0d0",neutralQuaternaryAlt:"#e1dfdd",neutralSecondary:"#605e5c",neutralTertiary:"#a19f9d",neutralTertiaryAlt:"#c8c6c4",themeDark:"#151515",themeDarkAlt:"#252525",themeDarker:"#0b0b0b",themeLight:"#595959",themeLighter:"#737373",themeLighterAlt:"#898989",themePrimary:"#000000",themeSecondary:"#2f2f2f",themeTertiary:"#373737",white:"#ffffff"}},neon:{palette:{card:"#0d0e0f",page:"#1b1d1f",text:"#ffffff"},fluentPalette:{black:"#f8f8f8",neutralDark:"#f4f4f4",neutralLight:"#2c2f32",neutralLighter:"#1f2123",neutralLighterAlt:"#16181a",neutralPrimary:"#fff",neutralPrimaryAlt:"#dadada",neutralQuaternary:"#3c4043",neutralQuaternaryAlt:"#35383b",neutralSecondary:"#d0d0d0",neutralTertiary:"#c8c8c8",neutralTertiaryAlt:"#5b5f63",themeDark:"#d7e464",themeDarkAlt:"#d0df4a",themeDarker:"#e1eb8a",themeLight:"#3d4211",themeLighter:"#202309",themeLighterAlt:"#080902",themePrimary:"#cddc39",themeSecondary:"#b3c132",themeTertiary:"#7a8422",white:"#0d0e0f"}},"h2o-dark":{palette:{card:"#121212",page:"#080808",text:"#ffffff"},fluentPalette:{black:"#f8f8f8",neutralDark:"#f4f4f4",neutralLight:"#343434",neutralLighter:"#252525",neutralLighterAlt:"#1c1c1c",neutralPrimary:"#ffffff",neutralPrimaryAlt:"#dadada",neutralQuaternary:"#454545",neutralQuaternaryAlt:"#3d3d3d",neutralSecondary:"#d0d0d0",neutralTertiary:"#c8c8c8",neutralTertiaryAlt:"#656565",themeDark:"#c2991d",themeDarkAlt:"#e6b522",themeDarker:"#8f7015",themeLight:"#ffefbe",themeLighter:"#fff6dc",themeLighterAlt:"#fffdf6",themePrimary:"#fec925",themeSecondary:"#ffcf40",themeTertiary:"#ffde7d",white:"#121212"}},"one-dark-pro":{palette:{card:"#282C34",page:"#0E0C21",text:"#cacccf"},fluentPalette:{black:"#f9f9f9",neutralDark:"#f3f3f4",neutralLight:"#414651",neutralLighter:"#353a44",neutralLighterAlt:"#2f333c",neutralPrimary:"#cacccf",neutralPrimaryAlt:"#e7e8e9",neutralQuaternary:"#4e545f",neutralQuaternaryAlt:"#484d59",neutralSecondary:"#e1e2e4",neutralSecondaryAlt:"#8a8886",neutralTertiary:"#dcdddf",neutralTertiaryAlt:"#686e7a",themeDark:"#d899ec",themeDarkAlt:"#d288e8",themeDarker:"#e2b3f1",themeLight:"#3d2545",themeLighter:"#211425",themeLighterAlt:"#080509",themePrimary:"#CD7BE5",themeSecondary:"#b46dca",themeTertiary:"#7b4a8a",white:"#282C34"}},monokai:{palette:{card:"#2B2A2D",page:"#232022",text:"#cdcccf"},fluentPalette:{black:"#f9f9f9",neutralDark:"#f3f3f4",neutralLight:"#49484c",neutralLighter:"#3c3b3f",neutralLighterAlt:"#343337",neutralPrimary:"#cdcccf",neutralPrimaryAlt:"#e8e8e9",neutralQuaternary:"#58565b",neutralQuaternaryAlt:"#515054",neutralSecondary:"#e3e3e4",neutralSecondaryAlt:"#8a8886",neutralTertiary:"#dedddf",neutralTertiaryAlt:"#737177",themeDark:"#f787a5",themeDarkAlt:"#f67194",themeDarker:"#f9a6bc",themeLight:"#491d29",themeLighter:"#271016",themeLighterAlt:"#0a0405",themePrimary:"#F56188",themeSecondary:"#d75679",themeTertiary:"#933b52",white:"#2B2A2D"}},nord:{palette:{card:"#2E3441",page:"#3B4251",text:"#C8D1E3"},fluentPalette:{black:"#f8f9fc",neutralDark:"#f2f4f9",neutralLight:"#454c5b",neutralLighter:"#3a414f",neutralLighterAlt:"#343a48",neutralPrimary:"#C8D1E3",neutralPrimaryAlt:"#e5eaf2",neutralQuaternary:"#515969",neutralQuaternaryAlt:"#4c5363",neutralSecondary:"#dfe5ef",neutralSecondaryAlt:"#8a8886",neutralTertiary:"#d9e0ec",neutralTertiaryAlt:"#6a7282",themeDark:"#a2cfdc",themeDarkAlt:"#92c7d6",themeDarker:"#b8dce5",themeLight:"#293a3f",themeLighter:"#161f21",themeLighterAlt:"#050808",themePrimary:"#87C0D0",themeSecondary:"#78aab8",themeTertiary:"#52747d",white:"#2E3441"}},"winter-is-coming":{palette:{card:"#0A2D44",page:"#031629",text:"#D4DEEC"},fluentPalette:{black:"#fafbfd",neutralDark:"#f5f8fb",neutralLight:"#1a4460",neutralLighter:"#123a54",neutralLighterAlt:"#0e344d",neutralPrimary:"#D4DEEC",neutralPrimaryAlt:"#ecf0f7",neutralQuaternary:"#24506d",neutralQuaternaryAlt:"#204a67",neutralSecondary:"#e7edf5",neutralSecondaryAlt:"#8a8886",neutralTertiary:"#e3eaf3",neutralTertiaryAlt:"#3c6886",themeDark:"#63b5e2",themeDarkAlt:"#4aa9dd",themeDarker:"#89c8ea",themeLight:"#113041",themeLighter:"#091a23",themeLighterAlt:"#020609",themePrimary:"#38A0DA",themeSecondary:"#328dbf",themeTertiary:"#226082",white:"#0A2D44"}},fuchasia:{palette:{card:"#381E42",page:"#2C1834",text:"#C7CCD0"},fluentPalette:{black:"#f8f9f9",neutralDark:"#f2f3f4",neutralLight:"#51325e",neutralLighter:"#462852",neutralLighterAlt:"#3f234a",neutralPrimary:"#C7CCD0",neutralPrimaryAlt:"#e6e8ea",neutralQuaternary:"#5e3d6b",neutralQuaternaryAlt:"#583865",neutralSecondary:"#e0e3e5",neutralSecondaryAlt:"#8a8886",neutralTertiary:"#dadee0",neutralTertiaryAlt:"#775584",themeDark:"#e692e0",themeDarkAlt:"#e180db",themeDarker:"#ecade8",themeLight:"#432340",themeLighter:"#231222",themeLighterAlt:"#090509",themePrimary:"#DE73D7",themeSecondary:"#c366bd",themeTertiary:"#854581",white:"#381E42"}},nature:{palette:{card:"#13413F",page:"#0C2521",text:"#CBCECE"},fluentPalette:{black:"#f9f9f9",neutralDark:"#f3f4f4",neutralLight:"#245b59",neutralLighter:"#1c4f4d",neutralLighterAlt:"#174846",neutralPrimary:"#CBCECE",neutralPrimaryAlt:"#e8e9e9",neutralQuaternary:"#2f6966",neutralQuaternaryAlt:"#2a6360",neutralSecondary:"#e3e4e4",neutralSecondaryAlt:"#8a8886",neutralTertiary:"#dddfdf",neutralTertiaryAlt:"#46827f",themeDark:"#56cd95",themeDarkAlt:"#3ec385",themeDarker:"#7ddaaf",themeLight:"#0e3925",themeLighter:"#071e13",themeLighterAlt:"#020805",themePrimary:"#2dbd7a",themeSecondary:"#28a66b",themeTertiary:"#1b7149",white:"#13413F"}},solarized:{palette:{card:"#FDF6E3",page:"#EEE7D5",text:"#002b36"},fluentPalette:{black:"#083e4c",neutralDark:"#165362",neutralLight:"#e8e2d1",neutralLighter:"#f2ebd9",neutralLighterAlt:"#f6efdd",neutralPrimary:"#002b36",neutralPrimaryAlt:"#3f7e8e",neutralQuaternary:"#cec9b9",neutralQuaternaryAlt:"#d8d2c2",neutralSecondary:"#5a96a4",neutralSecondaryAlt:"#8a8886",neutralTertiary:"#7baebb",neutralTertiaryAlt:"#c6c1b2",themeDark:"#1d4d74",themeDarkAlt:"#225b8a",themeDarker:"#153956",themeLight:"#aecae0",themeLighter:"#d2e2ef",themeLighterAlt:"#f3f8fb",themePrimary:"#266599",themeSecondary:"#3874a5",themeTertiary:"#6b9bc2",white:"#FDF6E3"}},oceanic:{palette:{card:"#263238",page:"#1E272C",text:"#ced5d9"},fluentPalette:{black:"#d0dade",neutralDark:"#c1cdd2",neutralLight:"#3e4d55",neutralLighter:"#334148",neutralLighterAlt:"#2d3a41",neutralPrimary:"#B0BEC5",neutralPrimaryAlt:"#9aa6ad",neutralQuaternary:"#4a5b63",neutralQuaternaryAlt:"#44555d",neutralSecondary:"#697176",neutralSecondaryAlt:"#8a8886",neutralTertiary:"#34393b",neutralTertiaryAlt:"#63757e",themeDark:"#52bfb1",themeDarkAlt:"#3ab3a3",themeDarker:"#79d0c4",themeLight:"#0d332e",themeLighter:"#071b19",themeLighterAlt:"#020706",themePrimary:"#2bab9a",themeSecondary:"#269687",themeTertiary:"#1a675c",white:"#263238"}},ember:{palette:{card:"#F4F6F8",page:"#EBEEF2",text:"#1C1E24"},fluentPalette:{black:"#30333c",neutralDark:"#464954",neutralLight:"#dfe1e3",neutralLighter:"#e8eaed",neutralLighterAlt:"#eceef1",neutralPrimary:"#1C1E24",neutralPrimaryAlt:"#747884",neutralQuaternary:"#c6c8ca",neutralQuaternaryAlt:"#cfd1d3",neutralSecondary:"#8d919c",neutralSecondaryAlt:"#8a8886",neutralTertiary:"#a7aab4",neutralTertiaryAlt:"#bec0c2",themeDark:"#972318",themeDarkAlt:"#b3291d",themeDarker:"#6f1a12",themeLight:"#eeb7b2",themeLighter:"#f6d8d5",themeLighterAlt:"#fdf5f4",themePrimary:"#c72e20",themeSecondary:"#ce4236",themeTertiary:"#dd776e",white:"#F4F6F8"}},lighting:{palette:{card:"#F4F6F9",page:"#FFFFFF",text:"#4f5959"},fluentPalette:{black:"#2c3232",neutralDark:"#3c4444",neutralLight:"#e1e3e5",neutralLighter:"#eaecef",neutralLighterAlt:"#eef0f3",neutralPrimary:"#4f5959",neutralPrimaryAlt:"#636d6d",neutralQuaternary:"#c8c9cc",neutralQuaternaryAlt:"#d1d3d6",neutralSecondary:"#919c9c",neutralSecondaryAlt:"#8a8886",neutralTertiary:"#c7cdcd",neutralTertiaryAlt:"#c0c2c4",themeDark:"#1f5495",themeDarkAlt:"#2564b1",themeDarker:"#173e6e",themeLight:"#b5ceed",themeLighter:"#d7e5f6",themeLighterAlt:"#f5f8fd",themePrimary:"#296fc4",themeSecondary:"#3e7ecb",themeTertiary:"#74a3dc",white:"#F4F6F9"}},kiwi:{palette:{text:"#000000",card:"#ffffff",page:"#f4fae8"},fluentPalette:{black:"#0b0b0b",neutralDark:"#151515",neutralLight:"#eaeaea",neutralLighter:"#f4f4f4",neutralLighterAlt:"#f8f8f8",neutralPrimary:"#000000",neutralPrimaryAlt:"#2f2f2f",neutralQuaternary:"#d0d0d0",neutralQuaternaryAlt:"#dadada",neutralSecondary:"#373737",neutralSecondaryAlt:"#8a8886",neutralTertiary:"#595959",neutralTertiaryAlt:"#c8c8c8",themeDark:"#435918",themeDarkAlt:"#506a1d",themeDarker:"#324212",themeLight:"#c6d6a7",themeLighter:"#e0e9ce",themeLighterAlt:"#f7f9f2",themePrimary:"#597520",themeSecondary:"#698630",themeTertiary:"#93ac61",white:"#ffffff"}},benext:{palette:{text:"#555555",card:"#FFFFFF",page:"#E3E6EA"},fluentPalette:{neutralDark:"#404040",neutralLight:"#d1d4d7",neutralLighter:"#dadde1",neutralLighterAlt:"#dde0e4",neutralPrimary:"#555555",neutralPrimaryAlt:"#696969",neutralQuaternary:"#babcbf",neutralQuaternaryAlt:"#c3c5c9",neutralSecondary:"#989898",neutralSecondaryAlt:"#8a8886",neutralTertiary:"#cccccc",neutralTertiaryAlt:"#b2b5b8",themeDark:"#823613",themeDarkAlt:"#9a4017",themeDarker:"#60280e",themeLight:"#e6beab",themeLighter:"#f2dbd1",themeLighterAlt:"#fcf6f3",themePrimary:"#ab481a",themeSecondary:"#b5582e",themeTertiary:"#cd8564",white:"#E3E6EA",black:"#2f2f2f"}}},Pt=$i(),pl=e=>{var o;const a=(o=wa[e])!=null?o:wa[Tn],{palette:n,fluentPalette:r}=a,l=_e(n.card),i=(s,c)=>{document.body.style.setProperty(`--${s}`,c);const{r:d,g:m,b:u}=_e(ae(c));let g=.05;for(let h=0;h<10;h++)document.body.style.setProperty(`--${s}${h}`,`rgba(${d},${m},${u},${g})`),g+=h===0?.05:.1};if(Object.keys(n).forEach(s=>document.body.style.setProperty(`--${s}`,n[s])),Object.keys(r).forEach(s=>document.body.style.setProperty(`--${s}`,r[s]||null)),n.text&&i("text",n.text),n.card&&i("card",n.card),r.themePrimary){i("primary",r.themePrimary);const s=_e(r.themePrimary);if(s){const c=Gn(s.h,s.s,s.v);Object.keys(Ht).forEach(d=>{const{h:m,s:u,v:g}=_e(Ht[d]),h=Gn(m,u,g);document.body.style.setProperty(`--${d}`,e==="default"?Ht[d]:`hsl(${h.h}, ${c.s}%, ${h.l}%)`)})}}setTimeout(()=>{const{semanticColors:s}=Xr({palette:r,defaultFontStyle:{fontFamily:"Inter"},isInverted:nt(l)});document.body.style.setProperty("--errorText",s.errorText)},0)},Tn="default",za=N.box(Tn),fl=N.box([]),No=wa[Tn],So={horizontal:"row",vertical:"column"},Dn={start:"flex-start",end:"flex-end",center:"center",between:"space-between",around:"space-around"},hl={start:"flex-start",end:"flex-end",center:"center",baseline:"baseline",stretch:"stretch"},yl={start:"flex-start",end:"flex-end",center:"center",between:"space-between",around:"space-around",stretch:"stretch"};N.on(fl,e=>{e.forEach(a=>{const{text:n,primary:r,card:l,page:i}=a,o=_e(r),s=_e(n),c=_e(l);_t.setSlot(Pt[st[st.primaryColor]],o,nt(o),!0,!0),_t.setSlot(Pt[st[st.foregroundColor]],s,nt(s),!0,!0),_t.setSlot(Pt[st[st.backgroundColor]],c,nt(c),!0,!0),_t.insureSlots(Pt,nt(c));const{palette:d}=Ni({palette:_t.getThemeAsJson(Pt),isInverted:nt(c)});wa[a.name]={fluentPalette:d,palette:{text:n,card:l,page:i}}}),pl(za())});N.on(za,pl);var yt=(e=>(e[e.None=0]="None",e[e.Pick=1]="Pick",e[e.Add=2]="Add",e[e.Edit=3]="Edit",e[e.Delete=4]="Delete",e))(yt||{});const Ot={t:0},vl={t:1},Ae=N.box(Ot),_o=e=>{Ae({t:3,name:e})},Po=e=>{Ae({t:4,name:e})},ka=[{name:"Sidebar on Left",layout:{name:"hsbf",breakpoint:"xs",min_height:"512px",zones:[{name:"Header"},{name:"Main",direction:"row",zones:[{name:"Sidebar",size:"256px"},{name:"Body"}]},{name:"Footer"}]}},{name:"Sidebar on Right",layout:{name:"hbsf",breakpoint:"xs",min_height:"512px",zones:[{name:"Header"},{name:"Main",direction:"row",zones:[{name:"Body"},{name:"Sidebar",size:"256px"}]},{name:"Footer"}]}},{name:"No Sidebar",layout:{name:"hbf",breakpoint:"xs",min_height:"512px",zones:[{name:"Header"},{name:"Body"},{name:"Footer"}]}},{name:"Body Only",layout:{name:"b",breakpoint:"xs",zones:[{name:"Body"}]}}],Ln=ka[0];function To(e,a){e=e.toLowerCase(),a=a.toLowerCase();const n=e.length,r=a.length;if(r>n)return!1;if(r===n)return a===e;e:for(let l=0,i=0;l<r;l++){const o=a.charCodeAt(l);for(;i<n;)if(e.charCodeAt(i++)===o)continue e;return!1}return!0}const ea={list:{border:xe(1,f("$neutralQuaternaryAlt")),".ms-ContextualMenu-link":{lineHeight:"unset"},".ms-ContextualMenu-submenuIcon":{lineHeight:"unset",display:"flex",alignItems:"center"}}};function V(e){return class extends Ye.exports.Component{constructor(a){super(a);const n=this,r=e(a),l=[];Object.keys(r).forEach(i=>{if(i==="render"||i==="dispose"||i==="init"||i==="update")return;const o=r[i];N.boxed(o)&&l.push(N.on(o,s=>n.setState({})))}),this.model=r,this.arrows=l,this.state={}}componentDidMount(){this.model.init&&this.model.init()}componentDidUpdate(){this.model.update&&this.model.update()}componentWillUnmount(){this.model.dispose&&this.model.dispose();for(const a of this.arrows)a.dispose()}render(){return this.model.render()}}}let qt=null;const Vt={},Do=e=>{for(const a in e)delete e[a]};var jr;const ta=(jr=document.getElementsByTagName("body")[0].getAttribute("data-base-url"))!=null?jr:"/",Lo=ta+"_s/",Ao=ta+"_f/",Ro=ta+"_auth/init",Io=ta+"_auth/login",Ca=N.box(null),xl=N.box({}),$a=N.box(!1),Na={username:"",editable:!1},bl=(e,a)=>{if(a.startsWith("#")){window.location.hash=a.substr(1);return}e?x.args[e]=a:x.args[a]=!0,x.push()},St=(e,a)=>{let n=null;return(...r)=>{n&&window.clearTimeout(n),n=window.setTimeout(()=>{a(...r),n=null},e)}},zo=(e,a)=>{let n=!1;return(...r)=>{n||(a(...r),n=!0,window.setTimeout(()=>{n=!1},e))}},Bo=e=>{qt=N.connect(e,a=>{switch(a.t){case N.WaveEventType.Page:case N.WaveEventType.Error:case N.WaveEventType.Exception:case N.WaveEventType.Disconnect:Ca(a);break;case N.WaveEventType.Reset:window.location.reload();break;case N.WaveEventType.Redirect:window.location.replace(a.url);break;case N.WaveEventType.Config:Na.username=a.username,Na.editable=a.editable;break;case N.WaveEventType.Data:$a(!1);break}})},Yn=()=>{if(!qt)return;const e=window.location.hash;(e==null?void 0:e.length)>1&&(Vt["#"]=e.substr(1));const a=L({},Vt);Do(Vt),qt.push(a),$a(!0),xl(a)},x={baseURL:ta,socketURL:Lo,uploadURL:Ao,initURL:Ro,loginURL:Io,args:Vt,debounce:St,throttle:zo,push:Yn,fork:()=>{if(!qt)throw new Error("not initialized");return qt.fork()},emit:(e,a,n)=>{const r={},l={};r[a]=n,l[e]=r,Vt[""]=l,Yn()}};window.wave=x;const Fa=F({menu:{position:"absolute",top:0,right:0,$nest:{">div:first-child":{padding:24,fontSize:16,color:f("$text7")}}},icon:{userSelect:"none",marginRight:-6},target:{boxSizing:"border-box",cursor:"pointer",opacity:.5,$nest:{"&:hover":{opacity:1}}}}),El="__edit__",wl="__delete__",kl=e=>{const a=()=>{var n,r;if(e.name===El){e.value&&_o(e.value);return}if(e.name===wl){e.value&&Po(e.value);return}if(e.name.startsWith("#")){window.location.hash=e.name.substring(1);return}x.args[e.name]=(r=(n=e.value)!=null?n:e.data)!=null?r:!0,x.push()};return{key:e.name,text:e.label||e.name||"Untitled",iconProps:e.icon?{iconName:e.icon}:void 0,title:e.caption||void 0,subMenuProps:e.items?{items:e.items.map(kl),styles:ea}:void 0,onClick:a}},An=V(({commands:e,name:a,changedB:n,canEdit:r})=>{const l=Ye.exports.createRef(),i=N.box(!0),o=()=>i(!1),s=()=>i(!0);return{render:()=>{const d=e!=null?e:[];r&&d.push({name:El,label:"Edit this card",icon:"Edit",value:a},{name:wl,label:"Delete this card",icon:"Delete",value:a});const m=i(),u=d.map(kl);return u.length?Ye.exports.createElement("div",{className:M(Fa.menu,"w-card-menu"),"data-test":a},Ye.exports.createElement("div",{className:Fa.target,ref:l,onClick:o},Ye.exports.createElement($e,{className:Fa.icon,iconName:"MoreVertical"})),Ye.exports.createElement(Pa,{target:l,items:u,hidden:m,onItemClick:s,onDismiss:s,styles:ea})):Ye.exports.createElement(Ye.exports.Fragment,null)},changedB:n,hiddenB:i}}),Mo=_i(),Wa=Si({locale:navigator.language,messages:{},onError:()=>{}},Mo),Fo=e=>e.replace(/(_\w)/g,a=>a[1].toUpperCase()),Wo=e=>{const a={};for(const n in e){const r=e[n];a[Fo(n)]=r==="true"?!0:r==="false"?!1:/^\d+$/.test(r)?parseInt(r,10):r}return a},Cl=e=>/^\w+$/.test(e);Ta.registerHelper("intl",(e,{hash:a})=>{a=Wo(a);const n=a.type;return n==="date"?Wa.formatDate(e,a):n==="time"?Wa.formatTime(e,a):n==="number"||typeof e=="number"?Wa.formatNumber(e,a):e});const $l=e=>typeof e=="string"&&e.length>1&&e.charAt(0)==="="&&e.charAt(1)!=="=",Ho=e=>{if(!$l(e))return null;if(e=e.substring(1),Cl(e))return[e,void 0];const a=e.match(/\{\{\s*(\w+)\s+(\w+)(.+)\}\}/);if(a)return[a[2],Nl(e)];const n=e.match(/\{\{\s*(\S+)/);return n?[n[1],void 0]:null},Nl=e=>Ta.compile(e),Oo=(e,a)=>{Cl(e)&&(e="{{"+e+"}}");const n=Nl(e);return n?n(a):e};var et=(e=>(e.Transparent="transparent",e.Normal="normal",e.Raised="raised",e.Flat="flat",e))(et||{});const Vo={effect:"normal"},jo=()=>{const e={};return{register:(r,l,i=Vo)=>e[r]={ctor:l,style:i},lookup:r=>e[r]||e[""]}},Q=jo(),Ze=(e,a,n=null)=>e!=null?$l(e)?Oo(e.substring(1),a):e:n!=null?n:null,ne=({data:e,defaultValue:a,format:n,className:r,style:l})=>{const i=Ze(n,e,a);return i==null?null:r||l?t.createElement("div",{className:r,style:l},i):t.createElement(t.Fragment,null,i)},aa=({card:e})=>{const a=Q.lookup(e.state.view).ctor;return t.createElement(a,L({},e))},Rn=({view:e,props:a,data:n})=>{const r=N.unpack(n).map((l,i)=>{const o={name:N.xid(),state:Z(L({},N.unpack(a)),{view:e,data:l}),changed:N.box()};return t.createElement(aa,{key:i,card:o})});return t.createElement(t.Fragment,null,r)},gn={left:0,top:0,width:0,height:0},Xo=(e,a,n,r,l)=>{let i=1;const o=e-2*l,s=a-2*l,c=e*n+l*(n+1),d=a*r+l*(r+1),m=c-2*l,u=d-2*l,g=(v,E,C,R)=>{const S={left:v*(e+l),top:E*(a+l)};return C>0?S.width=C*e+(C-1)*l:S.right=-(C+1)*(e+l),R>0?S.height=R*a+(R-1)*l:S.bottom=-(R+1)*(a+l),S},h=v=>{const E=v.trim().split(/\s+/g);switch(E.length){case 1:return["1","1",v,v];case 2:return["1","1",...E];case 3:return[...E,E[2]];case 4:return E;default:return E.slice(0,4)}},y=v=>{if(!v)return gn;const[E,C,R,S]=h(v).map(N.parseI);return isNaN(E)||isNaN(C)||isNaN(R)||isNaN(S)?gn:g(E-1,C-1,R,S)},k=()=>[window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth,window.innerHeight||document.documentElement.clientHeight||document.body.clientHeight];return{width:c,height:d,innerWidth:m,innerHeight:u,unitWidth:e,unitHeight:a,unitInnerWidth:o,unitInnerHeight:s,gap:l,place:y,scale:i,rescale:()=>{const[v,E]=k();return i=Math.min(v/c,E/d),i},inset:{position:"absolute",left:l,top:l,right:l,bottom:l,overflow:"auto"}}},se=Xo(134,76,12,10,15),Sa=F({grid:{position:"relative",boxSizing:"border-box",width:se.innerWidth,margin:ve(se.gap)},slot:{boxSizing:"border-box",transition:"box-shadow 0.3s cubic-bezier(.25,.8,.25,1)",display:"flex",flexDirection:"column",margin:ve(7),overflow:"auto",$nest:{">*":{boxSizing:"border-box",flexGrow:1}}},normal:{backgroundColor:f("$card"),boxShadow:`0px 3px 5px ${f("$text0")}`,$nest:{"&:hover":{boxShadow:`0px 12px 20px ${f("$text2")}`}}},flat:{backgroundColor:f("$card"),boxShadow:`0px 3px 5px ${f("$text0")}`},raised:{margin:0,background:f("$themePrimary"),color:f("$card"),boxShadow:`0px 3px 7px ${f("$text3")}`,$nest:{".ms-Link":{color:f("$card")},".ms-Persona":{$nest:{"&-primaryText":{color:f("$card")},"&-secondaryText":{color:f("$card")},"&-tertiaryText":{color:f("$card")}}},".ms-Button":{$nest:{"&-menuIcon":{color:f("$card")}}},".ms-Nav":{$nest:{"&-chevronButton":{color:f("$card")},"&-link":{color:f("$card")},"&-link .ms-Icon":{color:f("$card")},".is-selected .ms-Nav-link":{background:f("$themeDark")},".is-selected .ms-Nav-link:after":{borderColor:f("$card")},"&-compositeLink:hover .ms-Nav-link":{background:f("$text1")},"&-compositeLink:hover.is-disabled .ms-Nav-link":{background:"transparent"}}},".w-menu":{color:ye(f("$card")),$nest:{"& .ms-Button-icon":{color:ye(f("$card"))},"&-label":{color:f("$card")}}},".w-text":{color:f("$card")},".w-tabs":{$nest:{".ms-Pivot-link":{backgroundColor:f("$themePrimary"),color:f("$card")},".ms-Pivot-link.is-selected":{backgroundColor:f("$card"),color:f("$text")}}},".w-tabs-link":{$nest:{".ms-Pivot-link":{color:f("$card")},".ms-Pivot-link:hover .ms-Pivot-linkContent":{color:f("$text")},".ms-Pivot-link.is-selected:before":{backgroundColor:f("$card")}}},".ms-Checkbox":{$nest:{"&-text":{color:ye(f("$card"))},"&-checkbox":{borderColor:ye(f("$card"))},"&-checkmark":{color:f("$themePrimary")},"&-label:hover .ms-Checkbox-checkmark":{color:f("$card")},"&.is-checked .ms-Checkbox-checkbox":{background:ye(f("$card"))},"&.is-checked .ms-Checkbox-label:hover .ms-Checkbox-checkmark":{color:f("$themePrimary")}}},".ms-Toggle":{$nest:{"&-label":{color:f("$card")},"&-stateText":{color:f("$card")},"&-background":{borderColor:f("$card"),background:f("$themePrimary")},"&-thumb":{background:ye(f("$card"))},"&.is-checked .ms-Toggle-background":{background:f("$card")},"&.is-checked .ms-Toggle-thumb":{background:ye(f("$text"))}}},".ms-TextField-fieldGroup":{$nest:{i:{color:f("$text")}}},"& + div.w-card-menu i":{color:f("$card")},".ms-Label":{color:f("$card")}}},transparent:{backgroundColor:"transparent"},marginless:{margin:0}}),Sl=e=>{const{effect:a,marginless:n}=Uo(e);return M(Sa.slot,In(a),n?Sa.marginless:"")},_l=e=>{switch(e){case"card":return"normal";case"transparent":return"transparent";case"primary":return"raised";default:return"raised"}},In=e=>Sa[e],Uo=e=>Q.lookup(e.state.view).style,Go=({name:e,cards:a})=>{const n=!!a.find(l=>l.state.view==="editor"),r=a.map(l=>{const i=se.place(l.state.box),{left:o,top:s,right:c,bottom:d,width:m,height:u}=i,g=i===gn?l.state.view==="editor"?void 0:"none":void 0,h=l.name==="__unhandled_error__"?1:"initial";return t.createElement("div",{key:l.id,className:Sl(l),style:{display:g,position:"absolute",left:o,top:s,right:c,bottom:d,width:m,height:u,zIndex:h,margin:0}},t.createElement(aa,{card:l}),t.createElement(An,{name:l.name,commands:l.state.commands,changedB:l.changed,canEdit:n}))});return t.createElement("div",{"data-test":e,className:Sa.grid},r)},pn=F({card:{display:"flex",flexDirection:"column",padding:se.gap},body:{flexGrow:1},markdown:{$nest:{">*:only-child":{margin:0},a:{color:f("$themePrimary"),$nest:{"&:hover":{textDecoration:"none"}}},table:{width:Ne(100),borderCollapse:"collapse"},tr:{borderBottom:xe(1,f("$text5"))},th:{padding:be(11,6),textAlign:"left"},td:{padding:be(11,6)},img:{maxWidth:"100%",maxHeight:"100%"}}}}),qo=Pi({html:!0,linkify:!0,typographer:!0}),Pe=({source:e})=>{const a=n=>{const r=n.target.getAttribute("href");if(n.target instanceof HTMLAnchorElement&&(r==null?void 0:r.startsWith("?")))return window.dispatchEvent(new CustomEvent("md-link-click",{detail:r.substring(1)})),n.preventDefault(),n.stopPropagation(),!1};return t.createElement("div",{onClick:a,className:M(pn.markdown,"wave-markdown"),dangerouslySetInnerHTML:{__html:qo.render(e)}})},Qo=V(({name:e,state:a,changed:n})=>({render:()=>{const l=N.unpack(a.data),i=Ze(a.title,l);return t.createElement("div",{"data-test":e,className:pn.card},i&&t.createElement("div",{className:"wave-s12 wave-w6"},i),t.createElement("div",{className:pn.body},t.createElement(Pe,{source:Ze(a.content,l)})))},changed:n}));Q.register("markdown",Qo);const oa=F({container:{display:"flex",alignItems:"flex-start",alignContent:"flex-start"},expand:{flexGrow:1},icon:{color:f("$text"),fontWeight:400,fontSize:"14px",userSelect:"none",textAlign:"left",marginLeft:"0.5em",cursor:"pointer"},preventOverflow:{minWidth:0}}),oe=({children:e,content:a,showIcon:n=!0,expand:r=!0})=>{if(!a)return t.createElement(t.Fragment,null,e);const l={onRenderContent:()=>t.createElement("div",null,t.createElement(Pe,{source:a}))};return t.createElement("div",{className:oa.container,"data-test":"tooltip"},n?t.createElement(t.Fragment,null,t.createElement("div",{className:M(oa.preventOverflow,r?oa.expand:"")},e),t.createElement(cn,{tooltipProps:l},t.createElement(it,{className:oa.icon,iconName:"Info"}))):t.createElement(cn,{tooltipProps:l},e))},Pl=F({buttons:{boxSizing:"border-box",overflowX:"auto"}}),Ko={start:"start",end:"end",center:"center",between:"space-between",around:"space-around"},Tl=({model:{name:e,visible:a=!0,link:n,label:r,disabled:l,icon:i,caption:o,value:s,primary:c,width:d,path:m}})=>{const u=y=>{y.stopPropagation(),m?window.open(m,"_blank"):e.startsWith("#")?window.location.hash=e.substring(1):(x.args[e]=s===void 0||s,x.push())},g={root:{display:a?void 0:"none",width:Nt(d),minWidth:d?"initial":void 0},icon:{fontSize:20,display:"flex",alignItems:"center"}};if(t.useEffect(()=>{x.args[e]=!1},[]),n)return t.createElement(ze,{"data-test":e,disabled:l,onClick:u,styles:g},r);const h={text:r,disabled:l,onClick:u,styles:g,iconProps:{iconName:i}};return!r&&i?t.createElement(Et,Z(L({},h),{"data-test":e,title:o})):(o==null?void 0:o.length)?c?t.createElement(dn,Z(L({},h),{"data-test":e,primary:!0,secondaryText:o})):t.createElement(dn,Z(L({},h),{"data-test":e,secondaryText:o})):c?t.createElement(Oe,Z(L({},h),{"data-test":e})):t.createElement(Ue,Z(L({},h),{"data-test":e}))},Yo=({model:e})=>{const{name:a,items:n,justify:r,width:l}=e,i=n.map(o=>o.button).filter(Boolean).map(o=>t.createElement(oe,{key:o.name,content:o.tooltip,showIcon:!1,expand:!1},t.createElement(Tl,{model:o})));return t.createElement("div",{"data-test":a,className:Pl.buttons,style:{width:l}},t.createElement(Re,{horizontal:!0,horizontalAlign:Ko[r||""],tokens:{childrenGap:10}},i))},Jo=({model:e})=>t.createElement("div",{className:Pl.buttons},t.createElement(Tl,{key:e.name,model:e})),Zo=({model:e})=>t.createElement(Re,{horizontal:!0,verticalAlign:"center",styles:{root:{height:24}}},e.items.map(({mini_button:a})=>a?t.createElement(Dl,{key:a.name,model:a}):null)),Dl=({model:e})=>{const{name:a,label:n,icon:r}=e,l=()=>{if(a.startsWith("#")){window.location.hash=a.substring(1);return}x.args[a]=!0,x.push()};return t.createElement(kt,{"data-test":a,styles:{label:{color:f("$neutralTertiary")},labelHovered:{color:"inherit"},icon:{color:f("$neutralTertiary")},root:{padding:be(0,1)}},text:n,iconProps:{iconName:r},onClick:l})},es=({model:e})=>{const a=(n,r)=>{x.args[e.name]=r===null?null:!!r,e.trigger&&x.push()};return t.useEffect(()=>{x.args[e.name]=!!e.value},[]),t.createElement(Yt,{"data-test":e.name,inputProps:{"data-test":e.name},styles:{checkmark:{display:"flex"}},label:e.label,defaultIndeterminate:e.indeterminate,defaultChecked:e.value,onChange:a,disabled:e.disabled})},Ha=F({toolbar:{margin:ve(5,0)},items:{$nest:{"> *":{margin:"10px 0"}}},inline:{display:"flex",flexWrap:"wrap",$nest:{".checklist-item":{marginRight:15}}}}),ts=({model:e})=>{const a=t.useMemo(()=>new Set(e.values),[e.values]),n=t.useCallback(()=>{var u;return((u=e.choices)==null?void 0:u.map(g=>({c:g,selected:a.has(g.name)})))||[]},[a,e.choices]),[r,l]=t.useState(n()),i=u=>{x.args[e.name]=u.filter(({selected:g})=>g).map(({c:g})=>g.name),e.trigger&&x.push()},o=u=>{const g=r.map(({c:h,selected:y})=>({c:h,selected:h.disabled?y:u}));l(g),i(g)},s=()=>o(!0),c=()=>o(!1),d=u=>(g,h=!1)=>{const y=[...r];y[u].selected=h,l(y),i(y)},m=r.map(({c:u,selected:g},h)=>t.createElement(Yt,{key:h,"data-test":`checkbox-${h+1}`,className:"checklist-item",label:u.label||u.name,checked:g,onChange:d(h),disabled:!!u.disabled,styles:{root:{marginBottom:4},checkmark:{display:"flex"}}}));return t.useEffect(()=>{x.args[e.name]=e.values||[]},[]),t.useEffect(()=>{l(n())},[n,e.choices]),t.createElement("div",{"data-test":e.name},t.createElement(He,null,e.label),t.createElement("div",{className:Ha.toolbar},t.createElement(pe,{variant:"small"},t.createElement(ze,{onClick:s},"Select All")," | ",t.createElement(ze,{onClick:c},"Deselect All"))),t.createElement("div",{className:M(Ha.items,e.inline?Ha.inline:"")},m))},as=({model:e})=>{const a={choiceFieldWrapper:{marginRight:15}},n=(e.choices||[]).map(({name:l,label:i,disabled:o})=>({key:l,text:i||l,disabled:o,styles:a})),r=(l,i)=>{i&&(x.args[e.name]=i.key),e.trigger&&x.push()};return t.useEffect(()=>{x.args[e.name]=e.value||null},[]),t.createElement(Ti,{styles:e.inline?{flexContainer:{display:"flex",flexWrap:"wrap"}}:void 0,"data-test":e.name,label:e.label,required:e.required,defaultSelectedKey:e.value,options:n,onChange:r})},Tt=F({multiContainer:{position:"relative",$nest:{"&:hover > button":{opacity:1}}},compactContainer:{position:"relative"},btnMultiline:{opacity:0,transition:"opacity .5s"},btn:{minWidth:"initial",position:"absolute",top:31,right:4,width:24,height:24},copiedBtn:{background:f("$green"),$nest:{"&:hover":{background:f("$green")}}}}),ns=({model:e})=>{const{name:a,multiline:n,label:r,value:l}=e,i=t.useRef(null),o=t.useRef(),[s,c]=t.useState(!1),d=async()=>{var u;const m=i.current;if(!!m){try{document.queryCommandSupported("copy")&&(m.select(),document.execCommand("copy"),(u=window.getSelection())==null||u.removeAllRanges())}catch{await window.navigator.clipboard.writeText(l)}c(!0),o.current=window.setTimeout(()=>c(!1),2e3)}};return t.useEffect(()=>()=>window.clearTimeout(o.current),[]),t.createElement("div",{"data-test":a,className:n?Tt.multiContainer:Tt.compactContainer},t.createElement(Ie,{componentRef:i,value:l,label:r,multiline:n,styles:{root:{width:Ne(100)}},readOnly:!0}),t.createElement(Oe,{title:"Copy to clipboard",onClick:d,iconProps:{iconName:s?"CheckMark":"Copy"},className:M(Tt.btn,s?Tt.copiedBtn:"",n?Tt.btnMultiline:"")}))},sa=F({inlinePickerContainer:{display:"flex",alignItems:"center"},preview:{width:20,height:20,margin:ve(0,15),border:xe(1,f("$text"))},rhs:{display:"flex",alignItems:"center"}}),rs=e=>e.map(a=>({id:a,label:a,color:a})),ls=({model:e,onChange:a})=>{const[n,r]=t.useState(!1),l=e.value||"#000",[i,o]=t.useState(_e(l)),[s,c]=t.useState(l),d=()=>r(!n),m=(g,h="")=>{if(c(h),!(h==null?void 0:h.match(/^#([0-9a-f]{3}){1,2}$/i)))return;const y=_e(h);o(y),a(null,y)},u=(g,h)=>{o(h),c(h.str),a(null,h)};return t.createElement("div",{className:sa.inlinePickerContainer},e.label&&t.createElement(He,null,e.label),t.createElement("div",{className:sa.rhs},t.createElement("div",{className:sa.preview,style:{background:i==null?void 0:i.str},onClick:d}),n&&t.createElement(Li,{directionalHint:Da.rightBottomEdge,target:`.${sa.preview}`,onDismiss:d,gapSpace:10},t.createElement(Ur,{alphaType:e.alpha?"alpha":"none",color:i,onChange:u})),t.createElement(Ie,{value:s,onChange:m})))},is=({model:e})=>{const{width:a,value:n,name:r,trigger:l,label:i,choices:o,alpha:s,inline:c}=e,d=n||null,[m,u]=t.useState(d),g=(_,b,v=d)=>{x.args[r]=v,u(v),l&&x.push()},h=(_,{str:b})=>{x.args[r]=b||d,l&&x.push()},y=Nt(a),k=(y==null?void 0:y.includes("%"))?"initial":`calc(${y} - 35px)`;return t.useEffect(()=>{x.args[r]=d},[]),t.createElement("div",{"data-test":r},c?t.createElement(ls,{model:e,onChange:h}):t.createElement(t.Fragment,null,i&&t.createElement(He,null,i),(o==null?void 0:o.length)?t.createElement(Di,{columnCount:10,selectedId:m||o[0],colorCells:rs(o),onChange:g}):t.createElement(Ur,{alphaType:s?"alpha":"none",color:d||"#000",onChange:h,styles:{root:{width:y,maxWidth:y},colorRectangle:{minWidth:k,maxWidth:k}}})))},os=({model:e})=>e.values?t.createElement(cs,{model:e}):t.createElement(ss,{model:e}),ss=({model:e})=>{var o;const[a,n]=Ll(e.choices),[r,l]=t.useState((o=e.value)!=null?o:null),i=(s,c,d,m)=>{const u=c&&String(c.key)||m||"";l(u),e.value=u,x.args[e.name]=u,e.trigger&&x.push()};return t.useEffect(()=>{x.args[e.name]=r},[e.name,r]),t.useEffect(()=>{l(e.value||null),e.value&&!(e.choices||[]).includes(e.value)&&n((s=[])=>[...s,{key:e.value,text:e.value}])},[e.value]),t.createElement(Gr,{"data-test":e.name,label:e.label,placeholder:e.placeholder,options:a,required:e.required,selectedKey:r,allowFreeform:!0,disabled:e.disabled,autoComplete:"on",errorMessage:e.error,onChange:i})},cs=({model:e})=>{var s;const[a,n]=Ll(e.choices),[r,l]=t.useState((s=e.values)!=null?s:[]),i=c=>{l(d=>{const m=c.selected?[...d,String(c.key)]:d.filter(u=>u!==c.key);return x.args[e.name]=m,m})},o=(c,d,m,u)=>{if(!d&&u){const g={key:u,text:u};n((h=[])=>[...h,g]),i(Z(L({},g),{selected:!0}))}d&&i(d),e.trigger&&x.push()};return t.useEffect(()=>{var c,d;x.args[e.name]=((c=e.values)==null?void 0:c.length)?e.values:null,l(e.values||[]),((d=e.values)==null?void 0:d.length)&&n((m=[])=>[...m,...e.values.filter(u=>!m.some(g=>g.key===u)).map(u=>({key:u,text:u}))])},[e.values]),t.createElement(Gr,{"data-test":e.name,label:e.label,placeholder:e.placeholder,options:a,required:e.required,multiSelect:!0,selectedKey:r,allowFreeform:!0,disabled:e.disabled,autoComplete:"on",errorMessage:e.error,onChange:o})},Ll=(e=[])=>{const a=t.useMemo(()=>(e||[]).map(l=>({key:l,text:l})),[e]),[n,r]=t.useState(a);return t.useEffect(()=>{r(a)},[e,a]),[n,r]},Jn=e=>{const a=`${e}`;return a.length===1?`0${a}`:a},ds=e=>`${e.getFullYear()}-${Jn(e.getMonth()+1)}-${Jn(e.getDate())}`,Oa=e=>{if(!e)return;const a=e.split("-");if(a.length!==3)return;const n=a.map(r=>parseInt(r,10)).filter(r=>!isNaN(r));if(n.length===3)return new Date(n[0],n[1]-1,n[2])},ms=({model:e})=>{const a=e.value||null,n=a?Oa(a):null,[r,l]=t.useState(n?new Date(n):void 0),i=o=>{const s=o==null?a:ds(o);x.args[e.name]=s,l(s?new Date(`${s}T00:00:00`):void 0),e.trigger&&x.push()};return t.useEffect(()=>{x.args[e.name]=a},[]),t.createElement(Ai,{"data-test":e.name,styles:{icon:{bottom:2},readOnlyTextField:{paddingRight:ye("32px")},statusMessage:{marginTop:0}},label:e.label,value:r,placeholder:e.placeholder,disabled:e.disabled,onSelectDate:i,minDate:Oa(e.min||null),maxDate:Oa(e.max||null)})},Al=F({dialogCheckedRow:{background:f("$neutralLight")},dialogControls:{display:"flex",justifyContent:"space-between",marginTop:16}}),Zn=({model:e})=>{const{name:a,label:n,required:r,disabled:l,values:i,choices:o,trigger:s,placeholder:c}=e,d=!!i,m=t.useMemo(()=>d?new Set(i):null,[d,i]),[u,g]=t.useState(e.value),[h,y]=t.useState(i),k=(o||[]).map(({name:E,label:C,disabled:R})=>({key:E,text:C||E,disabled:R})),_=(E,C)=>{if(C){const R=C.key;if(d&&m!==null){C.selected?m.add(R):m.delete(R);const S=Array.from(m);x.args[a]=S,y(S)}else g(R),x.args[a]=R,e.value=R}s&&x.push()},b=()=>{if(!m)return;m.clear(),k.forEach(C=>{C.disabled||m.add(C.key)});const E=Array.from(m);y(E),x.args[a]=E,_()},v=()=>{!m||(m.clear(),y([]),x.args[a]=[],_())};return t.useEffect(()=>{!d||(y(i||[]),x.args[a]=i!=null?i:null)},[a,i,d]),t.useEffect(()=>{var E;d||(g(e.value||""),x.args[a]=(E=e.value)!=null?E:null)},[a,e.value,d]),t.createElement(t.Fragment,null,t.createElement(La,{"data-test":a,styles:{caretDownWrapper:{lineHeight:ge(26)}},label:n,placeholder:c,options:k,required:r,disabled:l,multiSelect:d||void 0,selectedKey:d?void 0:u,selectedKeys:d?h:void 0,onChange:_}),d&&t.createElement("div",null,t.createElement(pe,{variant:"small"},t.createElement(ze,{onClick:b},"Select All")," | ",t.createElement(ze,{onClick:v},"Deselect All"))))},Rl=44,er=40,Il=()=>({itemCount:er,height:Rl*er}),zl=(e,a)=>{const[n,r]=t.useState(e.map(({name:i,label:o},s)=>({name:i,text:o||i,idx:s,checked:Array.isArray(a)?a.includes(i):a===i,show:!0})));return[n,r,(i,o="")=>r(s=>s.map(c=>Z(L({},c),{show:To(c.text,o)})))]},Bl=e=>a=>a?t.createElement(Yt,{label:a.text,styles:{root:{minHeight:Rl,alignItems:"center"},label:{width:Ne(100),padding:12,wordBreak:"break-word"},checkmark:{display:"flex"}},onChange:e(a.name),className:a.checked?Al.dialogCheckedRow:"",checked:a.checked}):null,us=({model:e})=>{var k,_;const{name:a,choices:n=[],disabled:r,required:l,trigger:i,placeholder:o,label:s}=e,[c,d]=t.useState(!0),[m,u,g]=zl(n,e.value),h=()=>d(b=>!b),y=b=>(v,E=!1)=>{u(C=>C.map(R=>Z(L({},R),{checked:R.name===b?E:!1,show:!0}))),x.args[a]=b,e.value=b,i&&x.push(),h()};return t.useEffect(()=>{var b;e.value!==void 0&&(x.args[a]=(b=e.value)!=null?b:null,u(v=>v.map(E=>Z(L({},E),{checked:e.value===E.name}))))},[a,e.value,u]),t.createElement(t.Fragment,null,t.createElement(Ie,{"data-test":a,iconProps:{iconName:"ChevronDown"},readOnly:!0,onClick:h,label:s,disabled:r,required:l,styles:{field:{cursor:"pointer"},icon:{fontSize:12,color:f("$neutralSecondary")}},placeholder:o,value:(_=(k=m.find(b=>b.checked))==null?void 0:k.text)!=null?_:""}),t.createElement(Jt,{hidden:c,dialogContentProps:{title:s,type:lt.close},onDismiss:h,minWidth:600,maxWidth:"90vw"},t.createElement(qr,{styles:{innerContent:{height:"65vh"},header:{height:0}}},t.createElement(He,null,"Search"),t.createElement($n,{"data-test":`${a}-search`,onChange:g,autoFocus:!0}),t.createElement(Nn,{styles:{root:{marginTop:100,boxShadow:`0px 3px 7px ${f("$text3")}`}}},t.createElement(Qr,{items:m.filter(b=>b.show),getPageSpecification:Il,renderedWindowsAhead:3,onRenderCell:Bl(y)})))))},gs=({name:e,choices:a=[],values:n=[],disabled:r,required:l,trigger:i,placeholder:o,label:s})=>{const[c,d]=t.useState(!0),[m,u,g]=zl(a,n),h=t.useRef(m),y=()=>{d(!1),h.current=m},k=()=>{u(C=>C.map(R=>Z(L({},R),{show:!0}))),d(!0)},_=()=>{u(h.current),k()},b=C=>{x.args[e]=C.filter(R=>R.checked).map(R=>R.name),i&&x.push(),k()},v=C=>(R,S=!1)=>{u(W=>W.map(T=>Z(L({},T),{checked:C===T.name?S:T.checked})))},E=(C=!0)=>()=>{u(R=>R.map(S=>Z(L({},S),{checked:S.show?C:S.checked})))};return t.useEffect(()=>{n&&(x.args[e]=n,u(C=>C.map(R=>Z(L({},R),{checked:n.includes(R.name)}))))},[e,n,u]),t.createElement(t.Fragment,null,t.createElement(Ie,{"data-test":e,iconProps:{iconName:"ChevronDown"},readOnly:!0,onClick:y,label:s,disabled:r,required:l,styles:{field:{cursor:"pointer"},icon:{fontSize:12,color:f("$neutralSecondary")}},placeholder:o,value:m.filter(C=>C.checked).map(C=>C.text).join(", ")}),t.createElement(Jt,{hidden:c,dialogContentProps:{title:s,type:lt.close},onDismiss:_,minWidth:600,maxWidth:"90vw"},t.createElement(qr,{styles:{innerContent:{height:"65vh"},header:{height:0}}},t.createElement(He,null,"Search"),t.createElement($n,{"data-test":`${e}-search`,onChange:g,autoFocus:!0}),t.createElement("div",{className:M("wave-s14",Al.dialogControls)},t.createElement("span",{className:"wave-w5"},"Selected: ",m.filter(C=>C.checked).length),t.createElement("div",null,t.createElement(ze,{onClick:E()},"Select All")," | ",t.createElement(ze,{onClick:E(!1)},"Deselect All"))),t.createElement(Nn,{styles:{root:{marginTop:100,boxShadow:`0px 3px 7px ${f("$text3")}`}}},t.createElement(Qr,{items:m.filter(C=>C.show),getPageSpecification:Il,renderedWindowsAhead:3,onRenderCell:Bl(v)}))),t.createElement(Sn,null,t.createElement(Ue,{text:"Cancel",onClick:_}),t.createElement(Oe,{text:"Select",onClick:()=>b(m)}))))},tr=e=>e.values?t.createElement(gs,L({},e)):t.createElement(us,{model:L({},e)}),ps=({model:e})=>{var a;return e.popup==="always"?t.createElement(tr,L({},e)):e.popup==="never"?t.createElement(Zn,{model:L({},e)}):(((a=e.choices)==null?void 0:a.length)||0)>100?t.createElement(tr,L({},e)):t.createElement(Zn,{model:L({},e)})},ar=F({expanderOpen:{$nest:{">div:last-child":{display:"block"}}},expanderClosed:{$nest:{">div:last-child":{display:"none"}}}}),fs=({model:e})=>{const[a,n]=t.useState(e.expanded),r=t.useCallback(()=>{x.args[e.name]=!a,n(!a)},[a,e.name]);return t.useEffect(()=>{e.expanded!==void 0&&(x.args[e.name]=!!e.expanded,n(e.expanded))},[e]),t.createElement("div",{"data-test":e.name,className:a?ar.expanderOpen:ar.expanderClosed,"data-visible":a?"visible":"hidden"},t.createElement(Aa,{alignContent:"start",styles:{content:{paddingLeft:0}}},t.createElement(kt,{title:a?"Shrink":"Expand",iconProps:{iconName:a?"ChevronDownMed":"ChevronRightMed"},onClick:r,styles:{root:{paddingLeft:0},icon:{marginLeft:0}}},e.label)),t.createElement(Ee,{items:e.items||[]}))},hs=({model:e})=>{const{name:a,max:n,items:r,value:l}=e,i=()=>{if(a){if(a.startsWith("#")){window.location.hash=a.substring(1);return}x.args[a]=l===void 0||l,x.push()}},o=(s,{persona:c})=>{if(c){const{title:d,image:m,initials:u}=c;s.push({personaName:d,imageUrl:m,imageInitials:u})}return s};return t.createElement("div",{"data-test":a},t.createElement(Ri,{styles:{addButton:{".ms-Persona-initials":{background:f("$themePrimary"),color:f("$card")}},descriptiveOverflowButton:{".ms-Persona-initials":{background:f("$neutralLighter")},".ms-Persona-initials>span":{color:f("$text")}}},personas:r.reduce(o,[]),maxDisplayablePersonas:n,showAddButton:!!a,addButtonProps:{onClick:i},overflowButtonProps:{},overflowButtonType:Ii.descriptive}))},Te=F({uploadInput:{opacity:0},upload:Z(L({},Je()),{flexDirection:"column",boxSizing:"border-box"}),uploadDragging:{border:$o(2,f("$themePrimary"))},uploadLabel:Z(L({},Je()),{textAlign:"center",padding:be(5,10),fontSize:14,fontWeight:600,borderRadius:2,background:f("$themePrimary"),color:f("$page"),minWidth:80,boxSizing:"border-box",height:28,display:"inline-block",$nest:{"&:hover":{cursor:"pointer"}}}),asterisk:{$nest:{"&::after":{content:"'*'",verticalAlign:"top",paddingLeft:"2px",lineHeight:"12px",position:"absolute",color:f("$errorText")}}},uploadLabelCompact:{position:"absolute",top:2,right:2,height:28},uploadMessageBar:{margin:"20px 0"},uploadRemove:{fontSize:20,position:"absolute",top:-15,right:0,cursor:"pointer"},compact:{position:"relative"}}),nr=e=>e*1024*1024,ys=({model:e})=>{const{name:a,label:n,file_extensions:r,max_file_size:l,compact:i,height:o,max_size:s,multiple:c,required:d}=e,[m,u]=t.useState(!1),[g,h]=t.useState([]),[y,k]=t.useState(""),[_,b]=t.useState(0),[v,E]=t.useState(""),[C,R]=t.useState(""),S=l?nr(l):0,W=s?nr(s):0,T=r?r.map(Y=>Y.startsWith(".")?Y:`.${Y}`):null,G=t.useRef(),te=async(Y=g)=>{const U=new FormData;Y.forEach(K=>U.append("files",K));try{const{responseText:K}=await new Promise((D,B)=>{const H=new XMLHttpRequest;G.current=()=>{B(),H.abort(),b(0)},H.open("POST",x.uploadURL),H.upload.onprogress=z=>b(z.loaded/z.total),H.send(U),H.onreadystatechange=()=>{H.readyState===XMLHttpRequest.DONE&&(H.status>=200&&H.status<300?D(H):B(H))}}),{files:ee}=JSON.parse(K);x.args[a]=ee,i||x.push(),R(`Successfully uploaded files: ${y}.`)}catch(K){K&&E(K instanceof XMLHttpRequest?K.responseText:"There was an error when uploading file."),k("")}finally{h([])}},ce=Y=>!T||T.some(U=>Y.toLowerCase().endsWith(U.toLowerCase())),re=Y=>{if(!c&&Y.length>1)return"Cannot upload multiple files. Input is not set to multiple mode.";const U=Y.filter(({name:K})=>!ce(K));if(U.length)return`Not allowed extension for files: ${U.map(({name:K})=>K).join(", ")}.
          Allowed file extensions: ${T==null?void 0:T.join(", ")}.`;if(S){const K=Y.filter(({size:ee})=>ee>S);if(K.length)return`Max file size exceeded for files: ${K.map(({name:ee})=>ee).join(", ")}.
            Allowed size per file: ${l}Mb.`}if(W&&Y.reduce((ee,{size:D})=>ee+D,0)>W)return`Total max file size exceeded. Allowed size: ${s}Mb.`},I=async Y=>{const U=Y.target.files;if(!(U==null?void 0:U.length))return;const K=Array.from(U),ee=re(K);ee?E(ee):(v&&E(""),h(K),k(K.map(({name:D})=>D).join(", ")),i&&(await te(K),b(0)))},j=Y=>{Y.preventDefault(),Y.stopPropagation(),u(!0)},P=Y=>{Y.preventDefault(),Y.stopPropagation(),u(!1)},p=Y=>{P(Y);const U=Y.dataTransfer.files;if(!U.length||v||C)return;const K=Array.from(U),ee=re(K);if(ee){E(ee);return}else v&&E("");h(K)},w=Y=>{Y.preventDefault(),Y.stopPropagation()},$=()=>E(""),A=()=>{R(""),b(0)},X=Y=>()=>{g.splice(Y,1),h([...g])},le=()=>v?t.createElement(t.Fragment,null,t.createElement(pe,{variant:"xLarge"},"An error occured"),t.createElement(Ut,{className:Te.uploadMessageBar,messageBarType:Xe.error,isMultiline:!0,onDismiss:$},v)):C?t.createElement(t.Fragment,null,t.createElement(pe,{variant:"xLarge"},"Upload successful"),t.createElement(Ut,{className:Te.uploadMessageBar,messageBarType:Xe.success,isMultiline:!0,onDismiss:A},C)):m?t.createElement(pe,{styles:{root:{pointerEvents:"none"}}},"Drop files anywhere within the box."):_?t.createElement(t.Fragment,null,t.createElement(mn,{styles:{root:{width:"80%"}},"data-test":"progress",description:`Uploading: ${(_*100).toFixed(2)}%`,percentComplete:_}),t.createElement(Ue,{styles:{root:{marginTop:12}},text:"Cancel",onClick:G.current})):g.length?t.createElement(t.Fragment,null,t.createElement(pe,{variant:"xLarge"},c?"Chosen Files":"Chosen File"),t.createElement(Re,{horizontal:!0,verticalAlign:"center",styles:{root:{maxWidth:"100%",overflowX:"auto",padding:"30px 0"}},tokens:{childrenGap:15}},g.map(({name:Y},U)=>t.createElement(Kr,{key:N.xid(),styles:{root:{textAlign:"center",position:"relative"}}},t.createElement($e,{className:Te.uploadRemove,iconName:"RemoveFilter",onClick:X(U)}),t.createElement($e,{iconName:"OpenFile",styles:{root:{fontSize:35}}}),t.createElement("br",null),t.createElement(pe,{nowrap:!0,styles:{root:{display:"block",margin:"15px 0"}}},Y))))):t.createElement(t.Fragment,null,t.createElement($e,{iconName:"Upload",styles:{root:{fontSize:50}}}),t.createElement("input",{id:a,"data-test":a,className:Te.uploadInput,onChange:I,type:"file",accept:T==null?void 0:T.join(","),multiple:c}),t.createElement("div",{className:d?Te.asterisk:void 0},t.createElement("label",{htmlFor:a,className:Te.uploadLabel},"Browse...")),t.createElement(pe,{styles:{root:{marginTop:15}}},"Or drag and drop ",c?"files":"a file"," here."));return i?(()=>t.createElement(t.Fragment,null,_?t.createElement("div",{style:{display:"flex",alignItems:"center"}},t.createElement(mn,{label:n?t.createElement(He,null,n):void 0,description:`Uploading: ${(_*100).toFixed(2)}%`,percentComplete:_,styles:{root:{flex:1},itemName:{padding:0},itemProgress:{paddingTop:5,paddingBottom:5}}}),t.createElement(Et,{iconProps:{iconName:"cancel"},title:"Cancel",onClick:G.current,styles:{root:{padding:16,marginTop:11,marginLeft:6}}})):t.createElement(t.Fragment,null,n&&t.createElement(He,{style:{paddingTop:6},required:d},n),t.createElement("div",{className:Te.compact},t.createElement(Ie,{"data-test":`textfield-${a}`,readOnly:!0,value:y,errorMessage:v,required:n?void 0:d}),t.createElement("input",{id:a,"data-test":a,type:"file",hidden:!0,onChange:I,accept:T==null?void 0:T.join(","),multiple:c}),t.createElement("label",{htmlFor:a,className:M(Te.uploadLabel,Te.uploadLabelCompact)},"Browse")))))():t.createElement(t.Fragment,null,t.createElement("form",{className:m&&!v&&!C?M(Te.upload,Te.uploadDragging):Te.upload,style:{height:o||300},onDragStart:j,onDragEnter:j,onDragEnd:P,onDragLeave:P,onDrop:p,onDragOver:w},le()),t.createElement(Oe,{disabled:!!_||!g.length,text:n||"Upload",onClick:()=>te()}))},rr=F({card:{display:"flex",flexDirection:"column",padding:se.gap},body:{flexGrow:1,position:"relative",$nest:{iframe:{position:"absolute",top:0,left:0,right:0,bottom:0}}}}),vs=e=>e.replace(/(\s+src\s*=\s*["'])\//g,`$1${window.location.protocol}//${window.location.host}/`),lr=e=>URL.createObjectURL(new Blob([vs(e)],{type:"text/html"})),Ml=({path:e,content:a})=>t.createElement("iframe",{title:N.xid(),src:e||lr(a||"Nothing to render."),frameBorder:"0",width:"100%",height:"100%"}),xs=({model:{name:e,path:a,content:n,width:r="100%",height:l="150px"}})=>t.createElement("div",{"data-test":e,style:{width:Nt(r),height:l}},t.createElement(Ml,{path:a,content:n})),bs=V(({name:e,state:a,changed:n})=>({render:()=>t.createElement("div",{"data-test":e,className:rr.card},t.createElement("div",{className:"wave-s12 wave-w6"},a.title),t.createElement("div",{className:rr.body},t.createElement(Ml,{path:a.path,content:a.content}))),changed:n}));Q.register("frame",bs);const Ct=N.box(),Fl=40,Wl=40,Hl=10,Ol=148,jt=120,fn=38,Ce=F({body:{position:"fixed",inset:"0px",zIndex:1,backgroundColor:"rgba(0, 0, 0, 0.9)"},img:{position:"absolute",inset:"0px",margin:"auto",maxHeight:"100%",maxWidth:"100%"},header:{height:Fl,textAlign:"right"},content:{position:"relative"},footer:{boxSizing:"border-box",padding:`${Hl}px 0`,textAlign:"center",color:"#fff"},imageNav:{marginTop:10,height:Ol,boxSizing:"border-box",overflow:"auto",whiteSpace:"nowrap"},navImg:{boxSizing:"border-box",objectFit:"cover",height:jt,width:jt,margin:"2px",cursor:"pointer",filter:"brightness(30%)",border:"2px solid #000"},text:{whiteSpace:"nowrap",boxSizing:"border-box",width:"fit-content",margin:"0 auto",maxWidth:"calc(100% - 40px)",textOverflow:"ellipsis",overflow:"hidden",height:Wl/2},title:{fontWeight:500},description:{color:"#bbb"},navImgContainer:{display:"inline-block",width:jt},iconStylesRootArrow:{position:"absolute",top:"50%",padding:"16px",marginTop:-fn/2}}),Va={icon:{fontSize:"22px"}},ja={flexContainer:{justifyContent:"center"},root:{margin:4,width:fn,height:fn,backgroundColor:"rgba(0, 0, 0, 0.3)"},rootHovered:{backgroundColor:"rgba(255, 255, 255, 0.3)"},icon:{color:"#fff",lineHeight:22,height:"unset",padding:4},iconHovered:{color:"#fff"},iconPressed:{color:"rgba(255, 255, 255, 0.7)"}},Es=({images:e,defaultImageIdx:a})=>{const[n,r]=t.useState(a||0),{title:l,description:i}=e[n],o=e.length>1,s=Hl*2+Wl+(o?Ol:0),c=t.useRef(null),d=t.useRef(null),m=t.useRef(!1),u=nt(_e(f("$neutralPrimary")))?f("$card"):f("$neutralPrimary"),g={filter:"unset",border:"2px solid",borderColor:u},h=new window.IntersectionObserver(v=>v.forEach(E=>{if(E.isIntersecting){const C=E.target;C.src=C.dataset.src,C.classList.remove("lazy"),h.unobserve(C)}})),y=()=>r(v=>v===0?e.length-1:v-1),k=()=>r(v=>v===e.length-1?0:v+1),_=v=>{v.key==="Escape"?Ct(null):v.key==="ArrowRight"?k():v.key==="ArrowLeft"&&y()},b=v=>{v.target.parentElement===v.currentTarget&&Ct(null)};return t.useEffect(()=>{var v;document.querySelectorAll(".lazy").forEach(E=>h.observe(E)),(v=c==null?void 0:c.current)==null||v.focus()},[]),t.useEffect(()=>{if(o&&d.current){const v=d.current,E=v.clientWidth/2-jt/2,C=n*jt,R=m.current?"smooth":"auto";n===0?v.scrollLeft=0:n===e.length-1?v.scrollLeft=v.scrollWidth-(v==null?void 0:v.clientWidth):C>E?v.scrollTo({left:C-E,behavior:R}):v.scrollTo({left:0,behavior:R}),m.current||(m.current=!0)}},[n]),t.createElement("div",{className:Ce.body,onKeyDown:_,tabIndex:0,ref:c,onClick:b},t.createElement("div",{className:Ce.header},t.createElement(kt,{styles:ja,onClick:()=>Ct(null),iconProps:{iconName:"Cancel",style:Va.icon}})),t.createElement("div",{className:Ce.content,style:{height:`calc(100% - ${Fl+s}px)`}},t.createElement("img",{className:Ce.img,alt:l,src:e[n].path}),o&&t.createElement(t.Fragment,null,t.createElement(kt,{styles:ja,className:Ce.iconStylesRootArrow,style:{left:0},onClick:y,iconProps:{iconName:"ChevronLeft",style:Va.icon}}),t.createElement(kt,{styles:ja,className:Ce.iconStylesRootArrow,style:{right:0},onClick:k,iconProps:{iconName:"ChevronRight",style:Va.icon}}))),t.createElement("div",{className:Ce.footer,style:{height:s}},t.createElement("div",{title:l,className:M(Ce.text,Ce.title)},l),t.createElement("div",{title:i,className:M(Ce.text,Ce.description)},i||""),o&&t.createElement("div",{className:Ce.imageNav,ref:d},e.map((v,E)=>t.createElement("div",{key:E,className:Ce.navImgContainer},t.createElement("img",{className:M(Ce.navImg,"lazy",Yr({$nest:{"&:hover":g}})),style:n===E?g:void 0,alt:l,"data-src":v.path,onClick:()=>r(E)}))))))},Vl=F({card:{display:"flex",flexDirection:"column",padding:se.gap},img:{flexGrow:1,objectFit:"contain",maxHeight:"calc(100% - 20px)"}}),jl=({model:e})=>{const{title:a,type:n,image:r,width:l,path_popup:i}=e,o=({type:c,image:d,path:m})=>m||(d&&c?`data:image/${c};base64,${d}`:""),s=()=>{i&&Ct({images:[{title:a,type:n,image:r,path:i}]})};return t.createElement("img",{className:Vl.img,alt:a,src:o(e),width:Nt(l),onClick:s,style:{cursor:i?"pointer":"default"}})},ws=V(({name:e,state:a,changed:n})=>({render:()=>{const{title:l,type:i,image:o,data:s,path:c,path_popup:d}=a;return t.createElement("div",{"data-test":e,className:Vl.card},t.createElement(ne,{data:s,format:l,className:"wave-s12 wave-w6"}),t.createElement(jl,{model:{title:l,type:i,image:o,path:c,path_popup:d}}))},changed:n}));Q.register("image",ws);const ks=({model:e})=>{const{label:a,required:n=!1,disabled:r=!1,name:l}=e;return t.createElement(He,{"data-test":l,required:n,disabled:r},a)},Xa=F({linkGroup:{margin:ve(-6,12,0,12),$nest:{a:{display:"block",marginTop:8},"a:first-of-type":{marginTop:0}}},linkGroupLabel:{marginBottom:10},inline:{display:"flex",$nest:{a:{marginRight:16},"a:last-child":{marginRight:0}}}}),Cs=({model:{label:e,items:a,inline:n}})=>t.createElement("div",{className:n?Xa.inline:Xa.linkGroup},e&&t.createElement("div",{className:M("wave-s20 wave-w6",Xa.linkGroupLabel)},e),a.filter(({link:r})=>r).map((r,l)=>t.createElement(Xl,{key:l,model:r.link}))),Xl=({model:{name:e,label:a,disabled:n,path:r,download:l,target:i,button:o}})=>{const s=a||r,c=i===""?"_blank":i,d=t.useCallback(()=>window.open(r,c),[c,r]),m=t.useCallback(u=>{l&&r&&(u.preventDefault(),window.open(r,"_blank"))},[l,r]);return o?t.createElement(Ue,{"data-test":e,text:s,disabled:n,onClick:d}):t.createElement(ze,{onClick:m,"data-test":e,href:r,disabled:n,target:c},s)},ir=F({card:{display:"flex",flexDirection:"column",padding:se.gap},body:{flexGrow:1}}),zn=({model:{content:e,name:a}})=>t.createElement("div",{"data-test":a,dangerouslySetInnerHTML:{__html:e}}),Ul=({name:e,title:a,content:n})=>t.createElement("div",{"data-test":e,className:ir.card},a&&t.createElement("div",{className:"wave-s12 wave-w6"},a),t.createElement("div",{className:ir.body},t.createElement(zn,{model:{content:n}}))),$s=V(({name:e,state:a,changed:n})=>({render:()=>t.createElement(Ul,{name:e,title:a.title,content:a.content}),changed:n}));Q.register("markup",$s);const Gl=F({messageBar:{$nest:{".wave-markdown > *:first-child":{marginTop:0},".wave-markdown > *:only-child":{marginBottom:0},".wave-markdown p":{fontSize:14,lineHeight:ge(20),letterSpacing:"-0.006em"},".ms-MessageBar-dismissal .ms-Button-icon":{fontSize:16}}}}),ql={info:{iconName:"InfoSolid",background:"#DBEEFD",color:"#165589"},error:{iconName:"StatusErrorFull",background:"#F1CBCB",color:"#5E0000"},warning:{iconName:"IncidentTriangle",background:"#FFF6DC",color:"#8F7015"},success:{iconName:"CompletedSolid",background:"#CAEACA",color:"#094609"},danger:{iconName:"IncidentTriangle",background:"#F1CBCB",color:"#5E0000"},blocked:{iconName:"Blocked2Solid",background:"#F1CBCB",color:"#5E0000"}},Ql=e=>{switch(e){case"error":return Xe.error;case"warning":return Xe.warning;case"success":return Xe.success;case"danger":return Xe.severeWarning;case"blocked":return Xe.blocked;default:return Xe.info}},Ns=({type:e,text:a,buttons:n,name:r})=>{const{iconName:l,color:i,background:o}=ql[e||"info"],s=n==null?void 0:n.filter(({button:c})=>c);return(a==null?void 0:a.length)?t.createElement(Ut,{"data-test":r,styles:{root:{background:o,color:i,borderRadius:4,width:"auto",".ms-Link":{color:i,fontWeight:600},".ms-Link:hover":{textDecoration:"none"},padding:"8px 16px",minHeight:24},content:{alignItems:"center"},icon:{fontSize:24,color:i,display:"inline-flex"},iconContainer:{margin:0,marginRight:16,display:"flex",alignItems:"center"},text:{margin:0},innerText:{whiteSpace:ye("initial")},actions:{margin:0}},messageBarType:Ql(e),className:Gl.messageBar,isMultiline:!1,actions:(s==null?void 0:s.length)?t.createElement(Ee,{items:s||[],alignment:"end"}):void 0,messageBarIconProps:{iconName:l}},t.createElement(Pe,{source:a})):null},Ss=({model:e})=>t.createElement(Ns,{name:e.name,text:e.text,type:e.type,buttons:e.buttons}),_s={xs:rt.size48,s:rt.size56,m:rt.size72,l:rt.size100,xl:rt.size120},na=({model:e})=>{const a=()=>{if(e.name){if(e.name.startsWith("#")){window.location.hash=e.name.substring(1);return}x.args[e.name]=!0,x.push()}};return t.createElement("div",{"data-test":e.name,onClick:a},t.createElement(Jr,{styles:{root:{cursor:e.name?"pointer":"initial"},details:{paddingRight:0}},text:e.title,secondaryText:e.subtitle,tertiaryText:e.caption,imageUrl:e.image,imageInitials:e.initials,initialsColor:f(e.initials_color),size:e.size?_s[e.size]:rt.size72}))},Ps={suggestionsHeaderText:"Suggestions",noResultsFoundText:"No results found"},Ts=({model:e})=>{const a=t.useMemo(()=>e.choices.map(({name:s,label:c})=>({key:s,name:c||s})),[e.choices]),[n,r]=t.useState(a.filter(({key:s})=>{var c;return(c=e.values)==null?void 0:c.includes(s)})),l=(s,c)=>{if(!s)return[];const d=m=>m.toLowerCase().includes(s.toLowerCase());return a.filter(m=>d(m.name)&&!(c==null?void 0:c.includes(m)))},i=s=>{r(s||[]),x.args[e.name]=s?s.map(({key:c})=>c):null,e.trigger&&x.push()},o=()=>a;return t.useEffect(()=>{x.args[e.name]=e.values||null},[]),t.createElement(t.Fragment,null,e.label&&t.createElement(He,{required:e.required},e.label),t.createElement(zi,{inputProps:{"data-test":e.name},removeButtonAriaLabel:"Remove",onResolveSuggestions:l,onChange:i,pickerSuggestionsProps:Ps,itemLimit:e.max_choices,selectedItems:n,disabled:e.disabled,onEmptyResolveSuggestions:o}))},Ds="modulepreload",or={},Ls="",We=function(a,n){return!n||n.length===0?a():Promise.all(n.map(r=>{if(r=`${Ls}${r}`,r in or)return;or[r]=!0;const l=r.endsWith(".css"),i=l?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${r}"]${i}`))return;const o=document.createElement("link");if(o.rel=l?"stylesheet":Ds,l||(o.as="script",o.crossOrigin=""),o.href=r,document.head.appendChild(o),l)return new Promise((s,c)=>{o.addEventListener("load",s),o.addEventListener("error",c)})})).then(()=>a())};let Mt=["$gray","$blue","$green","$amber","$tangerine","$purple","$cyan","$mint","$pink","$brown"];(async()=>{const{registerInteraction:e}=await We(()=>import("./index.8b96f623.js"),["wave-static/index.8b96f623.js","wave-static/vendor.9571d771.js"]);e("drag_move",{start:[{trigger:"plot:mousedown",action:"scale-translate:start"}],processing:[{trigger:"plot:mousemove",action:"scale-translate:translate",throttle:{wait:100,leading:!0,trailing:!1}}],end:[{trigger:"plot:mouseup",action:"scale-translate:end"}]});const a=n=>(n.gEvent.preventDefault(),n.gEvent.originalEvent.deltaY>0);e("scale_zoom",{start:[{trigger:"plot:mousewheel",isEnable:n=>a(n.event),action:"scale-zoom:zoomOut",throttle:{wait:100,leading:!0,trailing:!1}},{trigger:"plot:mousewheel",isEnable:n=>!a(n.event),action:"scale-zoom:zoomIn",throttle:{wait:100,leading:!0,trailing:!1}}]}),e("brush",{showEnable:[{trigger:"plot:mouseenter",action:"cursor:crosshair"},{trigger:"plot:mouseleave",action:"cursor:default"}],start:[{trigger:"plot:mousedown",action:["brush:start","rect-mask:start","rect-mask:show"]}],processing:[{trigger:"plot:mousemove",action:["rect-mask:resize"]}],end:[{trigger:"plot:mouseup",action:["brush:filter","brush:end","rect-mask:end","rect-mask:hide"]}],rollback:[{trigger:"dblclick",action:["brush:reset"]}]})})();const Kl=()=>({defaultColor:ae("$themePrimary"),labels:{style:{fill:ae("$text")}},geometries:{point:{"hollow-circle":{default:{style:{fill:"transparent"}}}},interval:{rect:{selected:{style:{stroke:ae("$text")}}}}},components:{annotation:{dataMarker:{point:{style:{stroke:ae("$themePrimary"),fill:ae("$card")}}},line:{style:{fill:ae("$neutralPrimaryAlt")}},region:{style:{fill:ae("$themePrimary"),fillOpacity:.3}}},legend:{common:{itemName:{style:{fill:ae("$text")}},pageNavigator:{text:{style:{fill:ae("$text")}},marker:{style:{fill:ae("$themePrimary"),inactiveFill:ae("$themePrimary")}}}},continuous:{label:{style:{fill:ae("$text")}},handler:{style:{fill:ae("$neutralPrimaryAlt")}}}},axis:{top:{title:{style:{fill:ae("$text")}}},right:{title:{style:{fill:ae("$text")}}},bottom:{title:{style:{fill:ae("$text")}}},left:{title:{style:{fill:ae("$text")}}},circle:{label:{style:{fill:ae("$text")}}},radius:{label:{style:{fill:ae("$text")}}},common:{label:{style:{fill:ae("$text")}},grid:{line:{style:{stroke:ae("$neutralPrimaryAlt"),strokeOpacity:.2}}},line:{style:{stroke:ae("$neutralPrimaryAlt"),strokeOpacity:.6}},tickLine:{style:{stroke:ae("$neutralPrimaryAlt"),strokeOpacity:.6}}}}}}),As=(e,a)=>Ws[dr(e,a,"x")+dr(e,a,"y")],we=e=>typeof e=="number",Rs=e=>typeof e=="boolean",O=e=>typeof e=="string",Qt=e=>e.trim().split(/\s+/g),Yl=e=>Qt(e).map(a=>parseInt(a,10)),ca=(e,a)=>{for(const n of e)if(n){const r=n[a];r&&O(r)&&(n[a]=new Date(r.includes("T")?r:`${r}T00:00:00`))}},da=(e,a,n,r)=>{for(const l of e)l&&(l[r]=[l[a],l[n]])},sr=(e,a,n,r,l,i,o)=>{for(const s of e)s&&(s[o]=[s[a],s[n],s[r],s[l],s[i]])},Is=" 0 1 2 _q1 _q2 _q3".split(" "),zs=Qt("min max nice scale title"),Jl=e=>Is.map(a=>e+a),Zl=e=>zs.map(a=>`${e}_${a}`),Bn=e=>e.map(a=>[a,a+"_field",a+"_format"]),hn=Bn(Jl("x")),ei=Bn(Jl("y")),cr=Zl("x"),Bs=Zl("y"),Ms=Bn(Qt("color shape size dodge label")),Fs=[...hn,...ei,...Ms],dr=(e,a,n)=>{const r=n+"_field",l=n+"_scale";for(const i of a){const o=i,s=o[r];if(o[l]==="time")return"t";if(O(s))for(const d of e){const m=d[s];if(we(m))return"c";if(O(m))return"d"}}return"c"},Ws={cc:0,dd:1,tt:2,dc:4,cd:3,tc:5,ct:6,td:7,dt:8},mr={},Hs=(e,a)=>(n,r)=>{const l=n?n[e]:r;return l!=null?(mr[e]=l,a(mr)):""},Os=e=>{const a=e;for(let n=0;n<hn.length;n++){const r=hn[n],l=ei[n];for(let i=0;i<r.length;i++){const o=a[r[i]];a[r[i]]=a[l[i]],a[l[i]]=o}}for(let n=0;n<cr.length;n++){const r=cr[n],l=Bs[n],i=a[r];a[r]=a[l],a[l]=i}},Vs=e=>{const a=e;for(const[n,r,l]of Fs){const i=a[n];if(O(i)){const o=Ho(i);if(o){const[s,c]=o;a[n]=void 0,a[r]=s,c&&(a[l]=Hs(s,c))}}}return e},ur=(e,a)=>{for(const n of a)if(n.x_scale==="time"){for(const{x_field:r,x0_field:l}of a)O(r)&&ca(e,r),O(l)&&ca(e,l);O(n.x)&&(n.x=new Date(n.x)),O(n.x0)&&(n.x0=new Date(n.x0));break}for(const n of a)if(n.y_scale==="time"){for(const{y_field:r,y0_field:l}of a)O(r)&&ca(e,r),O(l)&&ca(e,l);O(n.y)&&(n.y=new Date(n.y)),O(n.y0)&&(n.y0=new Date(n.y0));break}for(const{x_field:n,x0_field:r}of a)O(n)&&O(r)&&da(e,r,n,n);for(const{y_field:n,y0_field:r}of a)O(n)&&O(r)&&da(e,r,n,n);for(const n of a){const{type:r,x1_field:l,x2_field:i,y_field:o}=n;r==="interval"&&O(l)&&O(i)&&O(o)&&(n.x_field=l+" - "+i,da(e,l,i,n.x_field))}for(const n of a){const{type:r,y1_field:l,y2_field:i,x_field:o}=n;r==="interval"&&O(l)&&O(i)&&O(o)&&(n.y_field=l+" - "+i,da(e,l,i,n.y_field))}for(const n of a){const{type:r,x1_field:l,x_q1_field:i,x_q2_field:o,x_q3_field:s,x2_field:c,y_field:d}=n;r==="schema"&&O(l)&&O(i)&&O(o)&&O(s)&&O(c)&&O(d)&&(n.x_field=[l,i,o,s,c].join("-"),sr(e,l,i,o,s,c,n.x_field))}for(const n of a){const{type:r,x_field:l,y1_field:i,y_q1_field:o,y_q2_field:s,y_q3_field:c,y2_field:d}=n;r==="schema"&&O(i)&&O(o)&&O(s)&&O(c)&&O(d)&&O(l)&&(n.y_field=[i,o,s,c,d].join("-"),sr(e,i,o,s,c,d,n.y_field))}return e},js=({x:e,x0:a,y:n,y0:r,label:l,fill_color:i,fill_opacity:o,stroke_color:s,stroke_opacity:c,stroke_size:d,stroke_dash:m,ref_stroke_color:u,ref_stroke_opacity:g,ref_stroke_dash:h,ref_stroke_size:y,label_fill_color:k,label_fill_opacity:_,label_stroke_color:b,label_stroke_opacity:v,label_stroke_size:E,label_font_size:C,label_font_weight:R,label_line_height:S,label_align:W})=>{const T=ti(k,_,b,v,E,C,R,S,W),G=yn(i,o,s,c,d,m),te=yn(void 0,void 0,u,g,y,h);return e!=null&&n!=null?a!=null&&r!=null?[{type:"region",start:[a,r],end:[e,n],text:O(l)?{content:l,style:T}:void 0,style:G}]:[{type:"dataMarker",position:[e,n],text:O(l)?{content:l,style:T}:null,point:{style:G},line:{style:te}}]:e!=null?a!=null?[{type:"region",start:[a,"min"],end:[e,"max"],text:O(l)?{content:l,style:T}:null,style:G}]:[{type:"line",start:[e,"min"],end:[e,"max"],text:O(l)?{content:l,style:T,position:"start"}:void 0,style:te}]:r!=null?[{type:"region",start:["min",r],end:["max",n],text:O(l)?{content:l,style:T}:null,style:G}]:[{type:"line",start:["min",n],end:["max",n],text:O(l)?{content:l,style:T,position:"start"}:void 0,style:te}]},Xs=({type:e,x_field:a,y_field:n,color_field:r,color_range:l,color_domain:i,color:o,shape_field:s,shape_range:c,shape:d,size_field:m,size_range:u,size:g,stack:h,dodge:y,dodge_field:k,curve:_,fill_color:b,fill_opacity:v,stroke_color:E,stroke_opacity:C,stroke_dash:R,stroke_size:S,label_field:W,label_format:T,label_offset:G,label_offset_x:te,label_offset_y:ce,label_rotation:re,label_position:I,label_overlap:j,label_fill_color:P,label_fill_opacity:p,label_stroke_color:w,label_stroke_opacity:$,label_stroke_size:A,label_font_size:X,label_font_weight:le,label_line_height:me,label_align:Y})=>{const U={};O(e)&&(U.type=e);const K=[];if(O(k)?K.push({type:"dodge",marginRatio:0,dodgeBy:k}):y==="auto"&&K.push({type:"dodge",marginRatio:0}),h==="auto"&&K.push({type:"stack"}),K.length&&(U.adjust=K),O(a)&&O(n)&&(U.position={fields:[a,n]}),O(r)){const D=O(l)?Qt(l).map(ae):Mt;if(U.color={fields:[r],values:D},i&&i.length==D.length){const B=i.reduce((H,z,q)=>(H[z]=D[q],H),{});U.color.callback=H=>B[H]}}else U.color=ae(O(o)?o:"$themePrimary");if(O(s)?O(c)?U.shape={fields:[s],values:Qt(c)}:U.shape={fields:[s]}:O(d)&&(U.shape=d),e==="schema"&&(U.shape="box"),O(m)?O(u)?U.size={fields:[m],values:Yl(u)}:U.size={fields:[m]}:we(g)&&(U.size=g),O(W)){const D=ti(P,p,w,$,A,X,le,me,Y),B={};switch(D&&(B.style=D),j){case"hide":B.layout={type:"overlap"};break;case"overlap":B.layout={type:"fixedOverlap"};break;case"constrain":B.layout={type:"limitInShape"};break}if(we(G)&&(B.offset=G),we(te)&&(B.offsetX=te),we(ce)&&(B.offsetY=ce),O(re)){const H=N.parseI(re);isNaN(H)?B.autoRotate=re!=="none":B.rotate=H*Math.PI/180}switch(I){case"top":case"bottom":case"middle":case"left":case"right":B.position=I}T?U.label={fields:[W],callback:H=>({content:T(null,H)})}:U.label={fields:[W]},Object.keys(B).length&&(U.label.cfg=B)}if(O(_))switch(_){case"smooth":U.shape="smooth";break;case"step-before":U.shape="vh";break;case"step":U.shape="hvh";break;case"step-after":U.shape="hv";break}const ee=yn(b,v,E,C,S,R);return ee&&(U.style=ee),U},yn=(e,a,n,r,l,i)=>{const o={};return O(e)&&(o.fill=ae(e)),we(a)&&(o.fillOpacity=a),O(n)&&(o.stroke=ae(n)),we(r)&&(o.strokeOpacity=r),we(l)&&(o.lineWidth=l),O(i)&&(o.lineDash=Yl(i)),Object.keys(o).length?o:void 0},ti=(e,a,n,r,l,i,o,s,c)=>{const d={};if(d.fill=ae(O(e)?e:"$neutralPrimaryAlt"),we(a)&&(d.fillOpacity=a),O(n)&&(d.stroke=ae(n)),we(r)&&(d.strokeOpacity=r),we(l)&&(d.lineWidth=l),we(i)&&(d.fontSize=i),O(o)){const m=N.parseU(o);d.fontWeight=isNaN(m)?o:m}return we(s)&&(d.lineHeight=s),O(c)&&(d.textAlign=c),Object.keys(d).length?d:void 0},Us=e=>{const a={},n={};for(const r of e)if(r.x_field){const[l,i]=gr(r.x_scale,r.x_format,r.x_title,r.x_min,r.x_max,r.x_nice);a[r.x_field]=a[r.x_field]?L(L({},a[r.x_field]),l):l,i&&(n[r.x_field]=i)}for(const r of e)if(r.y_field){const[l,i]=gr(r.y_scale,r.y_format,r.y_title,r.y_min,r.y_max,r.y_nice);a[r.y_field]=a[r.y_field]?L(L({},a[r.y_field]),l):l,i&&(n[r.y_field]=i)}return[a,n]},Gs=e=>{switch(e){case"time-category":return"timeCat";case"power":return"pow"}return e},gr=(e,a,n,r,l,i)=>{const o={},s={label:{autoHide:!1,autoRotate:!0},title:null};return O(e)&&(o.type=Gs(e)),a&&(o.formatter=c=>a(void 0,c)),O(n)&&(o.alias=n,s.title={}),we(r)&&(o.min=r),we(l)&&(o.max=l),o.nice=Rs(i)?i:!0,[o,s]},qs=e=>{for(const{coord:a}of e)if(O(a))return a},Qs=(e,a)=>{const n=qs(a),r=e===3,l=r?[["transpose"]]:void 0;if(r)for(const i of a)Os(i);return n?l?{type:n,actions:l}:{type:n}:l?{actions:l}:void 0},ai=e=>{const a=[],n=[];for(const r of e){const{x:l,y:i}=r;l!=null||i!=null?n.push(...js(r)):a.push(Xs(r))}return[a,n]},Ks=(e,a,n,r)=>{const l=Qs(a,n),[i,o]=Us(n),[s,c]=ai(n);return{container:e,autoFit:!0,renderer:"canvas",theme:Kl(),options:{animate:!1,coordinate:l,scales:i,axes:o,geometries:s,annotations:c,interactions:r.map(d=>({type:d}))}}},vn=F({card:{display:"flex",flexDirection:"column",padding:se.gap},body:{flexGrow:1,display:"flex"},plot:{userSelect:"none","-webkit-user-select":"none",$nest:{svg:{position:"absolute",top:0,left:0,right:0,bottom:0}}}}),xn=document.createElement("div");xn.className="g2-tooltip";const Ys=({items:e})=>t.createElement(t.Fragment,null,e.map(({data:a,mappingData:n,color:r})=>Object.keys(a).map((l,i)=>t.createElement("li",{key:i,className:"g2-tooltip-list-item","data-index":i,style:{display:"flex",alignItems:"center",marginBottom:4}},t.createElement("span",{style:{backgroundColor:(n==null?void 0:n.color)||r},className:"g2-tooltip-marker"}),t.createElement("span",{style:{display:"inline-flex",flex:1,justifyContent:"space-between"}},t.createElement("span",{style:{marginRight:16}},l,":"),t.createElement("span",null,(Array.isArray(a[l])?a[l]:[a[l]]).map((o,s)=>{const c=o instanceof Date?o.toISOString().split("T")[0]:o;return s>0?` - ${c}`:c}))))))),Mn=({model:e})=>{const a=t.useRef(null),n=t.useRef(null),r=t.useRef(null),l=t.useRef(null),i=(u,g)=>{var y;const h=a.current;!h||(h.clientHeight!==g||h.clientWidth!==u)&&((y=n.current)==null||y.destroy(),o())},o=async()=>{Mt=Mt.map(ae);const u=a.current;if(!u)return;u.clientHeight<30&&(u.style.height="300px");const g=N.unpack(e.data),h=N.unpack(e.plot),y=h.marks.map(Vs),k={marks:y},_=As(g,y),b=ur(g,k.marks),{Chart:v}=await We(()=>import("./index.8b96f623.js"),["wave-static/index.8b96f623.js","wave-static/vendor.9571d771.js"]),E=k.marks?new v(Ks(u,_,k.marks,e.interactions||[])):null;if(r.current=k,E){if(E.tooltip({title:" ",showCrosshairs:!0,crosshairs:{type:"xy"},domStyles:{"g2-tooltip":{backgroundColor:f("$card"),color:f("$text")}},customContent:(C,R)=>(Zr.render(t.createElement(Ys,{items:R}),xn),xn)}),n.current=E,E.data(b),e.plot.marks.filter(({x:C,y:R})=>C==null&&R==null).forEach(({interactive:C=!0},R)=>E.geometries[R].customInfo({interactive:C})),e.events)for(const C of e.events)switch(C){case"select_marks":E.interaction("element-single-selected"),E.on("element:statechange",R=>{var W;const S=R.gEvent.originalEvent;S.stateStatus&&S.state==="selected"&&e.name&&S.element.geometry.customOption.interactive&&x.emit(e.name,C,[(W=S.element)==null?void 0:W.data])})}E.render(),setTimeout(()=>i(u.clientWidth,u.clientHeight),300),l.current=N.on(za,()=>{Mt=Mt.map(ae);const[C,R]=ai(y);E.updateOptions({geometries:C,annotations:R}),E.theme(Kl()),E.render(!0)})}};t.useEffect(()=>(o(),()=>{var u;return(u=l.current)==null?void 0:u.dispose()}),[]),t.useEffect(()=>{if(!a.current||!n.current||!r.current)return;const g=N.unpack(e.data),h=ur(g,r.current.marks);n.current.changeData(h)},[n,r,e]);const{width:s="auto",height:c="auto",name:d}=e,m=s==="auto"&&c==="auto"?{flexGrow:1}:{width:Nt(s),height:c};return t.createElement("div",{"data-test":d,style:m,className:vn.plot,ref:a})},Js=V(({name:e,state:a,changed:n})=>({render:()=>{const{title:l="Untitled",plot:i,data:o,events:s,interactions:c}=a;return t.createElement("div",{className:vn.card},t.createElement("div",{className:"wave-s12 wave-w6"},l),t.createElement("div",{className:vn.body},t.createElement(Mn,{model:{name:e,plot:i,data:o,events:s,interactions:c}})))},changed:n}));Q.register("plot",Js);const Zs=({model:e})=>{const{label:a,caption:n="Please wait...",value:r,name:l}=e;return t.createElement("div",{"data-test":l},t.createElement(mn,{label:a,description:n,percentComplete:r}))},ec=({model:e})=>{const{min:a=0,max:n=100,step:r=1,min_value:l,max_value:i=n,disabled:o,trigger:s,name:c,label:d}=e,m=t.useCallback((g,h)=>{h&&(x.args[c]=h)},[c]),u=t.useCallback(()=>{s&&x.push()},[s]);return t.useEffect(()=>{x.args[c]=[typeof l=="number"&&l>a&&l<=n?l:a,typeof i=="number"&&i>a&&i<=n?i:n]},[]),t.createElement("div",{"data-test":c},t.createElement(el,{ranged:!0,max:n,min:a,step:r,label:d,defaultLowerValue:l,defaultValue:i,disabled:o,onChange:m,onChanged:u}))},tc=F({separator:{boxSizing:"border-box"}}),ac=({model:e})=>t.createElement("div",{"data-test":e.name,className:tc.separator},t.createElement(Aa,null,e.label)),nc=({model:e})=>{const{min:a=0,max:n=100,step:r=1,value:l=0}=e,i=l<a?a:l>n?n:l,o=c=>x.args[e.name]=c,s=t.useCallback((c,d)=>{e.trigger&&x.push()},[e.trigger]);return t.useEffect(()=>{x.args[e.name]=i},[]),t.createElement(el,{"data-test":e.name,buttonProps:{"data-test":e.name},label:e.label,min:a,max:n,step:r,defaultValue:i,showValue:!0,originFromZero:a<0&&n>=0,onChange:o,onChanged:s,disabled:e.disabled})},rc=500,lc=(e,a)=>{const n=Math.pow(10,a);return Math.round(e*n)/n},ic=e=>{var n,r;const a=/[1-9]([0]+$)|\.([0-9]*)/.exec(String(e));return a&&(-((n=a[1])==null?void 0:n.length)||((r=a[2])==null?void 0:r.length))||0},oc=({model:{name:e,trigger:a,label:n,disabled:r,min:l=0,max:i=100,step:o=1,value:s=0}})=>{const[c,d]=t.useState(String(s)),m=Math.max(ic(o),0),u=t.useCallback(v=>{const E=lc(v,m);return!isNaN(E)&&isFinite(E)?E:s},[m,s]),g=()=>{const v=Math.min(u(Number(c)+o),i);return x.args[e]=v,a&&x.push(),d(String(v)),String(v)},h=()=>{const v=Math.max(u(Number(c)-o),l);return x.args[e]=v,a&&x.push(),d(String(v)),String(v)},y=t.useCallback(v=>{const E=/\.$|\.\d*0+$/,C=u(Number(v)),R=C>i?i:C<l?l:C;if(v==="-")d("-");else if(!m)d(String(R).split(".")[0]);else if(E.test(v)){const[S,W=""]=v.split(".");d(`${S}.${W.slice(0,m)}`)}else d(String(R));return R},[i,l,u,m]),k=t.useCallback(v=>{x.args[e]=v,a&&x.push()},[e,a]),_=t.useRef(x.debounce(rc,k)),b=v=>{const E=y(v.target.value);a?_.current(E):k(E)};return t.useEffect(()=>{x.args[e]=s<l?l:s>i?i:s},[]),t.createElement(tl,{inputProps:{"data-test":e,value:c},label:n,onInput:b,min:l,max:i,step:o,onIncrement:g,onDecrement:h,disabled:r})},ct=F({stats:{display:"flex",alignItems:"flex-start",overflowX:"auto"},inset:{background:f("$page"),padding:be(10,15)},stat:{display:"flex",alignItems:"center"},lhs:{width:45,marginRight:"0.5em"},icon:{height:45,width:45},statCaption:{color:f("$text5")}}),sc={start:"flex-start",end:"flex-end",center:"center",between:"space-between",around:"space-around"},Ua="2em",cc=({model:e})=>{var l;const a=e.justify?e.justify==="start"?{marginRight:Ua}:e.justify==="end"?{marginLeft:Ua}:{}:{marginRight:Ua},n=sc[(l=e.justify)!=null?l:""],r=e.items.map(({label:i,value:o,caption:s,icon:c,icon_color:d},m)=>t.createElement("div",{key:`${m}:${i}`,className:ct.stat,style:a},c&&t.createElement("div",{className:ct.lhs,style:d?{color:f(d)}:void 0},t.createElement($e,{className:ct.icon,iconName:c,styles:{root:{"> span":{height:"100%",width:"100%"}}}})),t.createElement("div",null,t.createElement("div",{className:"wave-s12 wave-w5"},i),o&&t.createElement("div",{className:"wave-s24 wave-w3"},o),s&&t.createElement("div",{className:M(ct.statCaption,"wave-s13")},s))));return t.createElement("div",{className:M(ct.stats,e.inset?ct.inset:""),style:{justifyContent:n}},r)},pr=F({stepNumber:{background:"var(--text)",color:"var(--card)",alignItems:"center",borderRadius:"50%",display:"inline-flex",justifyContent:"center",fontSize:ul(.8),height:24,minWidth:24,width:24},disabled:{opacity:.5}}),fr={root:{fontSize:24}},dc=({model:e})=>{const a=e.items,n=l=>l>0&&!a[l-1].done?pr.disabled:"",r=(l,i)=>t.createElement(t.Fragment,{key:i},t.createElement(Re,{horizontal:!0,horizontalAlign:"space-between",verticalAlign:"center",grow:1},t.createElement(Re,{className:l.done?"":n(i),horizontalAlign:"center",styles:{root:{paddingRight:10,paddingLeft:10}}},l.done?t.createElement($e,{styles:fr,iconName:"CompletedSolid"}):l.icon?t.createElement($e,{styles:fr,iconName:l.icon}):t.createElement("span",{className:pr.stepNumber},i+1),t.createElement(pe,{block:!0,nowrap:!0,styles:{root:{padding:10}}},l.label))),a.length-1!==i&&t.createElement(Aa,{styles:{root:{width:"100%"}}}));return t.createElement(Re,{"data-test":e.name,horizontal:!0,horizontalAlign:"space-between",verticalAlign:"center"},a.map(r))},mc=F({card:{display:"flex",flexDirection:"column",justifyContent:"center"}}),uc=({name:e,label:a,caption:n,icon:r,items:l,value:i})=>{x.args[e]=!1;const o=()=>{if(e.startsWith("#")){window.location.hash=e.substring(1);return}x.args[e]=i===void 0||i,x.push()};return{key:e,text:a,ariaLabel:n||a,title:n,iconOnly:!a,iconProps:r?{iconName:r}:void 0,subMenuProps:l?{items:$t(l),styles:ea}:void 0,onClick:o}},$t=e=>e.map(uc),gc=V(({name:e,state:a,changed:n})=>({render:()=>{const{items:l,overflow_items:i,secondary_items:o}=a,s=$t(l),c=i?$t(i):void 0,d=o?$t(o):void 0;return t.createElement("div",{className:mc.card},t.createElement(Zt,{"data-test":e,items:s,overflowItems:c,overflowButtonProps:{ariaLabel:"More"},farItems:d,ariaLabel:"Use left and right arrow keys to navigate between commands."}))},changed:n}));Q.register("toolbar",gc,{effect:et.Transparent});const hr=F({container:{display:"inline",cursor:"pointer"},icon:{fontSize:18}}),pc=({model:e})=>{const a=t.useRef(null),[n,r]=t.useState(!0),l=()=>r(!1),i=()=>r(!0);return t.createElement("div",{"data-test":e.name,className:hr.container,ref:a,onClick:l},t.createElement(it,{className:hr.icon,iconName:"MoreVertical"}),t.createElement(Pa,{items:$t(e.commands.map(o=>Z(L({},o),{value:e.rowId}))),target:a,hidden:n,onDismiss:i,isBeakVisible:!0,directionalHint:Da.bottomCenter,calloutProps:{styles:{beak:{border:xe(1,f("$neutralQuaternaryAlt"))}}},styles:ea}))},fc=({model:e,icon:a})=>t.createElement($e,{"data-test":e.name,iconName:a,styles:{root:{fontSize:"1.2rem",color:e.color||"inherit"}}}),hc=({model:e})=>{const a=t.useRef(null);return t.useEffect(()=>{var n;(n=a.current.querySelectorAll("a"))==null||n.forEach(r=>{e.target&&(r.target=e.target)})},[e.target]),t.createElement("div",{"data-test":e.name,ref:a},t.createElement(Pe,{source:e.content}))},yc=F({container:{position:"absolute",top:0,left:0,right:0,bottom:0}}),Fn=({thickness:e,color:a,value:n})=>{const r=t.useRef(null),[l,i]=t.useState(null),o=t.useCallback(()=>{if(!r.current)return;const{width:c,height:d}=r.current.getBoundingClientRect();if(!d){setTimeout(o,300);return}const m=Math.min(c,d),u=m/2,g=m/2-e,h=Ea()({outerRadius:u,innerRadius:g,startAngle:0,endAngle:2*Math.PI}),y=Ea()({outerRadius:u,innerRadius:g,startAngle:0,endAngle:2*Math.PI*n});i(t.createElement("svg",{viewBox:`0 0 ${c} ${d}`,style:{position:"absolute",top:0,left:0,right:0,bottom:0}},t.createElement("g",{transform:m===d?`translate(${(c-2*u)/2}, 0)`:`translate(0, ${(d-2*u)/2})`},t.createElement("path",{d:h,fill:a,fillOpacity:.15,transform:`translate(${u},${u})`}),t.createElement("path",{d:y,fill:a,transform:`translate(${u},${u})`}))))},[a,e,n]),s=St(1e3,o);return t.useEffect(()=>(window.addEventListener("resize",s),()=>window.removeEventListener("resize",s)),[]),t.useLayoutEffect(o,[n,a,e,o]),t.createElement("div",{ref:r,className:yc.container},l)},Ga=F({container:{position:"relative",width:50,height:50},percentContainer:{position:"absolute",top:0,left:0,bottom:0,right:0},percent:{color:f("$text6")}}),vc=({model:e,progress:a})=>t.createElement("div",{"data-test":e.name,className:Ga.container},t.createElement(Fn,{thickness:2,color:f(e.color||"$red"),value:a}),t.createElement(Re,{horizontalAlign:"center",verticalAlign:"center",className:M(Ga.percentContainer,"wave-s12")},t.createElement("div",{className:Ga.percent},`${Math.round(a*100)}%`))),xc=F({tag:{borderRadius:4,padding:be(4,16),"&:not(:first-child)":{marginLeft:8}}}),bc=({model:e,serializedTags:a})=>{const n=(r,l)=>{var d;const i=(d=e.tags)==null?void 0:d.find(({label:m})=>m===r),o=(i==null?void 0:i.color)||"$text",s=f(o),c=f((i==null?void 0:i.label_color)||Gt(o));return t.createElement("span",{key:l,style:{background:s,color:c},className:M(xc.tag,"wave-s12 wave-w6")},r)};return t.createElement("div",{"data-test":e.name},a.split(",").map(n))},yr=F({sortableHeader:{$nest:{".ms-DetailsHeader-cellName":{position:"relative",paddingRight:15}}},sortingIcon:{marginLeft:10,fontSize:ul(1.1),position:"absolute",top:-2,right:-5}}),Ec={contentWrapper:{borderTop:"none",".ms-List-page:first-child .ms-List-cell:first-child > .ms-DetailsRow":{borderTop:xe(2,"transparent")}}},wc={always:Ma.always,"on-hover":Ma.onHover,hidden:Ma.hidden},kc=function(e,a){return e.reduce((n,r)=>((n[r[a]]=n[r[a]]||[]).push(r),n),{})},vr=(e,a)=>(n,r)=>{let l=n[e.key],i=r[e.key];switch(e.dataType){case"number":return l=+l,i=+i,a?l-i:i-l;case"time":l=Date.parse(l),i=Date.parse(i);break;default:l=l.toLowerCase(),i=i.toLowerCase();break}return a?i>l?-1:1:i>l?1:-1},xr=e=>e.toString().replace(/\B(?=(\d{3})+(?!\d))/g,","),Cc=e=>e.map(a=>{const n=JSON.stringify(a);return n.substr(1,n.length-2)}).join(`
`),$c=({onFilterChange:e,col:a,listProps:n,selectedFiltersRef:r,setFiltersInBulk:l})=>{var u;const i=(g,h)=>{var y;return!!r.current&&((y=r.current[g])==null?void 0:y.includes(h))},[o,s]=t.useState(((u=a.cellType)==null?void 0:u.tag)?Array.from(n.items.reduce((g,{key:h,text:y,data:k})=>(h.split(",").forEach(_=>g.set(_,{key:_,text:y,data:k,checked:i(k,_)})),g),new Map).values()):n.items.map(g=>Z(L({},g),{checked:i(g.data,g.key)}))),c=()=>{s(o.map(g=>Z(L({},g),{checked:!0}))),l(a.key,o.map(g=>g.key))},d=()=>{s(o.map(g=>Z(L({},g),{checked:!1}))),l(a.key,[])},m=(g,h)=>(y,k)=>{s(_=>_.map(b=>b.key===h?Z(L({},b),{checked:k}):b)),e(g,h,k)};return t.createElement("div",{style:{padding:10}},t.createElement(pe,{variant:"mediumPlus",styles:{root:{paddingTop:10,paddingBottom:10,fontWeight:"bold"}},block:!0},"Show only"),t.createElement(pe,{variant:"small"},t.createElement(ze,{onClick:c},"Select All")," | ",t.createElement(ze,{onClick:d},"Deselect All")),o.map(({key:g,data:h,checked:y})=>t.createElement(Yt,{key:g,label:g,checked:y,onChange:m(h,g),styles:{root:{marginBottom:5},checkmark:{display:"flex"}}})))},br=t.forwardRef(({model:e,onFilterChange:a,items:n,filteredItems:r,selection:l,selectedFilters:i,isMultiple:o,groups:s,expandedRefs:c,sort:d,setFiltersInBulk:m},u)=>{var j,P;const[g,h]=t.useState(null),y=t.useRef(i),k=(p,w)=>{if(p.target.closest('[data-icon-name="ChevronDown"]'))C(w,p);else if(w.isSortable){const A=w.iconName==="SortDown"||!w.iconName;d(w,A),b(_.map(X=>(w.key===X.key?X.iconName=A?"SortUp":"SortDown":X.iconName=void 0,X)))}},[_,b]=t.useState(e.columns.map(p=>{var A;const w=p.min_width?p.min_width.endsWith("px")?+p.min_width.substring(0,p.min_width.length-2):+p.min_width:150,$=p.max_width?p.max_width.endsWith("px")?+p.max_width.substring(0,p.max_width.length-2):+p.max_width:void 0;return{key:p.name,name:p.label,fieldName:p.name,minWidth:w,maxWidth:$,headerClassName:p.sortable?yr.sortableHeader:void 0,iconClassName:p.sortable?yr.sortingIcon:void 0,onColumnClick:k,columnActionsMode:p.filterable?qn.hasDropdown:qn.clickable,cellType:p.cell_type,dataType:p.data_type,align:p.align,isSortable:p.sortable,cellOverflow:p.cell_overflow,styles:{root:{height:48},cellName:{color:f("$neutralPrimary")}},isResizable:!0,isMultiline:!!((A=p.cell_type)==null?void 0:A.markdown)||p.cell_overflow==="wrap",filters:p.filterable&&e.pagination?p.filters:void 0}})),v=((j=e.columns.find(p=>p.link))==null?void 0:j.name)||(e.columns[0].link===!1?void 0:e.columns[0].name),E=t.useCallback(p=>w=>w?t.createElement($c,{onFilterChange:a,col:p,listProps:w,selectedFiltersRef:y,setFiltersInBulk:m}):null,[a,m]),C=t.useCallback((p,w)=>{const $=p.filters||n.map(A=>A[p.fieldName||p.key]);h({items:Array.from(new Set($)).map(A=>({key:A,text:A,data:p.fieldName||p.key})),target:w.target,directionalHint:Da.bottomLeftEdge,gapSpace:10,isBeakVisible:!0,onRenderMenuList:E(p),onDismiss:()=>h(null)})},[n,E]),R=t.useCallback(p=>p?t.createElement(Bi,{stickyPosition:Mi.Header,isScrollSynced:!0},t.createElement(Fi,Z(L({},p),{isAllCollapsed:s==null?void 0:s.every(w=>w.isCollapsed),styles:Z(L({},p.styles),{root:{padding:0,height:48,lineHeight:"48px",background:f("$neutralLight"),borderBottom:"none"},cellSizerEnd:{marginLeft:-8},cellIsGroupExpander:{height:48}})}))):t.createElement("span",null),[s]),S=t.useCallback(p=>p?t.createElement(Wi,Z(L({},p),{styles:{root:{position:"sticky",top:48,backgroundColor:f("$card"),zIndex:1}}})):t.createElement("span",null),[]),W=p=>c.current=p?{}:null,T=({key:p,isCollapsed:w})=>{c.current?w?c.current[p]=!1:delete c.current[p]:c.current={[p]:!1}},G=p=>p?t.createElement(ji,Z(L({},p),{styles:{cell:{alignSelf:"center",fontSize:14,lineHeight:20,color:f("$text9")},checkCell:{display:"flex",alignItems:"center"},root:{width:"100%",border:xe(2,"transparent"),borderTop:xe(2,f("$neutralLight")),background:f("$card"),minHeight:48,"&:hover":{background:f("$neutralLight"),border:`${xe(2,f("$themePrimary"))} !important`}}}})):null,te=p=>{x.args[e.name]=[p.key],x.push()},ce=(p,w,$)=>{var le,me,Y,U,K;if(!p||!$)return t.createElement("span",null);const A=({children:ee})=>$.cellOverflow==="tooltip"?t.createElement(cn,{id:p.key,styles:{root:{"::after":{content:"",display:"block"}}},content:ee,overflowMode:Xi.Parent},ee):t.createElement(t.Fragment,null,ee);let X=p[$.fieldName];if((le=$.cellType)==null?void 0:le.progress)return t.createElement(vc,{model:$.cellType.progress,progress:p[$.key]});if((me=$.cellType)==null?void 0:me.icon)return t.createElement(fc,{model:$.cellType.icon,icon:p[$.key]});if((Y=$.cellType)==null?void 0:Y.tag)return t.createElement(bc,{model:$.cellType.tag,serializedTags:p[$.key]});if((U=$.cellType)==null?void 0:U.menu)return t.createElement(pc,{model:Z(L({},$.cellType.menu),{rowId:String(p.key)})});if((K=$.cellType)==null?void 0:K.markdown)return t.createElement(hc,{model:Z(L({},$.cellType.markdown),{content:p[$.key]})});if($.dataType==="time"){const ee=Number(X);X=new Date(isNaN(ee)?X:ee).toLocaleString()}if($.key===v){const ee=()=>{x.args[e.name]=[p.key],x.push()};return t.createElement(A,null,t.createElement(ze,{onClick:ee,styles:{root:{textAlign:($==null?void 0:$.align)||"left"}}},X))}return t.createElement(A,null,X)},re=(p,w,$)=>{const A=($==null?void 0:$.align)||"left";return t.createElement("div",{style:{display:"flex",justifyContent:A,textAlign:A}},ce(p,w,$))},I=p=>{const w=e.columns.some(A=>{var X;return(X=A.cell_type)==null?void 0:X.progress})?76:48;return 48+(p.isCollapsed?0:w*p.count)};return t.useEffect(()=>{y.current=i},[i]),t.useImperativeHandle(u,()=>({resetSortIcons:()=>{b(_.map(p=>(p.iconName&&(p.iconName=void 0),p)))}})),t.createElement(t.Fragment,null,t.createElement(Hi,{styles:Ec,items:r,columns:_,constrainMode:Oi.unconstrained,layoutMode:Vi.fixedColumns,groups:s,groupProps:{onToggleCollapseAll:W,onRenderHeader:S,headerProps:{onToggleCollapse:T},isAllGroupsCollapsed:(P=e.groups)==null?void 0:P.every(({collapsed:p=!0})=>p)},getGroupHeight:I,selection:l,selectionMode:o?Qn.multiple:Qn.none,selectionPreservedOnEmptyClick:!0,onItemInvoked:o?void 0:te,onRenderRow:G,onRenderItemColumn:re,onRenderDetailsHeader:R,checkboxVisibility:wc[e.checkbox_visibility||"on-hover"]}),g&&t.createElement(Pa,L({},g)))}),Nc=({currentPage:e,onPageChange:a,pagination:n})=>{const{total_rows:r,rows_per_page:l}=n,i=Math.ceil(r/l),o={rootDisabled:{background:"transparent"},root:{marginLeft:-8}},s=e===i||i===0;return t.createElement("span",null,t.createElement("span",{style:{marginRight:15}},r?t.createElement(t.Fragment,null,t.createElement("b",null,(e-1)*l+1)," to ",t.createElement("b",null,s?r:e*l)," of ",t.createElement("b",null,r)):t.createElement(t.Fragment,null,t.createElement("b",null,"0")," to ",t.createElement("b",null,"0")," of ",t.createElement("b",null,"0"))),t.createElement(Et,{iconProps:{iconName:"DoubleChevronLeft"},disabled:e===1,onClick:()=>a(1),styles:o,title:"First page"}),t.createElement(Et,{iconProps:{iconName:"ChevronLeft"},disabled:e===1,onClick:()=>a(e-1),styles:o,title:"Previous page"}),t.createElement("span",{style:{margin:ve(0,8)}},"Page ",t.createElement("b",null,e)," of ",t.createElement("b",null,i||1)),t.createElement(Et,{iconProps:{iconName:"ChevronRight"},disabled:s,onClick:()=>a(e+1),styles:o,title:"Next page"}),t.createElement(Et,{iconProps:{iconName:"DoubleChevronRight"},disabled:s,onClick:()=>a(i),styles:o,title:"Last page"}))},Sc=({m:e,isFilterable:a,isSearchable:n,displayedRows:r,reset:l,currentPage:i,onPageChange:o})=>{const s=[],c={root:{background:f("$card")}},d=()=>{var k,_;if(e.pagination&&((k=e.events)==null?void 0:k.includes("download"))){x.emit(e.name,"download",!0);return}const m=((_=e.groups?e.groups.flatMap(({rows:b})=>b):e.rows)==null?void 0:_.map(({cells:b})=>b))||[],u=Cc([e.columns.map(({label:b,name:v})=>b||v),...m]),g=document.createElement("a"),h=new Blob(["\uFEFF",u],{type:"text/csv;charset=utf-8,"}),y=window.URL.createObjectURL(h);g.href=y,g.download="exported_data.csv",g.click(),window.URL.revokeObjectURL(y)};return e.downloadable&&s.push({key:"download",text:"Download data",iconProps:{iconName:"Download"},onClick:d,buttonStyles:c}),e.resettable&&s.push({key:"reset",text:"Reset table",iconProps:{iconName:"Refresh"},onClick:l,buttonStyles:c}),t.createElement(Re,{horizontal:!0,horizontalAlign:"space-between",verticalAlign:"center",className:"wave-s12",styles:{root:{background:f("$neutralLight"),borderRadius:"0 0 4px 4px",paddingLeft:12,height:46,position:"absolute",bottom:0,left:0,right:0}}},!e.pagination&&(a||n)&&t.createElement(pe,{variant:"smallPlus",block:!0,styles:{root:{whiteSpace:"nowrap",color:f("$text")}}},t.createElement("b",{style:{paddingLeft:5}},r)),e.pagination&&t.createElement(Nc,{pagination:e.pagination,currentPage:i,onPageChange:o}),!!s.length&&t.createElement(Kr,{grow:1},t.createElement(Zt,{items:s,styles:{root:{background:f("$neutralLight"),".ms-Button--commandBar":{background:"transparent"}},primarySet:{justifyContent:"flex-end"}}})))},_c=({model:e})=>{var ee;const a=!e.groups&&e.groupable,n=t.useCallback(D=>{const B={key:D.name};for(let H=0,z=D.cells.length;H<z;H++){const q=e.columns[H];B[q.name]=D.cells[H]}return B},[e.columns]),r=t.useMemo(()=>e.groups?e.groups.reduce((D,{rows:B,label:H,collapsed:z=!0})=>(D.push(...B.map(q=>Z(L({},n(q)),{group:H,collapsed:z}))),D),[]):(e.rows||[]).map(n),[e.rows,e.groups,n]),l=Boolean(((ee=e.values)==null?void 0:ee.length)||e.multiple),[i,o]=t.useState(r),[s,c]=t.useState(1),d=t.useMemo(()=>e.columns.filter(({searchable:D})=>D).map(({name:D})=>D),[e.columns]),[m,u]=t.useState(""),[g,h]=t.useState(null),[y,k]=t.useState(),_=t.useRef({}),[b,v]=t.useState("*"),E=t.useRef(null),C=t.useRef(null),R=t.useMemo(()=>a?[{key:"*",text:"(No Grouping)"},...e.columns.map(D=>({key:D.name,text:D.label}))]:[],[e.columns,a]),S=t.useCallback(D=>{o(D?r.filter(B=>Object.keys(D).every(H=>!D[H].length||D[H].some(z=>String(B[H]).includes(z)))):r)},[r]),W=(D,B)=>{if(B===null)return!1;const H=B[D];return H===void 0||H},T=t.useCallback((D,B)=>{var q;let H,z=[];if(e.groups)H=B.reduce((J,{group:ie},ke)=>{const he=J[J.length-1];return(he==null?void 0:he.key)===ie?he.count++:J.push({key:ie,name:ie,startIndex:ke,count:1,isCollapsed:W(ie,_.current)}),J},[]);else{let J=0;z=kc(B,D);const ie=Object.keys(z),ke=(q=e.columns.find(he=>he.name===D))==null?void 0:q.data_type;H=ie.map((he,ot)=>{if(ot!==0){const la=ie[ot-1];J+=z[la].length}const ra=ke==="time"?new Date(he).toLocaleString():he;return{key:he,name:ra,startIndex:J,count:z[he].length,isCollapsed:W(he,_.current)}}).sort(({name:he},{name:ot})=>{const ra=Number(he),la=Number(ot);if(!isNaN(ra)&&!isNaN(la))return ra-la;const Vn=Date.parse(he),jn=Date.parse(ot);return!isNaN(Vn)&&!isNaN(jn)?Vn-jn:ot<he?1:-1})}return{groupedBy:z,groups:H}},[e.columns,e.groups]),G=t.useCallback(()=>{v(D=>(o(B=>{const{groupedBy:H,groups:z}=T(D,B);return k(z),e.groups?B:Object.values(H).flatMap(q=>q)}),D))},[e.groups,T]),te=t.useCallback(()=>{u(D=>{const B=D.toLowerCase();return!B||!d.length||o(H=>H.filter(z=>d.some(q=>z[q].toLowerCase().includes(B)))),D||""})},[d]),ce=D=>{x.emit(e.name,"search",{value:D,cols:d}),c(1)},re=t.useRef(x.debounce(500,ce)),I=t.useCallback((D,B="")=>{var H;if(u(B),e.pagination&&((H=e.events)==null?void 0:H.includes("search"))){re.current(B);return}if(!B&&!g){o(r),k(z=>(z&&G(),z));return}S(g),te(),k(z=>(z&&G(),z))},[e.pagination,e.events,g,S,te,r,G]),j=(D,B)=>{if(!!B){if(e.pagination){x.emit(e.name,"group_by",!0),c(1);return}X(),B.key!=="*"&&(v(B.key),_.current={},G())}},P=t.useCallback(D=>{var B;e.pagination&&((B=e.events)==null?void 0:B.includes("page_change"))&&(c(D),x.emit(e.name,"page_change",{offset:(D-1)*e.pagination.rows_per_page}),(E==null?void 0:E.current)&&(E.current._contentContainer.current.scrollTop=0))},[e.events,e.name,e.pagination]),p=!!d.length,w=e.columns.some(D=>D.filterable),$=e.downloadable||e.resettable||p||w||!!e.pagination,A=t.useCallback((D,B,H)=>{h(z=>{var J;const q=z||{};return H?q[D]?q[D].push(B):q[D]=[B]:q[D]=q[D].filter(ie=>ie!==B),e.pagination&&((J=e.events)==null?void 0:J.includes("filter"))?(x.emit(e.name,"filter",q),c(1)):(S(q),te(),k(ie=>(ie&&G(),ie))),q})},[S,G,e.events,e.name,e.pagination,te]),X=t.useCallback(()=>{var D,B;if(h(null),u(""),k(void 0),e.groups&&G(),_.current={},v("*"),(D=C.current)==null||D.resetSortIcons(),e.pagination&&((B=e.events)==null?void 0:B.includes("reset"))){x.emit(e.name,"reset",!0),c(1);return}S(null),te()},[S,G,e.events,e.groups,e.name,e.pagination,te]),le=t.useMemo(()=>new Ui({onSelectionChanged:()=>{x.args[e.name]=le.getSelection().map(D=>D.key)}}),[e.name]),me=()=>{if(e.height)return e.height;if(r.length>10)return 500;const D=d.length||a?a?74:48:0,B=50,H=e.columns.some(J=>{var ie;return(ie=J.cell_type)==null?void 0:ie.progress})?76:48,z=e.downloadable||e.resettable||d.length||e.columns.some(J=>J.filterable)?46:0,q=2;return D+B+r.length*H+z+q},Y=t.useCallback((D,B)=>{var H;if(e.pagination&&((H=e.events)==null?void 0:H.includes("sort"))){x.emit(e.name,"sort",{[D.fieldName||D.name]:B}),c(1);return}k(z=>(o(z?q=>[...z].sort((J,ie)=>J.startIndex-ie.startIndex).reduce((J,ie)=>[...J,...q.slice(ie.startIndex,J.length+ie.count).sort(vr(D,B))],[])||[]:q=>[...q].sort(vr(D,B))),z))},[e.events,e.name,e.pagination]),U=t.useCallback((D,B)=>{h(H=>{var q;const z=Z(L({},H),{[D]:B});return e.pagination&&((q=e.events)==null?void 0:q.includes("filter"))?(x.emit(e.name,"filter",z),c(1)):(S(z),te(),k(J=>(J&&G(),J))),z})},[e.pagination,e.events,e.name,S,te,G]);t.useEffect(()=>{x.args[e.name]=[],l&&e.values&&(e.values.forEach(D=>le.setKeySelected(D,!0,!1)),x.args[e.name]=e.values)},[]),t.useEffect(()=>o(r),[r]),t.useEffect(()=>{var D;e.groups&&(_.current=(D=e.groups)==null?void 0:D.reduce((B,{label:H,collapsed:z=!0})=>(z||(B[H]=!1),B),{}),G())},[G,e.groups]);const K=t.useMemo(()=>({model:e,onFilterChange:A,items:r,filteredItems:i,selectedFilters:g,groups:y,expandedRefs:_,selection:le,sort:Y,isMultiple:l,setFiltersInBulk:U}),[i,y,_,l,r,e,A,g,le,Y,U]);return t.createElement("div",{"data-test":e.name,style:{position:"relative",height:me()}},t.createElement(Re,{horizontal:!0,horizontalAlign:"space-between",verticalAlign:"end"},a&&!e.pagination&&t.createElement(La,{"data-test":"groupby",label:"Group by",selectedKey:b,onChange:j,options:R,styles:{root:{width:300}}}),!!d.length&&t.createElement($n,{"data-test":"search",placeholder:"Search",onChange:I,value:m,styles:{root:{width:"50%",maxWidth:500}}})),t.createElement(Nn,{componentRef:E,scrollbarVisibility:Gi.auto,styles:{root:{top:a||d.length?a?74:48:0,bottom:$?46:0},stickyAbove:{right:ye("12px"),border:xe(2,"transparent"),zIndex:2},contentContainer:{border:xe(2,f("$neutralLight")),borderRadius:"4px 4px 0 0"}}},l?t.createElement(qi,{selection:le},t.createElement(br,L({ref:C},K))):t.createElement(br,L({ref:C},K))),$&&t.createElement(Sc,{m:e,currentPage:s,onPageChange:P,isSearchable:p,isFilterable:w,displayedRows:`${xr(i.length)} of ${xr(r.length)}`,reset:X}))},Pc=F({pivot:{minHeight:46,overflowX:"auto",overflowY:"hidden"}}),Tc=({model:e})=>{var i;const a=o=>{const s=o==null?void 0:o.props.itemKey;if(!!s){if(l(s),s.startsWith("#")){window.location.hash=s.substring(1);return}e.name?s!==x.args[e.name]&&(x.args[e.name]=s,x.push()):(x.args[s]=!0,x.push())}},n=(i=e.items)==null?void 0:i.map(o=>t.createElement(al,{key:o.name,itemIcon:o.icon,itemKey:o.name,headerText:o.label})),[r,l]=t.useState(e.value);return t.useEffect(()=>l(e.value),[e.value]),t.createElement("div",{className:Pc.pivot},t.createElement(nl,{"data-test":e.name,className:e.link?"w-tabs-link":"w-tabs",selectedKey:r,linkFormat:e.link?"links":"tabs",onLinkClick:a},n))},Dc=({model:e})=>{const a=Ta.compile(e.content||""),n=N.unpack(e.data);return t.createElement("div",{"data-test":e.name},t.createElement(zn,{model:{content:a(n||{})}}))},Lc=V(({name:e,state:a,changed:n})=>{const r=Ta.compile(a.content||"");return{render:()=>{const i=N.unpack(a.data);return t.createElement(Ul,{name:e,title:Ze(a.title,i),content:r(i||{})})},changed:n}});Q.register("template",Lc);const Ac=F({text:{position:"relative",$nest:{p:{margin:ve(0,0,10,0)}}}}),Rc={xl:"xLarge",l:"large",m:"medium",s:"small",xs:"xSmall"},Ic=e=>Rc[e]||"mediumPlus",dt=({content:e,name:a,size:n,commands:r})=>{const l=a&&`${a}-menu`;return t.createElement("div",{className:Ac.text},t.createElement(pe,{"data-test":a,variant:Ic(n||"m"),block:!0,className:"w-text"},t.createElement(Pe,{source:e})),!!(r==null?void 0:r.length)&&t.createElement(An,{name:l,commands:r}))},zc=500,Bc=({model:e})=>{var o;const[a,n]=t.useState((o=e.value)!=null?o:""),r=t.useRef(St(zc,x.push)),l=({target:s},c)=>{c=c||s.value,x.args[e.name]=c!=null?c:e.value||"",e.trigger&&r.current(),n(c),e.value=c},i={"data-test":e.name,label:e.label,value:a,errorMessage:e.error,required:e.required,disabled:e.disabled,readOnly:e.readonly,onChange:l,iconProps:e.icon?{iconName:e.icon}:void 0,placeholder:e.placeholder,prefix:e.prefix,suffix:e.suffix,multiline:e.multiline,spellCheck:e.spellcheck,type:e.password?"password":void 0};return t.useEffect(()=>{var s,c;x.args[e.name]=(s=e.value)!=null?s:"",n((c=e.value)!=null?c:"")},[e.value,e.name]),e.mask?t.createElement(Qi,L({mask:e.mask},i)):t.createElement(Ie,L({styles:e.multiline&&e.height&&!e.height.endsWith("%")?{field:{height:e.height},fieldGroup:{minHeight:e.height}}:void 0},i))},Le=F({title:{color:f("$neutralPrimary"),marginBottom:8},tags:{display:"flex",flexWrap:"wrap",marginTop:1},tag:{cursor:"pointer",padding:be(4,16),textAlign:"center",borderRadius:4},tagWrapper:{marginRight:4,marginBottom:4,border:xe(2,f("$card")),padding:1},mark:{position:"relative",padding:be(2,0)},firstMark:{paddingLeft:4,borderTopLeftRadius:4,borderBottomLeftRadius:4},lastMark:{paddingRight:4,borderTopRightRadius:4,borderBottomRightRadius:4},content:{margin:ve(12,0),paddingTop:2,lineHeight:"26px"},removeIcon:{cursor:"pointer",position:"absolute",left:-8,top:-7,transform:"rotate(45deg)",fontSize:16,fontWeight:100,lineHeight:"initial",color:f("$neutralPrimary"),zIndex:1},iconUnderlay:{width:10,height:10,position:"absolute",left:-5,top:-3,background:f("$card")},readonly:{pointerEvents:"none"},checkbox:{$nest:{"&:hover":{backgroundColor:f("$neutralLighter"),color:f("$neutralDark")}}}}),Er=(e,a,n)=>{let r=e+1,l=e-1;for(;r<=a.length-1&&!isNaN(+a[r].text);)a[r].tag=n,r++;for(;l>=0&&!isNaN(+a[l].text);)a[l].tag=n,l--},ni=({tags:e,activateTag:a,activeTag:n})=>t.createElement("div",{className:Le.tags},e.map(({name:r,color:l,label:i})=>{const o=F({tag:{background:f(l),color:Gt(l)},activeTag:{border:xe(2,f("$themePrimary")),borderRadius:6}});return t.createElement("div",{key:r,"data-test":r,className:M(Le.tagWrapper,n===r?o.activeTag:"")},t.createElement("div",{className:M(Le.tag,o.tag,"wave-s12"),onClick:a(r)},i))})),Mc=({model:{name:e,title:a,tags:n,items:r,trigger:l,readonly:i}})=>{var re;const[o,s]=t.useState(i||(re=n[0])==null?void 0:re.name),[c,d]=t.useState(),[m,u]=t.useState(!0),g=t.useRef(),h=new Map(n.map(I=>[I.name,I.color])),[y,k]=t.useState(r.reduce((I,{text:j,tag:P})=>(j.split(/([^a-z])/ig).filter(p=>p!=="").forEach(p=>{const w=I.length===0?0:I[I.length-1].end+1,$=I.length===0?p.length-1:I[I.length-1].end+p.length;I.push(...p.split("").map(A=>({text:A,tag:P,start:w,end:$})))}),I),[])),_=()=>{let I="",j;x.args[e]=y.reduce((P,{text:p,tag:w},$,A)=>($===A.length-1?w!==j?(P.push({text:I,tag:j}),P.push({text:p,tag:w})):P.push({text:I+p,tag:w}):$!==0&&w!==j?(P.push({text:I,tag:j}),I=p):I+=p,j=w,P),[]),l&&x.push()},b=I=>()=>s(I),v=I=>j=>{var p;j.stopPropagation();const P=y[I].tag;for(let w=I;((p=y[w])==null?void 0:p.tag)===P;w++)y[w].tag=void 0;g.current=void 0,k([...y]),_()},E=()=>{y.forEach(I=>I.tag=void 0),k([...y]),_()},C=I=>{var $,A;if(!g.current)return;const j=g.current,P=m?Math.max(j.end,I.end):Math.max(j.key,I.key),p=m?Math.min(j.start,I.start):Math.min(j.key,I.key),w=($=window.getSelection())==null?void 0:$.toString().replace(/\r?\n|\r/g,"");for(let X=p;X<=P;X++)!m&&w&&P-p+1!==w.length&&(X===p&&w.charAt(0)!==y[X].text||X===P&&w.charAt(w.length-1)!==y[X].text)||(y[X].tag=o);m&&(isNaN(+y[j.key].text)||Er(j.key,y,o),j.key!==I.key&&!isNaN(+y[I.key].text)&&Er(I.key,y,o)),k([...y]),_(),(A=window.getSelection())==null||A.removeAllRanges(),g.current=void 0},R=I=>()=>d(I),S=()=>d(null),W=(I,j)=>{var P,p,w;if(c===null||((P=y[c])==null?void 0:P.tag)!==j||((p=y[I-1])==null?void 0:p.tag)===j)return!1;if(I===c)return!0;for(let $=I;((w=y[$])==null?void 0:w.tag)===j;$++)if($===c)return!0;return!1},T=(I,j,P)=>{var X,le;const p=h.get(P);if(!p)return I;const w={visibility:W(j,P)?"visible":"hidden"},$=((X=y[j-1])==null?void 0:X.tag)!==P,A=((le=y[j+1])==null?void 0:le.tag)!==P;return t.createElement("mark",{onMouseOver:R(j),onMouseOut:S,className:M(Le.mark,$?Le.firstMark:"",A?Le.lastMark:""),style:{backgroundColor:f(p),color:Gt(p)}},I,t.createElement($e,{iconName:"CircleAdditionSolid","data-test":"remove-icon",styles:{root:w},className:M(Le.removeIcon,"wave-w6"),onMouseUp:v(j)}),t.createElement("span",{style:w,className:Le.iconUnderlay}))},G=I=>()=>g.current=I,te=I=>()=>C(I),ce=I=>{var P,p,w,$,A;const j=(P=I.relatedTarget)==null?void 0:P.nodeName;if(g.current!==void 0&&j!=="P"&&j!=="MARK"){const X=(A=($=(w=(p=window.getSelection())==null?void 0:p.focusNode)==null?void 0:w.parentElement)==null?void 0:$.dataset)==null?void 0:A.keys;X&&C(JSON.parse(X))}};return t.useEffect(()=>{x.args[e]=r},[]),t.createElement("div",{"data-test":e,className:i?Le.readonly:""},t.createElement("div",{className:M("wave-s16 wave-w6",Le.title)},a),t.createElement(ni,{tags:n,activateTag:b,activeTag:o}),t.createElement("div",{style:{display:"flex"}},t.createElement(Yt,{label:"Smart selection",checked:m,onChange:()=>u(I=>!I),className:Le.checkbox,styles:{root:{alignItems:"center",paddingLeft:8,paddingRight:8}}}),t.createElement(Zt,{styles:{root:{padding:0}},items:[{key:"remove-all",text:"Remove all selections",onClick:E,disabled:!y.find(I=>I.tag),iconProps:{iconName:"DependencyRemove",styles:{root:{fontSize:20}}}}]})),t.createElement("div",{className:M(Le.content,"wave-s16 wave-t7 wave-w3"),onMouseUp:ce},y.map(({start:I,end:j,text:P,tag:p},w)=>{const $=o?h.get(o):void 0;return P===`
`||P==="\r"?t.createElement("br",{key:w}):t.createElement("p",{key:w,"data-keys":`{ "key": ${w}, "start": ${I}, "end": ${j} }`,onMouseDown:G({key:w,start:I,end:j}),onMouseUp:te({key:w,start:I,end:j}),style:{display:"inline",padding:"4px 0px"},className:$?Yr({$nest:{"&::selection":{background:$,color:Gt($)}}}):void 0},p?T(P,w,p):P)})))},Fc=5,Wc=5,ue=4;class Hc{constructor(a){this.canvas=a,this.drawCircle=(n,r)=>{if(!this.ctx)return;const l=new Path2D;l.arc(n,r,ue,0,2*Math.PI),this.ctx.strokeStyle="#000",this.ctx.fillStyle="#FFF",this.ctx.fill(l),this.ctx.stroke(l)},this.drawRect=({x1:n,x2:r,y1:l,y2:i},o,s=!1)=>{!this.ctx||(this.ctx.strokeStyle=o,this.ctx.strokeRect(n,l,r-n,i-l),s&&(this.ctx.fillStyle=o.substring(0,o.length-2)+"0.2)",this.ctx.fillRect(n,l,r-n,i-l),this.drawCircle(n,l),this.drawCircle(r,l),this.drawCircle(r,i),this.drawCircle(n,i)))},this.createRect=(n,r,l,i)=>{const{width:o,height:s}=this.canvas;return Math.abs(r-n)<=Fc||Math.abs(i-l)<=Wc?void 0:{x1:n>o?o:n<0?0:n,x2:r>o?o:r<0?0:r,y1:l>s?s:l<0?0:l,y2:i>s?s:i<0?0:i}},this.resetDragging=()=>{this.resizedCorner=void 0,this.movedRect=void 0},this.onClick=(n,r,l,i)=>{let o;return!this.resizedCorner&&(i==null?void 0:i.dragging)&&(o={shape:{rect:this.createRect(i.x,n,i.y,r)},tag:l}),this.resetDragging(),o},this.ctx=a.getContext("2d"),this.ctx&&(this.ctx.lineWidth=2)}onMouseDown(a,n,r){this.resizedCorner=Wn(a,n,r,!0)}onMouseMove(a,n,r,l,i){var c;if(!i)return;const o=i.x,s=i.y;if((r==null?void 0:r.shape.rect)&&this.resizedCorner)this.resizedCorner==="topLeft"?(r.shape.rect.x1+=a-o,r.shape.rect.y1+=n-s):this.resizedCorner==="topRight"?(r.shape.rect.x1+=a-o,r.shape.rect.y2+=n-s):this.resizedCorner==="bottomLeft"?(r.shape.rect.x2+=a-o,r.shape.rect.y1+=n-s):this.resizedCorner==="bottomRight"&&(r.shape.rect.x2+=a-o,r.shape.rect.y2+=n-s),i.x=a,i.y=n;else if(this.movedRect||(l==null?void 0:l.isFocused)){if(this.movedRect=this.movedRect||l,!((c=this.movedRect)==null?void 0:c.shape.rect))return;const d=this.movedRect.shape.rect,m=a-o,u=n-s,g=d.x1+m,h=d.x2+m,y=d.y1+u,k=d.y2+u,{width:_,height:b}=this.canvas;g<d.x1&&g<0?d.x1=Math.max(0,g):h<d.x2&&h<0?d.x2=Math.max(0,h):y<d.y1&&y<0?d.y1=Math.max(0,y):k<d.y2&&k<0?d.y2=Math.max(0,k):g>d.x1&&g>_?d.x1=Math.min(g,_):h>d.x2&&h>_?d.x2=Math.min(h,_):y>d.y1&&y>b?d.y1=Math.min(y,b):k>d.y2&&k>b?d.y2=Math.min(k,b):(d.x1=g,d.x2=h,d.y1=y,d.y2=k),i.x=a,i.y=n}else return{rect:this.createRect(o,a,s,n)}}}const Oc=(e,a,n,r=!1)=>{if(!n)return!1;if(r&&Wn(e,a,n))return!0;const{x2:l,x1:i,y2:o,y1:s}=n,c=Math.min(i,l),d=Math.max(i,l),m=Math.min(s,o),u=Math.max(s,o);return e>c&&e<d&&a>m&&a<u},Wn=(e,a,{x1:n,y1:r,x2:l,y2:i},o=!1)=>{const s=o?n:Math.min(n,l),c=o?l:Math.max(n,l),d=o?r:Math.min(r,i),m=o?i:Math.max(r,i);if(e>s-ue&&e<s+ue&&a>d-ue&&a<d+ue)return"topLeft";if(e>s-ue&&e<s+ue&&a>m-ue&&a<m+ue)return"topRight";if(e>c-ue&&e<c+ue&&a>d-ue&&a<d+ue)return"bottomLeft";if(e>c-ue&&e<c+ue&&a>m-ue&&a<m+ue)return"bottomRight"},wr=(e,a,n)=>{const r=Wn(a,n,e);if(r==="topLeft"||r==="bottomRight")return"nwse-resize";if(r==="bottomLeft"||r==="topRight")return"nesw-resize"};class Vc{constructor(a){this.ctx=a,this.currPolygonPoints=[],this.draggedPoint=null,this.draggedShape=null,this.tryToAddAuxPoint=(n,r,l)=>{const i=l.find(o=>wt(o,n,r));if(i==null?void 0:i.isAux)return i.isAux=!1,!0},this.tryToRemovePoint=(n,r,l)=>l.filter(i=>!wt(i,n,r)),this.getPolygonPointsWithAux=n=>{var o;const r=n.filter(s=>!s.isAux).reduce((s,c,d,m)=>(s.push(c),d!==m.length-1&&s.push({x:(c.x+m[d+1].x)/2,y:(c.y+m[d+1].y)/2,isAux:!0}),s),[]),l=n.length,i=((o=n[l-1])==null?void 0:o.isAux)?n[l-2]:n[l-1];return i&&r.push({x:(n[0].x+i.x)/2,y:(n[0].y+i.y)/2,isAux:!0}),r},this.drawLine=(n,r)=>{!this.ctx||(this.ctx.lineTo(n,r),this.ctx.stroke())},this.drawPolygon=(n,r,l=!0,i=!1)=>{if(!n.length||!this.ctx)return;this.ctx.fillStyle=r,this.ctx.strokeStyle=r,this.ctx.beginPath(),this.ctx.moveTo(n[0].x,n[0].y);const o=this.draggedPoint?n.filter(s=>!s.isAux):n;o.forEach(({x:s,y:c})=>this.drawLine(s,c)),l&&this.drawLine(n[0].x,n[0].y),i&&(this.ctx.fillStyle=r.substring(0,r.length-2)+"0.2)",this.ctx.fill(),o.forEach(({x:s,y:c,isAux:d})=>this.drawPoint(s,c,d)))},this.drawPreviewLine=(n,r,l)=>{if(!this.ctx||!this.currPolygonPoints.length)return;this.drawPolygon(this.currPolygonPoints,l,!1);const{x:i,y:o}=this.currPolygonPoints[this.currPolygonPoints.length-1];this.ctx.beginPath(),this.ctx.fillStyle=l,this.ctx.moveTo(i,o),this.ctx.lineTo(n,r),this.ctx.stroke()},this.drawPoint=(n,r,l=!1)=>{if(!this.ctx)return;const i=new Path2D;i.arc(n,r,ue,0,2*Math.PI),this.ctx.strokeStyle=l?"#5e5c5c":"#000",this.ctx.fillStyle=l?"#b8b8b8":"#FFF",this.ctx.fill(i),this.ctx.stroke(i)},this.isIntersectingFirstPoint=(n,r)=>this.currPolygonPoints.length?wt(this.currPolygonPoints[0],n,r):!1,this.ctx.lineWidth=2}resetDragging(){this.draggedPoint=null,this.draggedShape=null}cancelAnnotating(){this.currPolygonPoints=[]}onClick(a,n,r,l){if(!!this.ctx){if(this.ctx.beginPath(),this.ctx.fillStyle=r,this.isIntersectingFirstPoint(a,n)){const{x:i,y:o}=this.currPolygonPoints[0];this.drawLine(i,o);const s={shape:{polygon:{vertices:[...this.currPolygonPoints]}},tag:l};return this.currPolygonPoints=[],s}this.currPolygonPoints.length&&this.drawLine(a,n),this.currPolygonPoints.push({x:a,y:n})}}onMouseMove(a,n,r,l,i){var s,c;if(!(i==null?void 0:i.dragging)||!(r==null?void 0:r.shape.polygon)){this.draggedPoint=null,this.draggedShape=null;return}const o=r.shape.polygon.vertices.find(d=>wt(d,a,n));this.draggedPoint=this.draggedPoint||o||null,this.draggedPoint?(this.draggedPoint.x+=a-this.draggedPoint.x,this.draggedPoint.y+=n-this.draggedPoint.y):(l==r||this.draggedShape)&&(this.draggedShape=(l==null?void 0:l.shape.polygon)&&l.isFocused?l:this.draggedShape,(c=(s=this.draggedShape)==null?void 0:s.shape.polygon)==null||c.vertices.forEach(d=>{d.x+=a-i.x,d.y+=n-i.y}),i.x=a,i.y=n)}}const kr=(e,a,n)=>(a.x-e.x)*(n.y-e.y)-(n.x-e.x)*(a.y-e.y),jc=(e,a,n=!1)=>{if(n&&a.some(l=>wt(l,e.x,e.y)))return!0;let r=0;return a.forEach((l,i)=>{const o=a[(i+1)%a.length];l.y<=e.y?o.y>e.y&&kr(l,o,e)>0&&(r+=1):o.y<=e.y&&kr(l,o,e)<0&&(r-=1)}),r!==0},wt=({x:e,y:a},n,r)=>{const l=2*ue;return n>=e-l&&n<=e+l&&r>=a-l&&r<a+l},Cr=(e,a,n)=>{const r=e.find(l=>wt(l,a,n));return(r==null?void 0:r.isAux)?"pointer":r?"move":""},ma=F({title:{color:f("$primary"),marginBottom:8},canvas:{display:"block",margin:"0 auto",cursor:"crosshair",position:"absolute",top:0,left:0,right:0,bottom:0},canvasContainer:{position:"relative",margin:8}}),qa=(e,a)=>({cursor_x:e.clientX-a.left,cursor_y:e.clientY-a.top}),Qa=(e,a,n)=>e.find(({shape:r,isFocused:l})=>{if(r.rect)return Oc(a,n,r.rect,l);if(r.polygon)return jc({x:a,y:n},r.polygon.vertices,l)}),$r=(e,a,n,r,l=!1)=>{let i=r?"pointer":l?"auto":"crosshair";return(r==null?void 0:r.isFocused)&&r.shape.rect?i=wr(r.shape.rect,e,a)||"move":(n==null?void 0:n.shape.rect)?i=wr(n.shape.rect,e,a)||i:(r==null?void 0:r.isFocused)&&r.shape.polygon?i=Cr(r.shape.polygon.vertices,e,a)||"move":(n==null?void 0:n.shape.polygon)&&(i=Cr(n.shape.polygon.vertices,e,a)||i),i},Xc=(e,a)=>e.map(({shape:n,tag:r})=>n.rect?{tag:r,shape:{rect:{x1:n.rect.x1*a,x2:n.rect.x2*a,y1:n.rect.y1*a,y2:n.rect.y2*a}}}:n.polygon?{tag:r,shape:{polygon:{vertices:n.polygon.vertices.map(l=>({x:l.x*a,y:l.y*a}))}}}:{tag:r,shape:n}),Ka=(e,a,n,r,l)=>({key:e,text:a,onClick:n,canCheck:!0,checked:r===e,iconProps:{iconName:l,styles:{root:{fontSize:20}}}}),Uc=({model:e})=>{var j;const{allowed_shapes:a=["rect","polygon"]}=e,n=rl(),r=t.useMemo(()=>new Map(e.tags.map(P=>{const p=_e(ae(P.color));return[P.name,`rgba(${(p==null?void 0:p.r)||0}, ${(p==null?void 0:p.g)||0}, ${(p==null?void 0:p.b)||0}, 1)`]})),[e.tags,n]),l=t.useMemo(()=>a.reduce((P,p)=>P.add(p),new Set),[a]),[i,o]=t.useState(((j=e.tags[0])==null?void 0:j.name)||""),[s,c]=t.useState("select"),[d,m]=t.useState([]),u=t.useRef(null),g=t.useRef(null),h=t.useRef(null),y=t.useRef(null),[k,_]=t.useState(1),b=t.useRef(void 0),v=t.useRef(void 0),E=t.useCallback(P=>r.get(P)||ae("$red"),[r]),C=t.useCallback(()=>{const P=g.current,p=v.current;!p||!P||(p.clearRect(0,0,P.width,P.height),m(w=>(w.forEach(({shape:$,isFocused:A,tag:X})=>{var le,me;$.rect?(le=h.current)==null||le.drawRect($.rect,E(X),A):$.polygon&&((me=y.current)==null||me.drawPolygon($.polygon.vertices,E(X),!0,A))}),w)))},[E]),R=t.useCallback(P=>()=>{o(P),m(p=>{const w=p.map($=>($.isFocused&&($.tag=P),$));return re(w),w}),C()},[C]),S=P=>{var X;const p=g.current;if(!p)return;const{cursor_x:w,cursor_y:$}=qa(P,p.getBoundingClientRect()),A=Qa(d,w,$);if(!(P.buttons!==1&&!(A==null?void 0:A.shape.polygon))){if((A==null?void 0:A.isFocused)&&(A==null?void 0:A.shape.rect)&&((X=h.current)==null||X.onMouseDown(w,$,A.shape.rect)),(A==null?void 0:A.shape.polygon)&&y.current){const le=A.shape.polygon.vertices,me=y.current.tryToAddAuxPoint(w,$,le);y.current.resetDragging(),P.buttons===2&&(A.shape.polygon.vertices=y.current.tryToRemovePoint(w,$,le)),m(Y=>{const U=Y.map(K=>(K===A&&K.shape.polygon&&y.current&&(K.shape.polygon.vertices=y.current.getPolygonPointsWithAux(K.shape.polygon.vertices)),K));return(P.buttons===2||me)&&re(U),U}),C()}b.current={x:w,y:$,dragging:!0}}},W=P=>{var me,Y,U,K,ee,D;const p=g.current;if(!p)return;const{cursor_x:w,cursor_y:$}=qa(P,p.getBoundingClientRect()),A=d.find(({isFocused:B})=>B),X=b.current,le=Qa(d,w,$);switch(p.style.cursor=$r(w,$,A,le,s==="select"),s){case"rect":{const B=(me=h.current)==null?void 0:me.onMouseMove(w,$,A,le,X);B&&m(H=>H.map(z=>Z(L({},z),{isFocused:!1}))),C(),(B==null?void 0:B.rect)&&((Y=h.current)==null||Y.drawRect(B.rect,E(i)));break}case"polygon":{C(),(U=y.current)==null||U.drawPreviewLine(w,$,E(i)),((K=y.current)==null?void 0:K.isIntersectingFirstPoint(w,$))&&(p.style.cursor="pointer");break}case"select":{if(P.buttons!==1)break;(A==null?void 0:A.shape.rect)?((ee=h.current)==null||ee.onMouseMove(w,$,A,le,X),C()):(A==null?void 0:A.shape.polygon)&&((D=y.current)==null||D.onMouseMove(w,$,A,le,X),C());break}}},T=P=>{var Y,U,K,ee;const p=g.current;if(!p)return;const w=b.current,$=p.getBoundingClientRect(),{cursor_x:A,cursor_y:X}=qa(P,$),le=Qa(d,A,X);switch(s){case"rect":{const D=(Y=h.current)==null?void 0:Y.onClick(A,X,i,w);D&&m(B=>{const H=[D,...B];return re(H),H}),C();break}case"polygon":{const D=(U=y.current)==null?void 0:U.onClick(A,X,E(i),i);D&&m(B=>{const H=[D,...B];return re(H),H});break}case"select":{le&&o(le.tag),m(D=>{const B=D.map(H=>(H.isFocused=H===le,H.isFocused&&H.shape.polygon&&y.current&&(H.shape.polygon.vertices=y.current.getPolygonPointsWithAux(H.shape.polygon.vertices)),H));return(w==null?void 0:w.dragging)&&re(B),B}),(K=y.current)==null||K.resetDragging(),(ee=h.current)==null||ee.resetDragging(),C();break}}b.current=void 0;const me=d.find(({isFocused:D})=>D);p.style.cursor=$r(A,X,me,le,s==="select")},G=P=>{var p;P.key==="Escape"&&s==="polygon"&&((p=y.current)==null||p.cancelAnnotating(),C())},te=(P,p)=>{!p||(m(w=>{const $=p.key==="remove-selected"?w.filter(A=>!A.isFocused):[];return re($),$}),C())},ce=(P,p)=>{var w;(w=y.current)==null||w.cancelAnnotating(),c(p==null?void 0:p.key),b.current=void 0,m($=>$.map(A=>(A.isFocused=!1,A))),C()},re=P=>{x.args[e.name]=P.map(({tag:p,shape:w})=>w.rect?{tag:p,shape:{rect:{x1:w.rect.x1/k,x2:w.rect.x2/k,y1:w.rect.y1/k,y2:w.rect.y2/k}}}:w.polygon?{tag:p,shape:{polygon:{vertices:w.polygon.vertices.filter($=>!$.isAux).map($=>({x:$.x/k,y:$.y/k}))}}}:{tag:p,shape:w}),e.trigger&&x.push()};t.useEffect(()=>{x.args[e.name]=e.items||[]},[]),t.useEffect(()=>{const P=new Image;P.src=e.image,P.onload=()=>{const p=u.current,w=g.current;if(!p||!w)return;v.current=w.getContext("2d");const $=p.getContext("2d");if(!$)return;const A=e.image_height?+e.image_height.replace("px",""):P.naturalHeight,X=A/P.naturalHeight;_(X),p.height=A,p.width=P.naturalWidth*X,w.height=A,w.width=P.naturalWidth*X,w.style.zIndex="1",w.parentElement.style.height=ge(A),h.current=new Hc(w),v.current&&(y.current=new Vc(v.current)),$.drawImage(P,0,0,P.width,P.height,0,0,P.width*X,P.height*X),d.length||(m(Xc(e.items||[],X)),C())}},[e.name,e.image,e.image_height,e.items]);const I=[Ka("select","Select",ce,s,"TouchPointer")];return l.has("rect")&&I.push(Ka("rect","Rectangle",ce,s,"RectangleShape")),l.has("polygon")&&I.push(Ka("polygon","Polygon",ce,s,"SixPointStar")),t.createElement("div",{"data-test":e.name},t.createElement("div",{className:M("wave-s16 wave-w6",ma.title)},e.title),t.createElement(ni,{tags:e.tags,activateTag:R,activeTag:i}),t.createElement(Zt,{styles:{root:{padding:0}},items:[{key:"remove-selected",text:"Remove selection",onClick:te,disabled:d.every(P=>!P.isFocused),iconProps:{iconName:"RemoveContent",styles:{root:{fontSize:20}}}},{key:"remove-all",text:"Remove all",onClick:te,disabled:d.length===0,iconProps:{iconName:"DependencyRemove",styles:{root:{fontSize:20}}}}],farItems:I}),t.createElement("div",{className:ma.canvasContainer},t.createElement("canvas",{ref:u,className:ma.canvas}),t.createElement("canvas",{tabIndex:0,ref:g,className:ma.canvas,onMouseMove:W,onMouseDown:S,onKeyDown:G,onContextMenu:P=>P.preventDefault(),onClick:T})))},Gc=({model:e})=>{const a=t.useCallback((n,r)=>{x.args[e.name]=!!r,e.trigger&&x.push()},[e.name,e.trigger]);return t.useEffect(()=>{x.args[e.name]=!!e.value},[]),t.createElement(Ki,{"data-test":e.name,label:e.label,defaultChecked:e.value,onChange:a,disabled:e.disabled,onText:"On",offText:"Off",inlineLabel:!0})},bn=F({card:{display:"flex",flexDirection:"column",padding:24},body:{marginTop:16,flexGrow:1,display:"flex"},plot:{$nest:{canvas:{position:"absolute",top:0,left:0,right:0,bottom:0}}}}),ri=({model:e})=>{const a=t.useRef(null),n=t.useRef(),r=t.useCallback(async()=>{if(n.current&&e.data){const m=(await We(()=>import("./vega.module.b951fd74.js").then(function(u){return u.v}),["wave-static/vega.module.b951fd74.js","wave-static/vendor.9571d771.js"])).changeset().remove(()=>!0).insert(N.unpack(e.data));n.current.view.change("source_0",m).run()}},[e.data]),l=t.useCallback(async()=>{const m=a.current;if(!m)return;const u=JSON.parse(e.specification);isNaN(u.height)?m.clientHeight<30&&(m.style.height="300px"):m.style.height=`${u.height+10}px`;const g=N.unpack(e.data),h=m.clientWidth-10,y=m.clientHeight-10;g&&(u.data={values:g});const{default:k}=await We(()=>import("./vega-embed.module.3a214c06.js"),["wave-static/vega-embed.module.3a214c06.js","wave-static/vega.module.b951fd74.js","wave-static/vendor.9571d771.js"]);n.current=await k(m,u,{mode:e.grammar||"vega-lite",defaultStyle:!1,renderer:"canvas",actions:!1,config:{autosize:{type:"fit",resize:!0},view:{discreteWidth:h,discreteHeight:y,continuousWidth:h,continuousHeight:y}}})},[e.data,e.grammar,e.specification]),i=St(1e3,l),{name:o,width:s="auto",height:c="auto"}=e,d=s==="auto"&&c==="auto"?{flexGrow:1}:{width:Nt(s),height:c};return t.useEffect(()=>{r()},[r,e]),t.useEffect(()=>(l(),window.addEventListener("resize",i),()=>window.removeEventListener("resize",i)),[]),t.createElement("div",{"data-test":o,className:bn.plot,style:Z(L({},d),{position:"relative"}),ref:a})},qc=V(({name:e,state:a,changed:n})=>({render:()=>{const{specification:l,data:i,title:o,grammar:s="vega-lite"}=a;return t.createElement("div",{"data-test":e,className:bn.card},t.createElement("div",{className:"wave-s12 wave-w6"},o),t.createElement("div",{className:bn.body},t.createElement(ri,{model:{specification:l,data:i,grammar:s}})))},changed:n}));Q.register("vega",qc);const Nr=F({card:{display:"inline-flex",alignItems:"center",cursor:"pointer",$nest:{"&:hover":{color:f("$themePrimary")},"&:hover button":{color:f("$themePrimary")}}},icon:{fontSize:18}}),Qc=({model:e})=>{const{name:a,items:n,icon:r,image:l,label:i}=e,o=t.useRef(null),[s,c]=t.useState(!0),d=()=>c(m=>!m);return t.createElement("div",{"data-test":a,className:M(Nr.card,"w-menu"),ref:o,onClick:d},l&&t.createElement(Jr,{imageUrl:l,size:rt.size48,styles:{details:{padding:0}}}),r&&t.createElement(it,{className:Nr.icon,iconName:r}),i&&t.createElement(pe,{variant:"mediumPlus",className:"w-menu-label"},i),t.createElement(Pa,{items:$t(n),target:o,hidden:s,onDismiss:d,isBeakVisible:!0,directionalHint:Da.bottomRightEdge,calloutProps:{styles:{beak:{border:xe(1,f("$neutralQuaternaryAlt"))}}},styles:ea}),t.createElement(kt,{iconProps:{iconName:"CaretSolidDown",styles:{root:{fontSize:12}}},styles:{root:{padding:0}}}))},Sr=F({container:{display:"flex",justifyContent:"center"},tag:{display:"flex",justifyContent:"center",alignItems:"center",borderRadius:4,boxSizing:"border-box",minWidth:49,height:49,padding:"0 18px",marginRight:10}}),Kc=({model:e})=>{const a=e.items.map((n,r)=>{const l=n.color||"$text",i=f(n.label_color||Gt(l));return t.createElement("div",{key:r,style:{background:f(l),color:i},className:M(Sr.tag,"wave-s18 wave-w6")},n.label)});return t.createElement("div",{className:Sr.container},a)},mt=F({toolbar:{paddingTop:16,paddingLeft:16},toolbarTime:{fontSize:26,cursor:"pointer",$nest:{"&:hover":{backgroundColor:f("$neutralLighter"),color:f("$neutralDark")}}},toolbarText:{fontSize:26},toolbarLabel:{maxWidth:"70%"}}),Yc={placement:"bottom-start",sx:{"& .MuiPaper-root":{borderRadius:"2px",boxShadow:`${f("$text1")} 0px 6.4px 14.4px 0px, ${f("$text2")} 0px 1.2px 3.6px 0px`},"& .MuiTypography-root, [role=listbox]>span":{fontFamily:'"Inter", -apple-system, BlinkMacSystemFont, "Segoe UI", "Roboto", "Oxygen", "Ubuntu", "Cantarell", "Fira Sans", "Droid Sans", "Helvetica Neue", sans-serif'}}},Jc=t.lazy(()=>We(()=>import("./index.52a2b112.js"),["wave-static/index.52a2b112.js","wave-static/vendor.9571d771.js","wave-static/useThemeProps.25b3f68f.js","wave-static/Paper.c9988e69.js"]).then(({ThemeProvider:e})=>({default:e}))),Zc=t.lazy(()=>We(()=>import("./index.e5451118.js"),["wave-static/index.e5451118.js","wave-static/LocalizationProvider.48e69af2.js","wave-static/vendor.9571d771.js","wave-static/useThemeProps.25b3f68f.js"]).then(({LocalizationProvider:e})=>({default:e}))),ed=t.lazy(()=>We(()=>import("./index.44a9e11a.js"),["wave-static/index.44a9e11a.js","wave-static/vendor.9571d771.js","wave-static/useThemeProps.25b3f68f.js","wave-static/Paper.c9988e69.js","wave-static/LocalizationProvider.48e69af2.js"]).then(({TimePicker:e})=>({default:e}))),td={1:1,5:5,10:10,15:15,20:20,30:30,60:60},Dt=e=>new Date(`2000-01-01T${e.slice(0,5)}:00`),ad=e=>{const[a,n]=t.useState(),[r,l]=t.useState(),[i,o]=t.useState();return t.useEffect(()=>{We(()=>import("./index.b2efbf61.js"),["wave-static/index.b2efbf61.js","wave-static/index.26de52b4.js","wave-static/vendor.9571d771.js"]).then(({AdapterDateFns:s})=>l(()=>s)),We(()=>import("./index.52a2b112.js"),["wave-static/index.52a2b112.js","wave-static/vendor.9571d771.js","wave-static/useThemeProps.25b3f68f.js","wave-static/Paper.c9988e69.js"]).then(({createTheme:s})=>n(s(e))),We(()=>import("./index.26de52b4.js").then(function(s){return s.u}),[]).then(({default:s})=>o(()=>s))},[]),{theme:a,AdapterDateFns:r,format:i}},_r=()=>t.createElement("div",{"data-test":"lazyload",style:{height:59}},t.createElement(_n,{styles:{root:{height:"100%"}},size:Pn.small})),nd=({setOpenView:e,time:a,label:n,switchAmPm:r})=>t.createElement("div",{className:mt.toolbar},n&&t.createElement(He,{className:mt.toolbarLabel},n),t.createElement(pe,{className:mt.toolbarText},t.createElement(pe,{className:mt.toolbarTime,onClick:()=>e("hours")},(a==null?void 0:a.substring(0,2))||"--"),":",t.createElement(pe,{className:mt.toolbarTime,onClick:()=>e("minutes")},(a==null?void 0:a.substring(3,5))||"--")," ",t.createElement(pe,{className:mt.toolbarTime,onClick:r},(a==null?void 0:a.substring(6,8))||""))),rd=({model:e})=>{const{hour_format:a="12",label:n,disabled:r,min:l,max:i,placeholder:o,required:s,minutes_step:c=1}=e,[d,m]=t.useState(e.value?Dt(e.value):null),[u,g]=t.useState(!1),h=t.useRef(null),y=()=>{m(T=>{const G=new Date(T);return G.setTime(G.getTime()+12*60*60*1e3),G})},k=T=>{x.args[e.name]=T?S(T,"24"):null,e.trigger&&x.push()},_=()=>setTimeout(()=>{var T;return(T=document.activeElement)==null?void 0:T.blur()}),{palette:b}=rl(),v={palette:{background:{paper:f("$card")},primary:{main:b.themePrimary,contrastText:f("$neutralLight")},text:{primary:b.neutralPrimary,secondary:f("$neutralSecondary"),disabled:f("$neutralTertiaryAlt")},action:{active:b.themePrimary,disabled:f("$neutralLight"),hover:f("$neutralLight"),hoverOpacity:.04}}},{format:E,AdapterDateFns:C,theme:R}=ad(v),S=(T,G)=>E?E(T,G==="12"?"hh:mm aa":"HH:mm"):"",W=(T,G="00:00",te="00:00")=>`Wrong input. Please enter the time in range from ${S(Dt(G),T)} 
        to ${S(Dt(te),T)}.`;return t.useEffect(()=>{E&&(x.args[e.name]=d?S(d,"24"):null)},[E]),t.useEffect(()=>{R&&(R.palette.primary.main=b.themePrimary,R.palette.text.primary=b.neutralPrimary,R.palette.action.active=b.themePrimary)},[b.themePrimary,R]),t.createElement(t.Fragment,null,t.createElement(t.Suspense,{fallback:t.createElement(_r,null)},R&&C&&E?t.createElement(Jc,{theme:R},t.createElement(Zc,{dateAdapter:C},t.createElement(ed,{value:d,label:n,open:u,onChange:T=>m(T),onAccept:T=>k(T),onClose:()=>g(!1),ampm:a==="12",showToolbar:!0,ToolbarComponent:({parsedValue:T,setOpenView:G,ampm:te})=>t.createElement(nd,{setOpenView:G,time:T&&S(T,te?"12":"24"),label:n,switchAmPm:y}),PopperProps:L({anchorEl:()=>h.current},Yc),minTime:l?Dt(l):void 0,maxTime:i?Dt(i):void 0,minutesStep:td[c],disabled:r,onOpen:_,renderInput:({inputProps:T,error:G})=>t.createElement("div",{ref:h,"data-test":e.name},t.createElement(Ie,{iconProps:{iconName:"Clock"},onClick:()=>g(!0),onChange:T==null?void 0:T.onChange,placeholder:o,disabled:r,readOnly:!0,value:d?S(d,a):"",label:n,required:s,styles:{field:{cursor:"pointer",height:32},icon:{bottom:7}},errorMessage:G?W(a,l,i):void 0}))}))):t.createElement(_r,null)))},ld={items:[]},ba=F({card:{padding:15},vertical:{display:"flex",flexDirection:"column",flexGrow:1,$nest:{'> [data-visible="true"] ~ div':{marginTop:10}}},horizontal:{display:"flex",alignItems:"center",$nest:{'> [data-visible="true"] ~ div':{marginLeft:8}}},inset:{background:f("$page"),padding:be(10,15)}}),Ee=({items:e,alignment:a,inset:n})=>{const r=e.map((l,i)=>{const[o]=Object.keys(l),{name:s,visible:c=!0,width:d="auto"}=l[o],m=c?{}:{display:"none"},u=o==="links"?"flex-start":void 0;return t.createElement("div",{key:s||`${o}-${i}`,"data-visible":c,style:Z(L({},m),{width:d,alignSelf:u})},t.createElement(id,{model:l}))});return t.createElement("div",{className:M(a?ba.horizontal:ba.vertical,n?ba.inset:""),style:{justifyContent:Dn[a||""]}},r)},En=({model:e})=>t.createElement(Ee,{items:e.items,alignment:e.justify||"start",inset:e.inset}),id=({model:e})=>e.text?t.createElement(oe,{content:e.text.tooltip,expand:!1},t.createElement(dt,{name:e.text.name,content:e.text.content,size:e.text.size})):e.text_xl?t.createElement(oe,{content:e.text_xl.tooltip,expand:!1},t.createElement(dt,{name:e.text_xl.name,content:e.text_xl.content,size:"xl",commands:e.text_xl.commands})):e.text_l?t.createElement(oe,{content:e.text_l.tooltip,expand:!1},t.createElement(dt,{name:e.text_l.name,content:e.text_l.content,size:"l",commands:e.text_l.commands})):e.text_m?t.createElement(oe,{content:e.text_m.tooltip,expand:!1},t.createElement(dt,{name:e.text_m.name,content:e.text_m.content})):e.text_s?t.createElement(oe,{content:e.text_s.tooltip,expand:!1},t.createElement(dt,{name:e.text_s.name,content:e.text_s.content,size:"s"})):e.text_xs?t.createElement(oe,{content:e.text_xs.tooltip,expand:!1},t.createElement(dt,{name:e.text_xs.name,content:e.text_xs.content,size:"xs"})):e.label?t.createElement(oe,{content:e.label.tooltip,expand:!1},t.createElement(ks,{model:e.label})):e.link?t.createElement(oe,{content:e.link.tooltip,expand:!1},t.createElement(Xl,{model:e.link})):e.links?t.createElement(Cs,{model:e.links}):e.separator?t.createElement(ac,{model:e.separator}):e.progress?t.createElement(oe,{content:e.progress.tooltip},t.createElement(Zs,{model:e.progress})):e.message_bar?t.createElement(Ss,{model:e.message_bar}):e.textbox?t.createElement(oe,{content:e.textbox.tooltip},t.createElement(Bc,{model:e.textbox})):e.checkbox?t.createElement(oe,{content:e.checkbox.tooltip,expand:!1},t.createElement(es,{model:e.checkbox})):e.toggle?t.createElement(oe,{content:e.toggle.tooltip,expand:!1},t.createElement(Gc,{model:e.toggle})):e.choice_group?t.createElement(oe,{content:e.choice_group.tooltip},t.createElement(as,{model:e.choice_group})):e.dropdown?t.createElement(oe,{content:e.dropdown.tooltip},t.createElement(ps,{model:e.dropdown})):e.checklist?t.createElement(oe,{content:e.checklist.tooltip},t.createElement(ts,{model:e.checklist})):e.combobox?t.createElement(oe,{content:e.combobox.tooltip},t.createElement(os,{model:e.combobox})):e.slider?t.createElement(oe,{content:e.slider.tooltip},t.createElement(nc,{model:e.slider})):e.spinbox?t.createElement(oe,{content:e.spinbox.tooltip},t.createElement(oc,{model:e.spinbox})):e.date_picker?t.createElement(oe,{content:e.date_picker.tooltip},t.createElement(ms,{model:e.date_picker})):e.color_picker?t.createElement(oe,{content:e.color_picker.tooltip},t.createElement(is,{model:e.color_picker})):e.file_upload?t.createElement(oe,{content:e.file_upload.tooltip},t.createElement(ys,{model:e.file_upload})):e.table?t.createElement(oe,{content:e.table.tooltip},t.createElement(_c,{model:e.table})):e.buttons?t.createElement(Yo,{model:e.buttons}):e.tabs?t.createElement(Tc,{model:e.tabs}):e.button?t.createElement(oe,{content:e.button.tooltip,showIcon:!1,expand:!1},t.createElement(Jo,{model:e.button})):e.expander?t.createElement(fs,{model:L({},e.expander)}):e.frame?t.createElement(xs,{model:e.frame}):e.markup?t.createElement(zn,{model:e.markup}):e.template?t.createElement(Dc,{model:e.template}):e.picker?t.createElement(oe,{content:e.picker.tooltip},t.createElement(Ts,{model:e.picker})):e.range_slider?t.createElement(oe,{content:e.range_slider.tooltip},t.createElement(ec,{model:e.range_slider})):e.stepper?t.createElement(oe,{content:e.stepper.tooltip},t.createElement(dc,{model:e.stepper})):e.visualization?t.createElement(Mn,{model:e.visualization}):e.vega_visualization?t.createElement(ri,{model:e.vega_visualization}):e.stats?t.createElement(cc,{model:e.stats}):e.inline?t.createElement(En,{model:e.inline}):e.image?t.createElement(jl,{model:e.image}):e.persona?t.createElement(na,{model:e.persona}):e.text_annotator?t.createElement(Mc,{model:e.text_annotator}):e.image_annotator?t.createElement(Uc,{model:e.image_annotator}):e.mini_button?t.createElement(Dl,{model:e.mini_button}):e.mini_buttons?t.createElement(Zo,{model:e.mini_buttons}):e.facepile?t.createElement(hs,{model:e.facepile}):e.copyable_text?t.createElement(ns,{model:e.copyable_text}):e.menu?t.createElement(Qc,{model:e.menu}):e.tags?t.createElement(Kc,{model:e.tags}):e.time_picker?t.createElement(rd,{model:e.time_picker}):t.createElement(Ut,{messageBarType:Xe.severeWarning},"This component could not be rendered."),od=V(({name:e,state:a,changed:n})=>({render:()=>{const l=L(L({},ld),a),i=l.title,o=N.unpack(l.items);return t.createElement("div",{"data-test":e,className:ba.card},i&&t.createElement("div",{className:"wave-s12 wave-w6"},i),t.createElement(Ee,{items:o}))},changed:n}));Q.register("form",od);const Ya=F({card:{padding:24,$nest:{".wave-markdown":{marginTop:12,$nest:{"&:first-child":{marginTop:0},"h1, h2, h3, h4, h5, h6":{marginBlock:0,color:f("$neutralPrimary")},h1:{margin:ve(18,0),fontSize:20,fontWeight:600,letterSpacing:"-0.017em",lineHeight:ge(28)},h2:{margin:ve(12,0),fontSize:18,fontWeight:500,letterSpacing:"-0.014em",lineHeight:ge(25.2)},h3:{margin:ve(8,0),fontSize:16,fontWeight:400,letterSpacing:"-0.011em",lineHeight:ge(22.4)},p:{fontSize:14,letterSpacing:"-0.006em",lineHeight:ge(20),color:f("$text7"),marginBlock:0}}}}},title:{color:f("$neutralPrimary")},miniBtns:{marginLeft:-4}}),sd=V(({name:e,state:a,changed:n})=>({render:()=>{const{title:l,content:i,items:o}=a;return t.createElement("section",{"data-test":e,className:Ya.card},t.createElement("div",{className:M("wave-s20 wave-w6",Ya.title)},l),o&&t.createElement("div",{className:Ya.miniBtns},t.createElement(Ee,{items:o})),i&&t.createElement(Pe,{source:i}))},changed:n}));Q.register("article",sd);const cd=F({card:{display:"flex",flexDirection:"column",justifyContent:"center"}}),dd=V(({name:e,state:a,changed:n})=>{const r=a.items.map(({name:i,label:o})=>({key:i,text:o,onClick:()=>{if(i.startsWith("#")){window.location.hash=i.substring(1);return}x.args[i]=!0,x.push()}}));return{render:()=>t.createElement("div",{"data-test":e,className:cd.card},t.createElement(Yi,{items:r,styles:{root:{margin:0}}})),changed:n}});Q.register("breadcrumbs",dd,{effect:et.Transparent});class li{constructor(a,n){this.x=a,this.y=n}}function md(e,a){const n=e.x-a.x,r=e.y-a.y;return n*n+r*r}function ud(e,a,n){let r=a.x,l=a.y,i=n.x-r,o=n.y-l;if(i!==0||o!==0){const s=((e.x-r)*i+(e.y-l)*o)/(i*i+o*o);s>1?(r=n.x,l=n.y):s>0&&(r+=i*s,l+=o*s)}return i=e.x-r,o=e.y-l,i*i+o*o}const gd={x:0,y:0};function pd(e,a){let n=e[0],r=gd;const l=[n];for(let i=1,o=e.length;i<o;i++)r=e[i],md(r,n)>a&&(l.push(r),n=r);return n!==r&&l.push(r),l}function wn(e,a,n,r,l){let i=r,o=0;for(let s=a+1;s<n;s++){const c=ud(e[s],e[a],e[n]);c>i&&(o=s,i=c)}i>r&&(o-a>1&&wn(e,a,o,r,l),l.push(e[o]),n-o>1&&wn(e,o,n,r,l))}function fd(e,a){const n=e.length-1,r=[e[0]];return wn(e,0,n,a,r),r.push(e[n]),r}function hd(e,a,n){if(e.length<=2)return e;const r=a!==void 0?a*a:1;return e=n?e:pd(e,r),e=fd(e,r),e}const Pr=F({card:{display:"flex",flexDirection:"column",padding:se.gap,overflow:"auto"},layers:{position:"relative"}}),ua=e=>{const a=new Array(e.length*2);let n=0;for(const r of e)a[n++]=r.x,a[n++]=r.y;return a},Ja=e=>{const a=new Array(e.length/2);let n=0;for(let r=0,l=a.length;r<l;r++)a[r]=new li(e[n++],e[n++]);return a},Za=(e,a,n)=>{const r=document.createElement("canvas"),l=r.getContext("2d",{alpha:!0});if(!l)throw new Error("failed obtaining canvas context");const i=window.devicePixelRatio||1,o=l.webkitBackingStorePixelRatio||l.mozBackingStorePixelRatio||l.msBackingStorePixelRatio||l.oBackingStorePixelRatio||l.backingStorePixelRatio||1,s=i/o;return r.style.outline="1px solid #ccc",r.style.position="absolute",i!==o?(r.width=e*s,r.height=a*s,l.scale(s,s),r.style.width=ge(e),r.style.height=ge(a)):(r.width=e,r.height=a),{el:r,g:l,w:e,h:a,r:s}},yd=e=>{const a=e.toString(16);return a.length===1?`0${a}`:a},en=(()=>{const e=new Map;for(let a=0;a<256;a++)e.set(a,yd(a));return e})(),vd=(e,a,n)=>{let r=e;const l=new Map;return{put:c=>{const d=r++;r>=16581375&&(r=0),l.set(d,c);const m=d>>16&255,u=d>>8&255,g=d&255;return`#${en.get(m)}${en.get(u)}${en.get(g)}`},test:(c,d)=>{const m=a.getImageData(c*n,d*n,1,1).data;if(m[3]===255)return l.get((m[0]<<16)+(m[1]<<8)+m[2])},clear:()=>{l.clear(),r=e}}},xd=e=>e.charAt(0).toUpperCase()+e.slice(1),bd=(()=>{const e=[];for(const a in Ht)e.push({name:xd(a),color:Ht[a]});return e})(),Ed=V(({name:e,state:a,changed:n})=>{const r=N.box([]),l=N.box([]),i=N.box(1),o=N.box("black"),s=N.box(3),c=N.box(),d=[["Fine",3],["Medium",5],["Bold",7]],m=t.createRef(),u=S=>{S.lineJoin="round",S.lineCap="round"},g=(S,W)=>S===W||S.x===W.x&&S.y===W.y,h=(S,W)=>{const T=s(),G=Math.floor(T/2);S.fillRect(W.x-G,W.y-G,T,T)},y=(S,W,T)=>{if(g(W,T)){h(S,W);return}S.beginPath(),S.moveTo(W.x,W.y),S.lineTo(T.x,T.y),S.stroke()},k=(S,W,T)=>{S.strokeRect(W.x,W.y,T.x-W.x,T.y-W.y)},_=(S,W,T)=>{S.fillRect(W.x,W.y,T.x-W.x,T.y-W.y)},b=(S,W)=>{switch(W.length){case 1:h(S,W[0]);return;case 2:y(S,W[0],W[1]);return;default:{S.beginPath();let T=W[0];S.moveTo(T.x,T.y);for(let G=1,te=W.length;G<te;G++)T=W[G],S.lineTo(T.x,T.y);S.stroke()}}},v=()=>{const S=m.current;if(!S){window.setTimeout(v,500);return}const{width:W,height:T}=a,G=Za(W,T),te=Za(W,T),ce=Za(W,T),re=G.el,I=G.g,j=te.g,P=ce.g;re.style.cursor="crosshair",S.appendChild(te.el),S.appendChild(re),u(I),u(j);let p=[];const w=vd(0,P,ce.r),$=z=>z.clearRect(0,0,W,T),A=(z,q,J)=>{z.set(`${e} data ${q}`,J)},X=(z,q)=>{const J=x.fork();A(J,z,q),J.push()},le=z=>{const q=x.fork();for(const J of z)A(q,J,null);q.push()},me=z=>{p.length>1?p[1]=z:p.push(z)},Y=(z,q)=>{const J=new li(z,q);switch(i()){case 1:{p.push(J);const ie=p.length,ke=p[ie-1];y(I,ke,p.length===1?ke:p[ie-2])}break;case 2:{if(me(J),p.length<2)return;$(I),y(I,p[0],p[1])}break;case 3:{if(me(J),p.length<2)return;$(I),k(I,p[0],p[1])}break;case 4:{if(me(J),p.length<2)return;$(I),_(I,p[0],p[1])}break;default:{const ie=w.test(z,q);if(ie!==void 0){const ke=r();X(ke[ie],null)}}}},U=(z,q,J)=>{switch(z){case 1:return{t:1,p:ua(hd(p,2,!0)),c:q,l:J};case 2:return p.length===2?{t:2,p:ua(p),c:q,l:J}:void 0;case 3:return p.length===2?{t:3,p:ua(p),c:q,l:J}:void 0;case 4:return p.length===2?{t:4,p:ua(p),c:q}:void 0}},K=()=>{if(!p.length)return;const z=U(i(),o(),s());z&&(ee(z,0),X(new Date().toISOString(),JSON.stringify(z))),p=[],$(I)},ee=(z,q)=>{switch(z.t){case 1:case 2:{const J=Ja(z.p);j.strokeStyle=z.c,j.lineWidth=z.l,b(j,J),P.strokeStyle=w.put(q),P.lineWidth=z.l,b(P,J)}break;case 3:{const J=Ja(z.p),[ie,ke]=J;j.strokeStyle=z.c,j.lineWidth=z.l,k(j,ie,ke),P.strokeStyle=w.put(q),P.lineWidth=z.l,k(P,ie,ke)}break;case 4:{const J=Ja(z.p),[ie,ke]=J;j.fillStyle=z.c,_(j,ie,ke),P.fillStyle=w.put(q),_(P,ie,ke)}break}},D=z=>{$(j),$(P),z.forEach(ee)},B=z=>{const q=re.getBoundingClientRect();Y(z.clientX-q.left,z.clientY-q.top)},H=()=>{re.removeEventListener("mousemove",B),re.removeEventListener("mouseup",H),re.removeEventListener("mouseout",H),K()};re.addEventListener("mousedown",z=>{B(z),re.addEventListener("mousemove",B),re.addEventListener("mouseup",H),re.addEventListener("mouseout",H)}),N.to(l,D),N.to(o,z=>{I.strokeStyle=z,I.fillStyle=z}),N.to(s,z=>{I.lineWidth=z}),N.on(c,()=>le(r()))},E=[{key:"tool",iconProps:{iconName:"Edit"},subMenuProps:{items:[{key:"pen",text:"Pen",iconProps:{iconName:"Edit"},onClick:()=>{i(1)}},{key:"line",text:"Line",iconProps:{iconName:"Line"},onClick:()=>{i(2)}},{key:"rect",text:"Rectangle",iconProps:{iconName:"RectangleShape"},onClick:()=>{i(3)}},{key:"solid_rect",text:"Solid Rectangle",iconProps:{iconName:"RectangleShapeSolid"},onClick:()=>{i(4)}}]}},{key:"color",iconProps:{iconName:"Color"},subMenuProps:{items:bd.map(({name:S,color:W})=>({key:W,text:S,iconProps:{iconName:"CircleFill",style:{color:W}},onClick:()=>{o(W)}}))}},{key:"lineWidth",iconProps:{iconName:"LineThickness"},subMenuProps:{items:d.map(([S,W])=>({key:S,text:S,iconProps:{iconName:"Edit"},onClick:()=>{s(W)}}))}},{key:"erase",iconProps:{iconName:"EraseTool"},onClick:()=>{i(0)}},{key:"clear",iconProps:{iconName:"Clear"},onClick:()=>{c(!0)}}],C=S=>{if(!S)return{};const W={};for(const T in S)W[T]=JSON.parse(S[T]);return W};return{init:v,render:()=>{const S=C(a.data),W=Object.keys(S).sort();return r(W),l(W.map(T=>S[T])),t.createElement("div",{"data-test":e,className:Pr.card},t.createElement("div",{className:"wave-s12 wave-w6"},a.title),t.createElement("div",null,t.createElement(Zt,{items:E,ariaLabel:"Use left and right arrow keys to navigate between commands"})),t.createElement("div",{ref:m,className:Pr.layers}))},changed:n}});Q.register("canvas",Ed);const tt=F({card:{display:"flex",flexDirection:"column",padding:se.gap,overflow:"auto"},history:{flexGrow:1,overflow:"auto"},message:{padding:be(6,0)},header:{marginBottom:2},user:{marginRight:5},date:{color:f("$text7")},body:{paddingLeft:10,borderLeft:xe(1,f("$text3"))}}),wd=({inputB:e})=>{const[a,n]=t.useState(""),r=t.useCallback((i,o)=>{n(o||"")},[]),l=({key:i,target:o},s)=>{if(i=="Enter"){let c=s!=null?s:o.value;if(!c)return;c=c.trim(),n(""),c.length&&e(c)}};return t.createElement(Ie,{label:"Send a message",multiline:!0,autoAdjustHeight:!0,onKeyUp:l,onChange:r,value:a})},kd=e=>{if(!e)return{};const a={};for(const n in e)a[n]=JSON.parse(e[n]);return a},Cd=V(({name:e,state:a,changed:n})=>{let r=[];const l=t.createRef(),i=N.box("",()=>!1),o=()=>{const c=l.current;c&&(c.scrollTop=c.scrollHeight)},s=()=>{const c=kd(a.data),d=Object.keys(c).sort(),m=d.map(u=>{const{u:g,m:h}=c[u];return t.createElement("div",{key:`${g}|${u}|${h}`,className:tt.message},t.createElement("div",{className:M("wave-s12",tt.header)},t.createElement("span",{className:M("wave-w6",tt.user)},g),t.createElement("span",{className:M("wave-s10",tt.date)},new Date(u).toLocaleString())),t.createElement("div",{className:tt.body},h))});return r=d,t.createElement("div",{"data-test":e,className:tt.card},t.createElement("div",{className:"wave-s12 wave-w6"},a.title),t.createElement("div",{ref:l,className:tt.history},m),t.createElement("div",null,t.createElement(wd,{inputB:i})))};return N.on(i,c=>{var h,y;const d=x.fork(),m=(h=a.capacity)!=null?h:50,u=r.length;if(u>=m)for(let k=0;k<u-m+1;k++)d.set(`${e} data ${r[k]}`,null);const g={u:(y=Na.username)!=null?y:"?",m:c};d.set(`${e} data ${new Date().toISOString()}`,JSON.stringify(g)),d.push()}),{render:s,init:o,update:o,changed:n}});Q.register("chat",Cd);const ii=[{view:"canvas",icon:"EditCreate",attrs:[{name:"box",optional:!1,t:"box",value:'{"zone":"Body"}'},{name:"title",optional:!1,t:"textbox",value:"Untitled Canvas"},{name:"width",optional:!1,t:"spinbox",value:400,min:400,max:2048,step:50},{name:"height",optional:!1,t:"spinbox",value:300,min:300,max:1536,step:50},{name:"data",optional:!1,t:"record",value:{}}]},{view:"chat",icon:"OfficeChat",attrs:[{name:"box",optional:!1,t:"box",value:'{"zone":"Body"}'},{name:"title",optional:!1,t:"textbox",value:"Untitled Chat"},{name:"data",optional:!1,t:"record",value:{}},{name:"capacity",optional:!0,t:"spinbox",value:50,min:10,max:1e4,step:10}]},{view:"frame",icon:"PageAdd",attrs:[{name:"box",optional:!1,t:"box",value:'{"zone":"Body"}'},{name:"title",optional:!1,t:"textbox",value:"Untitled Frame"},{name:"path",optional:!0,t:"textbox",value:""},{name:"content",optional:!0,t:"textarea",value:""}]},{view:"markdown",icon:"InsertTextBox",attrs:[{name:"box",optional:!1,t:"box",value:'{"zone":"Body"}'},{name:"title",optional:!1,t:"textbox",value:"Untitled Content"},{name:"content",optional:!1,t:"textarea",value:"Hello, World!"}]},{view:"markup",icon:"FileHTML",attrs:[{name:"box",optional:!1,t:"box",value:'{"zone":"Body"}'},{name:"title",optional:!1,t:"textbox",value:"Untitled Content"},{name:"content",optional:!1,t:"textarea",value:"<div/>"}]}],fe=se.gap,$d=(e,a)=>{const n=(e==null?void 0:e.length)||0,r=(a==null?void 0:a.reduce((l,i)=>{var o,s;return l+(((s=(o=i.button)==null?void 0:o.label)==null?void 0:s.length)||0)+15},0))||0;return n+r>54},Ft=N.box(null),Nd=V(()=>{let e,a=null;const n=(s,c)=>s?Kn({from:{transform:c},to:{transform:"none"}}):Kn({from:{transform:"none"},to:{transform:c}}),r=(s="top-right",c)=>{if(window.innerWidth<500+fe)return s.includes("top")?{top:0,right:0,left:0,margin:"0 auto",animationName:n(c,"translateY(-100%)")}:{bottom:0,right:0,left:0,margin:"0 auto",animationName:n(c,"translateY(100%)")};switch(s){case"top-right":return{top:fe,right:fe,animationName:n(c,`translateX(calc(100% + ${fe}px))`)};case"top-center":return{top:fe,right:0,left:0,margin:"0 auto",animationName:n(c,`translateY(calc(-100% - ${fe}px))`)};case"top-left":return{top:fe,left:fe,animationName:n(c,`translateX(calc(-100% - ${fe}px))`)};case"bottom-right":return{bottom:fe,right:fe,animationName:n(c,`translateX(calc(100% + ${fe}px))`)};case"bottom-center":return{bottom:fe,right:0,left:0,margin:"0 auto",animationName:n(c,`translateY(calc(100% + ${fe}px))`)};case"bottom-left":return{bottom:fe,left:fe,animationName:n(c,`translateX(calc(-100% - ${fe}px))`)}}},l=()=>{window.clearTimeout(e),a=Ft();const{name:s,events:c}=a||{},d=c==null?void 0:c.find(m=>m==="dismissed");d&&s&&x.emit(s,d,!0),Ft(null)};return{render:()=>{var k,_;const s=Ft(),c=!!s,d=s||a,{iconName:m,color:u,background:g}=ql[(d==null?void 0:d.type)||"info"],h=(k=d==null?void 0:d.buttons)==null?void 0:k.filter(({button:b})=>b),y=$d(d==null?void 0:d.text,h);return(s==null?void 0:s.timeout)!==-1&&c&&(e=window.setTimeout(l,((s==null?void 0:s.timeout)||5)*1e3)),((_=d==null?void 0:d.text)==null?void 0:_.length)?t.createElement(Ut,{messageBarType:Ql(d==null?void 0:d.type),messageBarIconProps:{iconName:m},actions:(h==null?void 0:h.length)?t.createElement(Ee,{items:h||[],alignment:"end"}):void 0,isMultiline:y,onDismiss:l,className:Gl.messageBar,styles:{root:L({background:g,color:u,borderRadius:4,".ms-Link":{color:u,fontWeight:600},".ms-Link:hover":{textDecoration:"none",color:u},padding:16,minHeight:24,position:"fixed",animationDuration:"0.5s",animationFillMode:"forwards",maxWidth:500,width:Ne(100),zIndex:999},r(d==null?void 0:d.position,c)),content:{alignItems:y?"start":"center"},icon:{fontSize:24,color:u,display:"inline-flex"},iconContainer:{margin:0,marginRight:16,display:"flex",alignItems:"center"},text:{margin:0},innerText:{whiteSpace:ye("initial")},dismissal:{fontSize:16,height:"auto",marginLeft:16,padding:0,".ms-Button-flexContainer":{display:"block"}},dismissSingleLine:{display:"flex"},actions:{margin:0,marginTop:y?12:void 0}}},t.createElement(Pe,{source:d==null?void 0:d.text})):t.createElement(t.Fragment,null)},notificationBarB:Ft,dispose:()=>window.clearTimeout(e)}}),vt=N.box();var Sd=V(()=>{const e=()=>{const{name:n,events:r}=vt()||{};n&&(r==null||r.forEach(l=>{l==="dismissed"&&x.emit(n,l,!0)})),vt(null)};return{render:()=>{const{title:n,width:r="600px",items:l=[],closable:i,primary:o,blocking:s=!1}=vt()||{},c={title:n,onDismiss:e,showCloseButton:i,type:i?lt.close:o?lt.largeHeader:lt.normal};return t.createElement(Jt,{hidden:!vt(),onDismiss:e,dialogContentProps:c,modalProps:{isBlocking:s},minWidth:r,maxWidth:r},t.createElement(Ee,{items:l}))},dialogB:vt}});const _d=async e=>{if("Notification"in window)Notification.permission==="granted"?new Notification(e):Notification.permission!=="denied"&&await Notification.requestPermission()==="granted"&&new Notification(e);else return};let tn=null;const Tr={},Dr=e=>{tn&&tn.remove();const a=tn=document.createElement("script");a.type="text/javascript",a.appendChild(document.createTextNode(e)),document.body.appendChild(a)},Pd=e=>{let a=window;for(const n of e.split("."))if(a=a[n],!a)return!1;return!0},Td=e=>!e.some(a=>!Pd(a)),Dd=e=>document.getElementById(e)||document.querySelector(e),Ld=e=>!e.some(a=>!Dd(a)),Ad=e=>{e.forEach(({path:a,asynchronous:n,cross_origin:r,referrer_policy:l,integrity:i})=>{if(Tr[a])return;const o=document.createElement("script");o.type="text/javascript",o.src=a,n&&(o.async=!0),r&&(o.crossOrigin=r),l&&(o.referrerPolicy=l),i&&(o.integrity=i),document.body.appendChild(o),o.addEventListener("load",()=>{Tr[a]=!0})})},Rd=({content:e,requires:a,targets:n})=>{const r=()=>!(a&&a.length&&!Td(a)||n&&n.length&&!Ld(n));if(r()){Dr(e);return}let l=0;const i=setInterval(()=>{r()?(clearInterval(i),Dr(e)):(l++,l>100&&(clearInterval(i),console.error("Failed to execute inline script: one or more of the requirements were not found.")))},10)},xt=N.box();var Id=V(()=>{const e=()=>{const{name:n,events:r}=xt()||{},l=r==null?void 0:r.find(i=>i==="dismissed");l&&n&&x.emit(n,l,!0),xt(null)};return{render:()=>{const{title:n,width:r="600px",items:l=[],closable:i=!1,blocking:o=!1}=xt()||{};return t.createElement(Ra,{isOpen:!!xt(),headerText:n,type:ll.custom,customWidth:r,onDismiss:e,hasCloseButton:i,overlayProps:o?{style:{cursor:"default"}}:void 0,isBlocking:!0,isLightDismiss:!o},t.createElement(Ee,{items:l}))},sidePanelB:xt}});let _a=null;const zd=e=>{const a={};for(const n in e){const r=e[n];r&&(a[n]=n==="#"?r:!0)}return a},Bd=e=>{if(!!_a)switch(_a.type){case"ga":case"gtag":{const a=window;a.gtag&&a.gtag("event","sync",zd(e))}}},Md=e=>{if(!_a)switch(e.type){case"ga":case"gtag":{const a=document.createElement("script");a.type="text/javascript",a.async=!0,a.src=`https://www.googletagmanager.com/gtag/js?id=${e.id}`,document.body.appendChild(a),a.addEventListener("load",()=>{const n=window;n.dataLayer=n.dataLayer||[];function r(){n.dataLayer.push(arguments)}n.gtag=r,n.gtag("js",new Date),n.gtag("config",e.id)})}_a=e}};N.on(xl,e=>window.setTimeout(()=>Bd(e),0));const oi=N.box(""),si=N.box("");N.on(oi,e=>window.document.title=e);N.on(si,e=>{const a=document.querySelector("link[rel*='icon']"),n=document.querySelector("link[rel*='apple-touch-icon']");a&&(a.href=e),n&&(n.href=e)});const Ba=N.box([]),Lr=({state:e})=>{const{title:a,icon:n,refresh:r,notification:l,notification_bar:i,redirect:o,layouts:s,dialog:c,side_panel:d,theme:m,themes:u,tracker:g,scripts:h,script:y,stylesheet:k,stylesheets:_}=e;if(o){try{const{location:b}=window,v=new URL(`${b.origin}${b.pathname}${o}`);o===v.hash?b.hash=o:b.replace(o)}catch(b){console.error(`Could not redirect: ${o} is an invalid URL`,b)}delete e.redirect}if(vt(c?L({},c):null),xt(d?L({},d):null),setTimeout(()=>Ft(i?L({},i):null),0),a&&oi(a),n&&si(n),typeof r=="number"&&r===0&&N.disconnect(),m&&za(m),u&&fl(u),l&&_d(l),g&&Md(g),s&&Ba(s),h&&Ad(h),y&&(delete e.script,Rd(y)),k){const b=document.createElement("style"),{content:v,media:E}=k;b.innerText=v,E&&(b.media=E),document.head.appendChild(b),delete e.stylesheet}_&&(_.forEach(({path:b,media:v,cross_origin:E})=>{const C=document.createElement("link");C.rel="stylesheet",C.href=b,C.as="style",v&&(C.media=v),E&&(C.crossOrigin=E),document.head.appendChild(C)}),delete e.stylesheets)},Fd=V(()=>({render:()=>t.createElement(t.Fragment,null)}));Q.register("meta",Fd);const Lt=F({fab:{position:"fixed",right:20,bottom:20,width:56,height:56,color:f("$card"),background:f("$text"),borderRadius:"50%",fontSize:20,cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",boxShadow:`0px 3px 5px ${f("$text0")}`,$nest:{"&:hover":{boxShadow:`0px 12px 20px ${f("$text2")}`}}},panelActions:{marginTop:10},cards:{display:"flex",flexWrap:"wrap",justifyContent:"flex-start",alignItems:"flex-start",alignContent:"flex-start"},card:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",cursor:"pointer",margin:3,padding:3,border:xe(1,f("$text3")),$nest:{"&:hover":{backgroundColor:f("$text0")}}},cardIcon:{width:50,height:50,fontSize:22,display:"flex",justifyContent:"center",alignItems:"center",color:f("$text7")},cardCaption:{marginTop:5,fontSize:11,width:82,whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",textAlign:"center"}}),Wt=e=>e.split("_").map(a=>a.charAt(0).toUpperCase()+a.slice(1)).join(" "),Wd=(e,a)=>{const n={};for(const r of e)n[a(r)]=r;return n},Hd=Wd(ii,e=>e.view),kn=e=>N.parseU(e.replace(/px$/,"")),ci=(e,a)=>{for(const n of a)n.zones?ci(e,n.zones):e.push(n.name)},di=()=>{const e=Ba();return e&&e.length?e[0]:Ln.layout},Od=e=>{var a;return(a=ka.find(n=>n.layout.name===e.name))!=null?a:Ln},Vd={root:{marginTop:15}},Xt=({children:e})=>t.createElement(Aa,{styles:Vd},e),jd={root:{marginTop:5,marginBottom:5},labelWrapper:{width:90}},bt=V(({label:e,defaultValue:a,min:n,max:r,step:l,onChange:i})=>{const o=u=>{const g=N.parseU(u);return isNaN(g)?0:g},s=u=>{i(o(u.target.value))},c=u=>{const g=Math.min(r,o(u)+l);return i(g),String(g)},d=u=>{const g=Math.max(n,o(u)-l);return i(g),String(g)};return{render:()=>t.createElement(tl,{label:e,min:n,max:r,step:l,defaultValue:""+a,onBlur:s,onIncrement:c,onDecrement:d,styles:jd})}}),Ar=V(({view:e,card:a})=>{const{attrs:n}=Hd[e],r=!a,l={},i={},o=[],s=di();ci(o,s.zones);for(const{name:_,value:b}of n)l[_]=i[_]=b;if(a){const{state:_}=a;for(const b in _)l[b]=i[b]=_[b]}let c=a?a.name:`${e}${new Date().toISOString()}`;const d=()=>{Ae(Ot)},m=()=>{const _=x.fork();if(r){const b=L(L({view:e},l),i);_.put(c,b)}else for(const b in i){const v=i[b];v!==l[b]&&_.set(`${c} ${b}`,v)}_.push(),Ae(Ot)},u=()=>{Ae(vl)},g=()=>{Ae(Ot)},h=({target:_},b)=>{c=b||_.value},y=()=>t.createElement(Re,{horizontal:!0,tokens:{childrenGap:10}},t.createElement(Oe,{onClick:m},r?"Add card":"Save changes"),t.createElement(Ue,{onClick:r?u:g},"Back"));return{render:()=>{const _=n.map(b=>{const{name:v}=b;switch(b.t){case"textbox":{const E=({target:C},R)=>{i[v]=R||C.value};return t.createElement(Ie,{key:v,label:Wt(v),defaultValue:i[v],onChange:E})}case"textarea":{const E=({target:C},R)=>{i[v]=R||C.value};return t.createElement(Ie,{key:v,label:Wt(v),defaultValue:i[v],multiline:!0,onChange:E,styles:{field:{minHeight:300}}})}case"spinbox":{const{min:E,max:C,step:R,value:S}=b,W=S<E?E:S>C?C:S,T=G=>{i[v]=G};return i[v]=W,t.createElement(bt,{key:v,label:Wt(v)+":",min:E,max:C,step:R,defaultValue:i[v],onChange:T})}case"record":return t.createElement("div",{key:v});case"box":{const E=o.map(w=>({key:w,text:w})),C=w=>{const $=JSON.parse(i[v]);w($),i[v]=JSON.stringify($)},R=(w,$)=>C(A=>A[w]=$),S=w=>C($=>{delete $[w]}),W=(w,$)=>{$&&R("zone",$.key)},T=w=>{w?R("order",w):S("order")},G=w=>{w?R("size",`${w}`):S("size")},te=w=>{w?R("width",`${w}px`):S("width")},ce=w=>{w?R("height",`${w}px`):S("height")},{zone:re,order:I,size:j,width:P,height:p}=JSON.parse(i[v]);return t.createElement("div",{key:v},t.createElement(Xt,null,"Box"),t.createElement(La,{label:"Zone",options:E,defaultSelectedKey:re,onChange:W}),t.createElement(bt,{defaultValue:I!=null?I:0,label:"Order:",min:0,max:25,step:1,onChange:T}),t.createElement(bt,{defaultValue:j?N.parseU(j):0,label:"Size:",min:0,max:25,step:1,onChange:G}),t.createElement(bt,{defaultValue:P?kn(P):0,label:"Width (px):",min:0,max:1e4,step:10,onChange:te}),t.createElement(bt,{defaultValue:p?kn(p):0,label:"Height (px):",min:0,max:1e4,step:10,onChange:ce}),t.createElement(Xt,null,"Properties"))}}});return t.createElement(Ra,{headerText:r?"Add card":"Edit card",isOpen:!0,isLightDismiss:!0,onDismiss:d,onRenderFooterContent:y,isFooterAtBottom:!0},t.createElement(Xt,null,Wt(e)," Card"),r?t.createElement(Ie,{label:"Card Name",defaultValue:c,onChange:h}):null,t.createElement("div",null,_))}}}),Xd=V(({title:e,text:a,acceptCaption:n,cancelCaption:r,onAccept:l})=>{const i=N.box(!1),o=()=>{i(!0)},s=()=>{l(),i(!0)};return{render:()=>t.createElement(Jt,{hidden:i(),onDismiss:o,dialogContentProps:{type:lt.normal,title:e,subText:a},modalProps:{styles:{main:{maxWidth:450}}}},t.createElement(Sn,null,t.createElement(Ue,{onClick:o,text:r}),t.createElement(Oe,{onClick:s,text:n}))),hiddenB:i}}),mi=V(({pageSetupB:e})=>{const a=e(),n=ka.map(({name:o})=>({key:o,text:o})),r=(o,s)=>{if(!s)return;const c=ka.find(d=>d.name===s.key);c&&(a.layoutDef=c,e(L({},a)))},l=o=>{a.width=o,e(L({},a))};return{render:()=>t.createElement(t.Fragment,null,t.createElement(La,{label:"Page Layout",options:n,defaultSelectedKey:a.layoutDef.name,onChange:r}),t.createElement(bt,{defaultValue:a.width,label:"Page Width:",min:0,max:4e3,step:50,onChange:l}))}}),Ud=V(({visibleB:e})=>{const a=N.box({layoutDef:Ln,width:0}),n=()=>{const{layoutDef:i,width:o}=a(),s=L({},i.layout),c=x.fork();o&&(s.width=`${o}px`),c.put("__editor__",{view:"editor",box:"",mode:"public"}),c.put("__meta__",{view:"meta",box:"",layouts:[s]}),c.push()},r=()=>{e(!1)};return{render:()=>t.createElement(Jt,{hidden:!e(),onDismiss:r,dialogContentProps:{type:lt.largeHeader,title:"Edit this page?",subText:"Don't worry, you can always change these settings later."},modalProps:{isBlocking:!1,styles:{main:{maxWidth:450}}}},t.createElement(mi,{pageSetupB:a}),t.createElement(Sn,null,t.createElement(Ue,{onClick:r,text:"Back to safety"}),t.createElement(Oe,{onClick:n,text:"Start Editing"}))),visibleB:e}}),Gd=()=>{const e=Ca();return e&&e.t===N.WaveEventType.Page?e.page:null},qd=V(({name:e,changed:a})=>{const n=()=>{Ae(vl)},r=()=>{Ae(Ot)};return{render:()=>{let i=null;const o=Ae();switch(o.t){case yt.Add:i=t.createElement(Ar,{view:o.view});break;case yt.Edit:{const s=Gd();if(s){const{name:c}=o,d=s.get(c);d&&(i=t.createElement(Ar,{view:d.state.view,card:d}))}}break;case yt.Delete:{const{name:s}=o,c=()=>{const d=x.fork();d.del(s),d.push()};i=t.createElement(Xd,{key:N.xid(),title:"Delete Card?",text:"This card will be permanently deleted.",acceptCaption:"Delete Card",cancelCaption:"Don't delete",onAccept:c})}break;case yt.Pick:{const s=di(),c=N.box({layoutDef:Od(s),width:s.width?kn(s.width):0}),d=ii.map(({view:g,icon:h})=>{const y=()=>{Ae({t:yt.Add,view:g})};return t.createElement("div",{key:g,className:Lt.card,onClick:y},t.createElement("div",{className:Lt.cardIcon},t.createElement(it,{iconName:h})),t.createElement("div",{className:Lt.cardCaption},Wt(g)))}),m=()=>{const g=x.fork(),{layoutDef:h,width:y}=c(),k=L({},h.layout);y&&(k.width=`${y}px`),g.set("__meta__ layouts",[k]),g.push()},u=()=>t.createElement(Re,{horizontal:!0,tokens:{childrenGap:10}},t.createElement(Oe,{onClick:m},"Apply changes"));i=t.createElement(Ra,{headerText:"Edit this page",isLightDismiss:!0,onDismiss:r,isOpen:!0,onRenderFooterContent:u,isFooterAtBottom:!0},t.createElement(Xt,null,"Add Content"),t.createElement("div",{className:Lt.cards},d),t.createElement(Xt,null,"Page Setup"),t.createElement(mi,{key:N.xid(),pageSetupB:c}))}break}return t.createElement(t.Fragment,null,t.createElement("div",{"data-test":e,className:Lt.fab,onClick:n},t.createElement(it,{iconName:"WindowEdit"})),i)},changed:a,editorActionB:Ae}});Q.register("editor",qd);const Qd=e=>{const a={display:"flex"},n=So[e.direction||""],r=Dn[e.justify||""],l=hl[e.align||""],i=yl[e.wrap||""];return n&&(a.flexDirection=n),r&&(a.justifyContent=r),l&&(a.alignItems=l),i&&(a.flexWrap="wrap",a.alignContent=i),a},Kd=V(({name:e,state:a,changed:n})=>({render:()=>t.createElement("div",{"data-test":e,style:Qd(a)},t.createElement(Rn,{view:a.item_view,props:a.item_props,data:a.data})),changed:n}));Q.register("flex",Kd);const an=F({card:{display:"flex",justifyContent:"space-between",padding:24},center:{margin:"0 auto",$nest:{".wave-markdown":{textAlign:"center"}}},caption:{$nest:{".wave-markdown>*:first-child":{marginTop:0}}}}),Yd=V(({name:e,state:a,changed:n})=>({render:()=>{const{caption:l,items:i}=a;return t.createElement("div",{"data-test":e,className:an.card},t.createElement("div",{className:M("wave-s13",an.caption,i?"":an.center)},t.createElement(Pe,{source:l})),i&&t.createElement(Ee,{items:i}))},changed:n}));Q.register("footer",Yd,{effect:et.Transparent,marginless:!0});const Jd=e=>{const a=e._t||"u",n={};delete e._t;for(const r in e)n[r.replace(/_./g,l=>l.substring(1).toUpperCase())]=e[r];return[a,n]},nn=(e,a)=>{const n=[];for(const r of a)n.push(e[r]);for(const r of a)delete e[r];return n},de=e=>e.split(/\s/g).map(a=>+a),ut=(e,a,n)=>{const r=e.length,l=new Array(r);for(let i=0;i<r;i++)l[i]=n(e[i],a[i]);return l},ga=(e,a,n,r)=>{const l=e.length,i=new Array(l);for(let o=0;o<l;o++)i[o]=r(e[o],a[o],n[o]);return i},Zd={basis:Zi,"basis-closed":eo,"basis-open":to,cardinal:ao,"cardinal-closed":no,"cardinal-open":ro,smooth:ol,"smooth-closed":lo,"smooth-open":io,linear:Ia,"linear-closed":oo,"monotone-x":so,"monotone-y":co,natural:mo,step:sl,"step-after":cl,"step-before":dl},pa=()=>0,Ge=e=>e[0],qe=e=>e[1],fa=e=>e[2],em=F({card:{position:"absolute",left:se.gap,top:se.gap,right:se.gap,bottom:se.gap}}),tm=V(({name:e,state:a,changed:n})=>{const r=(i,o)=>{const[s,c]=Jd(i);switch(s){case"a":{const[d,m,u,g]=nn(c,["r1","r2","a1","a2"]),h=Ea()({innerRadius:d,outerRadius:m,startAngle:u*Math.PI/180,endAngle:g*Math.PI/180});return t.createElement("path",Z(L({key:o},c),{d:h}))}case"c":return t.createElement("circle",L({key:o},c));case"e":return t.createElement("ellipse",L({key:o},c));case"i":return t.createElement("image",L({key:o},c));case"l":return t.createElement("line",L({key:o},c));case"p":return t.createElement("path",L({key:o},c));case"pg":return t.createElement("polygon",L({key:o},c));case"pl":return t.createElement("polyline",L({key:o},c));case"r":return t.createElement("rect",L({key:o},c));case"s":{const[d,m,u,g,h,y]=nn(c,["x","y","x0","y0","curve","radial"]),k=Zd[h]||Ia,_=y?g===""?ia().angle(Ge).outerRadius(qe).innerRadius(pa).curve(k)(ut(de(d),de(m),(b,v)=>[b,v])):g?ia().angle(Ge).outerRadius(fa).innerRadius(qe).curve(k)(ga(de(d),de(g),de(m),(b,v,E)=>[b,v,E])):u===""?ia().endAngle(Ge).startAngle(pa).radius(qe).curve(k)(ut(de(d),de(m),(b,v)=>[b,v])):u?ia().endAngle(qe).startAngle(Ge).radius(fa).curve(k)(ga(de(u),de(d),de(m),(b,v,E)=>[b,v,E])):Ji().curve(k)(ut(de(d),de(m),(b,v)=>[b,v])):g===""?Bt().x(Ge).y1(qe).y0(pa).curve(k)(ut(de(d),de(m),(b,v)=>[b,v])):g?Bt().x(Ge).y1(fa).y0(qe).curve(k)(ga(de(d),de(g),de(m),(b,v,E)=>[b,v,E])):u===""?Bt().x1(Ge).x0(pa).y(qe).curve(k)(ut(de(d),de(m),(b,v)=>[b,v])):u?Bt().x1(qe).x0(Ge).y(fa).curve(k)(ga(de(u),de(d),de(m),(b,v,E)=>[b,v,E])):il().curve(k)(ut(de(d),de(m),(b,v)=>[b,v]));return t.createElement("path",Z(L({key:o},c),{d:_}))}case"t":{const[d]=nn(c,["text"]);return t.createElement("text",L({key:o},c),d)}default:return t.createElement("use",L({key:o},c))}};return{render:()=>{const{view_box:i,width:o,height:s,stage:c,scene:d}=a,m=c?N.unpack(c).map(r):[],u=d?N.unpack(d).map(({d:g,o:h},y)=>r(L(L({},g?JSON.parse(g):{}),h?JSON.parse(h):{}),y)):[];return t.createElement("div",{"data-test":e,className:em.card},t.createElement("svg",{viewBox:i,width:o,height:s},t.createElement("g",null,m),t.createElement("g",null,u)))},changed:n}});Q.register("graphics",tm);const rn=F({card:{display:"flex",flexDirection:"column"},body:{flexGrow:1,overflow:"auto",$nest:{">*":{borderBottom:"1px solid var(--text1)",padding:"5px 0"}}},table:{width:"100%"}}),am=V(({name:e,state:a,changed:n})=>({render:()=>{let l=N.unpack(a.cells);Array.isArray(l)||(l=[{title:"Data"}]);const i=l.map((c,d)=>t.createElement("th",{key:d},c.title)),o=l.map(({view:c,props:d,value:m})=>({view:c,props:N.unpack(d),value:m})),s=N.unpack(a.data).map((c,d)=>{const m=o.map(({view:u,props:g,value:h},y)=>{if(h!=null)return t.createElement("td",null,t.createElement(ne,{data:c,format:h}));{const k={name:N.xid(),state:Z(L({},g),{view:u,data:c}),changed:N.box()};return t.createElement("td",null,t.createElement(aa,{key:y,card:k}))}});return t.createElement("tr",{key:d},m)});return t.createElement("div",{"data-test":e,className:rn.card},t.createElement("div",{className:"wave-s12 wave-w6"},a.title||"Untitled"),t.createElement("div",{className:rn.body},t.createElement("table",{className:rn.table},t.createElement("thead",null,t.createElement("tr",null,i)),t.createElement("tbody",null,s))))},changed:n}));Q.register("grid",am);const at=F({card:{display:"flex",flexDirection:"column"},title:{color:f("$themePrimary")},icon:{fontSize:56,display:"flex",justifyContent:"center"},header:{padding:be(24,24,0),textAlign:"center"},img:{maxHeight:100},brand:{marginBottom:10},secondaryItems:{padding:24},persona:{$nest:{".ms-Persona":{flexDirection:"column",height:"auto"},".ms-Persona-details":{alignItems:"center",padding:0},".ms-Persona-primaryText":{fontWeight:500,marginTop:12}}}}),ui=({items:e,value:a,hideNav:n})=>{const r=e.map(l=>({name:l.label,collapseByDefault:l.collapsed,links:l.items.map(({name:i,label:o,icon:s,disabled:c,tooltip:d})=>({key:i,name:o,icon:s,disabled:c,title:d,style:c?{opacity:.7}:void 0,url:"",onClick:()=>{if(n&&n(),i.startsWith("#")){window.location.hash=i.substring(1);return}x.args[i]=!0,x.push()}}))}));return t.createElement(uo,{groups:r,selectedKey:a,styles:{groupContent:{marginBottom:0}}})},nm=V(({name:e,state:a,changed:n})=>({render:()=>{const{title:l,subtitle:i,icon:o,color:s="card",icon_color:c=s==="primary"?"$card":"$text",image:d,persona:m,secondary_items:u}=a;return t.createElement("div",{"data-test":e,className:M(In(_l(s)),at.card),style:{background:f(`$${s}`)}},t.createElement("div",{className:at.header},(d||o)&&t.createElement("div",{className:at.brand},d&&t.createElement("img",{src:d,className:at.img}),o&&!d&&t.createElement($e,{iconName:o,className:at.icon,style:{color:f(c)}})),l&&t.createElement("div",{className:M("wave-s24 wave-w6",s==="card"?"wave-p9":"wave-c9")},l),i&&t.createElement("div",{className:M("wave-s13",s==="card"?"wave-t8":"wave-c8")},i),!d&&!o&&(m==null?void 0:m.persona)&&t.createElement("div",{className:at.persona},t.createElement(na,{model:m.persona}))),t.createElement(ui,L({},a)),u&&t.createElement("div",{className:at.secondaryItems,style:{marginTop:a.items.length?"auto":"initial"}},t.createElement(Ee,{items:u})))},changed:n}));Q.register("nav",nm,{effect:et.Flat,marginless:!0});const Be=F({card:{position:"relative",display:"flex",alignItems:"center",justifyContent:"space-between",padding:be(10,15),$nest:{".ms-layer":{display:"none"}}},inline:{display:"flex",alignItems:"center",cursor:"default",zIndex:1},center:Z(L({},Je()),{position:"absolute",top:0,left:0,bottom:0,right:0}),burger:L({cursor:"pointer",fontSize:ye(ge(24)),width:25,height:40},Je()),logo:{width:56,height:56,marginRight:15,borderRadius:2,cursor:"pointer"},icon:{fontSize:36,marginRight:15,display:"flex"},title:{color:f("$themePrimary")},nudgeUp:{marginTop:-5}}),rm=V(({items:e,isOpenB:a})=>{const n=()=>a(!1);return{render:()=>t.createElement(Ra,{isLightDismiss:!0,type:ll.smallFixedNear,isOpen:a(),onDismiss:n,hasCloseButton:!1},t.createElement(ui,{items:e,hideNav:n})),isOpenB:a}}),lm=V(({name:e,state:a,changed:n})=>{const r=N.box(!1),l=()=>r(!0),i=()=>window.location.hash="";return{render:()=>{const{title:s,subtitle:c,icon:d,color:m="primary",icon_color:u=m==="primary"?"$card":"$text",nav:g,items:h,image:y,secondary_items:k}=a;return t.createElement("div",{"data-test":e,className:M(Be.card,In(_l(m))),style:{background:m==="transparent"?"transparent":f(`$${m}`)}},t.createElement("div",{className:Be.inline},g&&t.createElement($e,{onClick:l,className:M(Be.icon,Be.burger),iconName:"GlobalNavButton",style:{color:f(u)}}),y&&t.createElement(go,{src:y,className:Be.logo,imageFit:po.centerCover,onClick:i}),d&&!y&&t.createElement($e,{className:Be.icon,iconName:d,style:{color:f(u)}}),t.createElement("div",{className:Be.nudgeUp},t.createElement("div",{className:M(m!=="primary"?Be.title:"","wave-s24 wave-w5")},s),c&&t.createElement("div",{className:M(Be.nudgeUp,"wave-s12")},c))),k&&t.createElement("div",{className:Be.center},t.createElement(En,{model:{items:k}})),h&&t.createElement("div",{style:{zIndex:1,marginRight:a.commands?30:void 0}},t.createElement(En,{model:{items:h}})),g&&t.createElement(rm,{items:g,isOpenB:r}))},changed:n}});Q.register("header",lm,{effect:et.Transparent,marginless:!0});const ln=F({body:{position:"relative"},rail:{position:"absolute",width:"100%",opacity:.15},bar:{position:"absolute"}}),gi=({thickness:e,color:a,value:n})=>t.createElement("div",{className:ln.body,style:{height:e}},t.createElement("div",{className:ln.rail,style:{height:e,backgroundColor:a}}),t.createElement("div",{className:ln.bar,style:{width:`${Math.round(n*100)}%`,height:e,backgroundColor:a}})),At=F({card:{display:"flex",flexDirection:"column",justifyContent:"space-between",padding:se.gap},values:{display:"flex",justifyContent:"space-between"},aux_value:{color:"var(--text7)"},caption:{color:"var(--text5)"},captions:{display:"flex",justifyContent:"space-between",color:"var(--text7)"}}),im=V(({name:e,state:a,changed:n})=>({render:()=>{const l=N.unpack(a.data);return t.createElement("div",{"data-test":e,className:At.card},t.createElement(ne,{data:l,format:a.title,className:"wave-s12 wave-w6"}),t.createElement(ne,{data:l,format:a.caption,className:M(At.caption,"wave-s13")}),t.createElement("div",null,t.createElement("div",{className:M(At.values,"wave-s18 wave-w3")},t.createElement("div",null,t.createElement(ne,{data:l,format:a.value})),t.createElement(ne,{data:l,format:a.aux_value,className:At.aux_value})),t.createElement(gi,{thickness:2,color:f(a.plot_color),value:a.progress}),t.createElement("div",{className:M(At.captions,"wave-s12")},t.createElement("div",null,t.createElement(ne,{data:l,format:a.value_caption})),t.createElement("div",null,t.createElement(ne,{data:l,format:a.aux_value_caption})))))},changed:n}));Q.register("large_bar_stat",im);const ha=F({card:{display:"flex",flexDirection:"column",padding:15},values:{display:"flex",alignItems:"baseline"},aux_value:{marginLeft:5,color:"var(--text6)"},caption:{color:"var(--text5)"}}),om=V(({name:e,state:a,changed:n})=>({render:()=>t.createElement("div",{"data-test":e,className:ha.card},t.createElement(ne,{data:a.data,format:a.title,className:"wave-s12 wave-w6"}),t.createElement("div",{className:ha.values},t.createElement(ne,{data:a.data,defaultValue:a.value,format:a.value,className:"wave-s40 wave-w2"}),t.createElement(ne,{data:a.data,format:a.aux_value,className:ha.aux_value})),t.createElement(ne,{data:a.data,format:a.caption,className:M(ha.caption,"wave-s13")})),changed:n}));Q.register("large_stat",om);const Rr=F({card:{display:"flex",flexDirection:"column"},body:{flexGrow:1,overflow:"auto",$nest:{">*":{borderBottom:"1px solid var(--text1)",padding:"5px 0"}}}}),sm=V(({name:e,state:a,changed:n})=>({render:()=>t.createElement("div",{"data-test":e,className:Rr.card},t.createElement("div",{className:"wave-s12 wave-w6"},a.title),t.createElement("div",{className:Rr.body},t.createElement(Rn,{view:a.item_view,props:a.item_props,data:a.data}))),changed:n}));Q.register("list",sm);const Rt=F({item:{display:"flex",justifyContent:"space-between"},left:{flexDirection:"column"},right:{flexDirection:"column"},caption:{color:f("text5")},aux_value:{color:f("text5")}}),cm={title:"Untitled"},dm=V(({name:e,state:a,changed:n})=>({render:()=>{const l=L(L({},cm),a),i=N.unpack(l.data);return t.createElement("div",{"data-test":e,className:Rt.item},t.createElement("div",{className:Rt.left},t.createElement(ne,{data:i,format:l.title,className:"wave-s12 wave-w6"}),t.createElement(ne,{data:i,format:l.caption,className:M(Rt.caption,"wave-s13")})),t.createElement("div",{className:Rt.right},t.createElement(ne,{data:i,format:l.value,className:"wave-s12"}),t.createElement(ne,{data:i,format:l.aux_value,className:M(Rt.aux_value,"wave-s13")})))},changed:n}));Q.register("list_item1",dm);const mm=V(({name:e,state:a,changed:n})=>({render:()=>t.createElement("div",{"data-test":e},t.createElement("pre",null,JSON.stringify(a,null,2))),changed:n}));Q.register("",mm);const Kt=20,Ir=Kt*16,um="#ffffff #bfbfbf #808080 #404040 #000000 #6699ff #3366cc #003399 #99cc33 #00cc00 #669900 #ffcc00 #ff9900 #ff6600 #cc0000".split(/\s+/g),gt=F({card:{display:"flex",flexDirection:"column",padding:se.gap},canvas:{display:"flex",flexWrap:"wrap",width:Ir,height:Ir},swatches:{paddingTop:10,marginTop:15,borderTop:"1px solid #ccc"},pixel:{display:"inline-block",width:Kt,height:Kt}}),gm=e=>{const a=Math.floor(e/16),n=e%16,r=n%2===1;return a%2===0?r?"#fff":"#ddd":r?"#ddd":"#fff"},pm=V(({name:e,state:a,changed:n})=>{let r="#000";const l=o=>{const s=x.fork();s.set(`${e} data ${o}`,r==="none"?null:[r]),s.push()};return{render:()=>{const o=N.unpack(a.data),s=um.map((d,m)=>t.createElement("div",{key:m,className:gt.pixel,style:{backgroundColor:d},onClick:()=>r=d})),c=o.map((d,m)=>{const u=d?d.color:gm(m);return t.createElement("div",{key:m,className:gt.pixel,style:{backgroundColor:u},onClick:()=>l(m)})});return t.createElement("div",{"data-test":e,className:gt.card},t.createElement("div",{className:"wave-s12 wave-w6"},a.title),t.createElement("div",{className:gt.canvas},c),t.createElement("div",{className:gt.swatches},t.createElement("div",{className:gt.pixel},t.createElement("svg",{onClick:()=>r="none",viewBox:"0 0 433.25 433.25",width:Kt,height:Kt},t.createElement("path",{d:"M418.4,192.331c19.8-19.8,19.8-51.9,0-71.7l-0.1-0.1l-78.6-78.3c-19.8-19.8-51.9-19.7-71.8,0l-169.5,169.6l-54.2,54.1 c-19.8,19.7-19.8,51.8-0.1,71.6l48.3,48.3H10c-5.5,0-10,4.5-10,10s4.5,10,10,10h297.4c5.5,0,10-4.5,10-10s-4.5-10-10-10H225 l23.9-23.7L418.4,192.331z M196.7,385.831h-76.1l-62.3-62.4c-12-12-11.9-31.4,0-43.4l47.1-47l122.2,122L196.7,385.831z M119.6,218.931l162.5-162.5c12-12,31.5-12,43.5,0l78.6,78.4c12,12,12,31.4,0,43.5l-162.4,162.8L119.6,218.931z"}))),s))},changed:n}});Q.register("pixel_art",pm);const pi=2,It=F({card:{display:"flex",flexDirection:"column"},content:{padding:gl},img:{flexGrow:1,minHeight:150,backgroundSize:"cover",backgroundRepeat:"no-repeat",backgroundPosition:"center"},persona:{marginBottom:16,$nest:{".ms-Persona":{flexDirection:"column",height:"auto"},".ms-Persona-image":{border:xe(pi,f("$neutralTertiary"))},".ms-Persona-details":{alignItems:"center",padding:0},".ms-Persona-primaryText":{fontWeight:500,marginTop:12,color:f("$neutralPrimary")}}},items:{marginTop:16}}),fm=V(({name:e,state:a,changed:n})=>{const r=({size:i="m"})=>{const o=-gl-pi;switch(i){case"xs":return o-24;case"s":return o-28;case"m":return o-36;case"l":return o-50;case"xl":return o-60}};return{render:()=>{const{image:i,persona:o,items:s,height:c}=a;return t.createElement("div",{"data-test":e,className:It.card},t.createElement("div",{className:It.img,style:{backgroundImage:`url('${i}')`}}),t.createElement("div",{className:It.content,style:{height:c}},o.persona&&t.createElement("div",{className:It.persona,style:{marginTop:r(o.persona)}},t.createElement(na,{model:o.persona})),s&&t.createElement("div",{className:It.items},t.createElement(Ee,{items:s}))))},changed:n}});Q.register("profile",fm);const pt=F({card:{display:"flex",flexDirection:"column"},header:{display:"flex",justifyContent:"space-between",alignItems:"flex-end",padding:24,paddingBottom:16,marginTop:-4,$nest:{".ms-Persona-primaryText":{fontSize:16,lineHeight:ge(22),fontWeight:500},".ms-Persona-secondaryText":{fontSize:14,lineHeight:ge(20),color:f("$text7")},".ms-Persona-image":{height:"40px !important",width:"40px !important"},".ms-Persona-imageArea":{height:"40px !important",width:"40px !important"}}},aux_value:{marginBottom:5},content:{padding:24,paddingTop:16},img:{flexGrow:1,backgroundSize:"cover",backgroundRepeat:"no-repeat",backgroundPosition:"center"},items:{marginTop:12}}),hm=V(({name:e,state:a,changed:n})=>({render:()=>{const{persona:l,image:i,aux_value:o,caption:s,items:c}=a;return l.persona&&(l.persona.size="xs"),t.createElement("div",{"data-test":e,className:pt.card},t.createElement("div",{className:pt.header},l.persona&&t.createElement(na,{model:l.persona}),o&&t.createElement("div",{className:M("wave-s12 wave-t7",pt.aux_value)},o)),t.createElement("div",{className:pt.img,style:{backgroundImage:`url('${i}')`}}),(s||c)&&t.createElement("div",{className:pt.content},s&&t.createElement("div",{className:"wave-s14 wave-w4 wave-t7"},s),c&&t.createElement("div",{className:pt.items},t.createElement(Ee,{items:c}))))},changed:n}));Q.register("post",hm);const zt=F({card:{display:"flex",flexDirection:"column",justifyContent:"space-between",backgroundSize:"cover",backgroundRepeat:"no-repeat",backgroundPosition:"center"},clickable:{cursor:"pointer"},header:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:8},content:{padding:24,paddingBottom:0,color:f("$text")},items:{$nest:{"& .ms-Icon, & .ms-Button-label":{color:f("$text")}}}}),ym=V(({name:e,state:a,changed:n})=>({render:()=>{const{image:l,title:i,name:o,label:s,caption:c,items:d}=a,m=()=>{if(o.startsWith("#")){window.location.hash=o.substring(1);return}x.args[o]=o,x.push()};return t.createElement("div",{"data-test":e,onClick:o&&!s?m:void 0,className:M(zt.card,o&&!s?zt.clickable:""),style:{backgroundImage:`url('${l}')`}},t.createElement("div",{className:zt.content,style:{background:f("$card7"),boxShadow:`0px 6px 30px 30px ${f("$card7")}`}},t.createElement("div",{className:zt.header},i&&t.createElement("div",{className:"wave-s20 wave-w6"},i),d&&t.createElement("div",{className:zt.items},t.createElement(Ee,{items:d}))),c&&t.createElement("div",{className:"wave-s14 wave-t8"},c)),s&&t.createElement(Oe,{onClick:m,text:s,styles:{root:{margin:"0 24px 24px 0",alignSelf:"flex-end"}}}))},changed:n}));Q.register("preview",ym);const vm=V(({name:e,state:a,changed:n})=>({render:()=>t.createElement("div",{"data-test":e},t.createElement(Rn,{view:a.item_view,props:a.item_props,data:a.data})),changed:n}));Q.register("repeat",vm);const on=F({card:{display:"flex",paddingTop:5},rhs:{flexGrow:1,marginLeft:15},subtitle:{$nest:{">div>p":{margin:0}}}}),xm=V(({name:e,state:a,changed:n})=>({render:()=>{const{title:l,subtitle:i,items:o}=a,s=N.unpack(o),c=o&&t.createElement("div",{className:on.rhs},t.createElement(Ee,{items:s,alignment:"end"}));return t.createElement("div",{"data-test":e,className:on.card},t.createElement("div",null,t.createElement("div",{className:"wave-s14 wave-w6"},l),t.createElement("div",{className:M(on.subtitle,"wave-s12")},t.createElement(Pe,{source:i}))),c)},changed:n}));Q.register("section",xm,{effect:et.Transparent});const bm={linear:Ia,smooth:ol,step:sl,"step-after":cl,"step-before":dl},Em=F({container:{width:"100%",height:"100%",position:"relative",flexGrow:1,minHeight:32}}),Hn=({value:e,color:a,data:n,zeroValue:r,curve:l})=>{const i=t.useRef(null),[o,s]=t.useMemo(()=>{let[g,h]=ml(n,y=>y[e]);return r!=null&&(g=Math.min(r,g),h=Math.max(r,h)),[g,h]},[n,e,r]),[c,d]=t.useState(null),m=t.useCallback(()=>{if(!i.current)return;const{width:g,height:h}=i.current.getBoundingClientRect();if(!h){setTimeout(m,300);return}const y=un().domain([0,n.length-1]).range([0,g]),k=un().domain([o,s]).range([h,2]),_=bm[l]||Ia,b=il().defined(E=>E&&E[e]!=null).x((E,C)=>y(C)).y(E=>k(E[e])).curve(_),v=Bt().defined(E=>E&&E[e]!=null).x((E,C)=>y(C)).y0(E=>k(r==null?o:r)).y1(E=>k(E[e])).curve(_);d(t.createElement("svg",{viewBox:`0 0 ${g} ${h}`,style:{position:"absolute",top:0,left:0,right:0,bottom:0}},t.createElement("path",{d:v(n),fill:a,fillOpacity:"0.1",strokeLinejoin:"round",strokeLinecap:"round"}),t.createElement("path",{d:b(n),fill:"none",stroke:a,strokeWidth:"1.5",strokeLinejoin:"round",strokeLinecap:"round"})))},[a,l,n,s,o,e,r]),u=St(1e3,m);return t.useEffect(()=>(window.addEventListener("resize",u),()=>window.removeEventListener("resize",u)),[]),t.useLayoutEffect(m,[e,a,n,r,l,o,s,m]),t.createElement("div",{ref:i,className:Em.container},c)},wm=F({container:{width:"100%",height:"100%",position:"relative",flexGrow:1,minHeight:32}}),On=({value:e,category:a="x",color:n,data:r,zeroValue:l})=>{const i=t.useRef(null),[o,s]=t.useState(null),[c,d]=t.useMemo(()=>{let[g,h]=ml(r,y=>y[e]);return l!=null&&(g=Math.min(l,g),h=Math.max(l,h)),[g,h]},[r,e,l]),m=t.useCallback(()=>{if(!i.current)return;const{width:g,height:h}=i.current.getBoundingClientRect();if(!h){setTimeout(m,300);return}const y=fo().domain(r.map(b=>b[a])).range([0,g]).paddingInner(.1),k=un().domain([c,d]).range([h,0]),_=r.map((b,v)=>{const E=y(b[a]),C=k(b[e]);return t.createElement("rect",{key:v,fill:n,x:E,y:C,width:2,height:h-C})});s(t.createElement("svg",{viewBox:`0 0 ${g} ${h}`,style:{position:"absolute",top:0,left:0,right:0,bottom:0}},_))},[a,n,r,d,c,e]),u=St(1e3,m);return t.useEffect(()=>(window.addEventListener("resize",u),()=>window.removeEventListener("resize",u)),[]),t.useLayoutEffect(m,[e,a,n,r,l,c,d,m]),t.createElement("div",{ref:i,className:wm.container},o)},zr=F({card:{display:"flex",flexDirection:"column"},text:{display:"flex",justifyContent:"space-between",padding:be(8,se.gap)}}),km=V(({name:e,state:a,changed:n})=>({render:()=>{const l=N.unpack(a.data),i=a.plot_type==="interval"?t.createElement(On,{data:N.unpack(a.plot_data),category:a.plot_category,value:a.plot_value,color:f(a.plot_color),zeroValue:a.plot_zero_value}):t.createElement(Hn,{data:N.unpack(a.plot_data),value:a.plot_value,color:f(a.plot_color),zeroValue:a.plot_zero_value,curve:a.plot_curve||"linear"});return t.createElement("div",{"data-test":e,className:zr.card},t.createElement("div",{className:zr.text},t.createElement(ne,{data:l,format:a.title||"Untitled",className:"wave-s12 wave-w6"}),t.createElement(ne,{data:l,format:a.value,className:"wave-s12"})),i)},changed:n}));Q.register("small_series_stat",km);const Br=F({card:{display:"flex",flexDirection:"column",padding:se.gap},value:{lineHeight:"28px"}}),Cm=V(({name:e,state:a,changed:n})=>({render:()=>{const l=N.unpack(a.data);return t.createElement("div",{"data-test":e,className:Br.card},t.createElement(ne,{data:l,format:a.title,className:"wave-s12 wave-w6"}),t.createElement(ne,{data:l,format:a.value,className:M(Br.value,"wave-s24 wave-w3")}))},changed:n}));Q.register("small_stat",Cm);const Me=F({card:{display:"flex",flexDirection:"column",padding:15},items:{overflow:"auto",flexGrow:1,marginTop:"1em"},item:{display:"flex",justifyContent:"space-between",borderBottom:"1px solid #ddd",padding:"0.5em 0",$nest:{"&:last-child":{borderBottom:"none"}}},icon:{padding:"0.2em 0.5em 0em 0.1em"},lhs:{flexGrow:1},rhs:{textAlign:"right"},caption:{opacity:.7},auxValue:{opacity:.7},clickable:{cursor:"pointer",$nest:{"&:hover":{backgroundColor:"#fafafa"}}}}),$m=V(({name:e,state:a,changed:n})=>({render:()=>{const{name:l,title:i,subtitle:o,items:s}=a,c=s.map(({name:d,label:m,caption:u,value:g,value_color:h,aux_value:y,icon:k,icon_color:_},b)=>{const v=d?()=>bl(l,d):void 0;return t.createElement("div",{key:d!=null?d:`${b}:${m}`,className:v?M(Me.item,Me.clickable):Me.item,onClick:v},k&&t.createElement("div",{className:Me.icon,style:_?{color:f(_)}:void 0},t.createElement(it,{iconName:k})),t.createElement("div",{className:Me.lhs},t.createElement("div",{className:"wave-s12 wave-w6"},m),u&&t.createElement("div",{className:M(Me.caption,"wave-s12")},u)),t.createElement("div",{className:Me.rhs},g&&t.createElement("div",{className:"wave-s13 wave-w6",style:h?{color:f(h)}:void 0},g),y&&t.createElement("div",{className:M(Me.auxValue,"wave-s12")},y)))});return t.createElement("div",{"data-test":e,className:Me.card},t.createElement("div",{className:"wave-s12 wave-w6"},i),o&&t.createElement("div",{className:"wave-s12"},o),t.createElement("div",{className:Me.items},c))},changed:n}));Q.register("stat_list",$m);const Qe=F({card:{display:"flex",flexDirection:"column",padding:15,overflow:"auto"},items:{flexGrow:1,overflow:"auto",marginTop:"1em"},table:{borderSpacing:0,width:"100%",$nest:{tbody:{$nest:{th:{borderTop:"1px solid #ddd",textAlign:"left",padding:"0.5em 1em 0.5em 0"},td:{borderTop:"1px solid #ddd",padding:"0.5em 0 0.5em 1em"}}},td:{textAlign:"right",verticalAlign:"top"}}},thead:{opacity:.4,$nest:{th:{textAlign:"right",width:"1%",whiteSpace:"nowrap",padding:"0.5em 0 0.5em 1em"},"th:first-child":{textAlign:"left",width:"100%",padding:"0.5em 1em 0.5em 0"}}},header:{display:"flex"},caption:{opacity:.7},icon:{padding:"0.2em 0.5em 0em 0.1em"},clickable:{cursor:"pointer",$nest:{"&:hover":{backgroundColor:f("$themeLighter"),color:f("$themeDarker")}}}}),Nm=V(({name:e,state:a,changed:n})=>({render:()=>{const{name:l,title:i,columns:o,subtitle:s,items:c}=a,d=o.map((u,g)=>t.createElement("th",{key:`${g}:${u}`},u)),m=c.map(({name:u,label:g,values:h,caption:y,icon:k,icon_color:_,colors:b},v)=>{const E=u?()=>bl(l,u):void 0,C=h.map((R,S)=>t.createElement("td",{key:`${S}:${R}`,style:b&&b[S]?{color:f(b[S])}:void 0},R));return t.createElement("tr",{key:u!=null?u:`${v}:${g}`,className:E?Qe.clickable:void 0,onClick:E},t.createElement("th",{key:"label"},t.createElement("div",{className:Qe.header},k&&t.createElement("div",{className:Qe.icon,style:_?{color:f(_)}:void 0},t.createElement(it,{iconName:k})),t.createElement("div",null,t.createElement("div",{className:"wave-w6"},g),y&&t.createElement("div",{className:M(Qe.caption,"wave-s12 wave-w4")},y)))),C)});return t.createElement("div",{"data-test":e,className:Qe.card},t.createElement("div",{className:"wave-s12 wave-w6"},i),s&&t.createElement("div",{className:"wave-s12"},s),t.createElement("div",{className:Qe.items},t.createElement("table",{className:M(Qe.table,"wave-s13")},t.createElement("thead",{className:M(Qe.thead,"wave-w6")},t.createElement("tr",null,d)),t.createElement("tbody",null,m))))},changed:n}));Q.register("stat_table",Nm);const Sm=F({card:{display:"flex",flexDirection:"column",justifyContent:"center",minHeight:46}}),_m=V(({name:e,state:a,changed:n})=>{const r=i=>{const o=i==null?void 0:i.props.itemKey;if(!!o){if(o.startsWith("#")){window.location.hash=o.substring(1);return}a.name?x.args[a.name]=o:x.args[o]=!0,x.push()}};return{render:()=>{const i=a.link?"links":"tabs",o=a.items.map(({name:s,label:c,icon:d})=>t.createElement(al,{key:s,itemKey:s,headerText:c,itemIcon:d}));return t.createElement("div",{"data-test":e,className:Sm.card},t.createElement(nl,{linkFormat:i,onLinkClick:r,defaultSelectedKey:a.value},o))},changed:n}});Q.register("tab",_m,{effect:et.Transparent});const ft=F({card:{display:"flex",flexDirection:"column"},clickable:{cursor:"pointer"},header:{position:"absolute",left:0,bottom:0,right:0,padding:24,paddingBottom:16,color:f("$neutralPrimary"),display:"flex",justifyContent:"space-between",alignItems:"center"},content:{marginBottom:16,$nest:{"&:first-child":{marginTop:0},"h1, h2, h3, h4, h5, h6":{marginBlock:0,color:f("$neutralPrimary")},h1:{margin:ve(18,0),fontSize:20,fontWeight:600,letterSpacing:"-0.017em",lineHeight:ge(28)},h2:{margin:ve(12,0),fontSize:18,fontWeight:500,letterSpacing:"-0.014em",lineHeight:ge(25.2)},h3:{margin:ve(8,0),fontSize:16,fontWeight:400,letterSpacing:"-0.011em",lineHeight:ge(22.4)},p:{fontSize:14,letterSpacing:"-0.006em",lineHeight:ge(20),color:f("$text7"),marginBlock:0}}},body:{margin:ve(16,24,24,24)},img:{position:"relative",flexGrow:1,backgroundSize:"cover",backgroundRepeat:"no-repeat",backgroundPosition:"center"}}),Pm=V(({name:e,state:a,changed:n})=>{const{title:r,subtitle:l,image:i,name:o,items:s,content:c,value:d}=a,m=()=>{if(!!o){if(o.startsWith("#")){window.location.hash=o.substring(1);return}x.args[o]=o,x.push()}},u=()=>{const{r:h,g:y,b:k}=_e(ae("$card"))||{r:255,g:255,b:255};return`linear-gradient(rgba(${h}, ${y}, ${k}, 0) 0%, rgba(${h}, ${y}, ${k}, 0.5) 50%, ${f("$card")} 100%)`};return{render:()=>t.createElement("div",{"data-test":e,onClick:m,className:M(ft.card,o?ft.clickable:"")},t.createElement("div",{className:ft.img,style:{backgroundImage:`url('${i}')`}},t.createElement("div",{className:ft.header,style:{background:u()}},t.createElement("div",null,t.createElement("div",{className:"wave-s20 wave-w6"},r),l&&t.createElement("div",{className:"wave-s14 wave-w4 wave-t8"},l)),d&&t.createElement("div",{className:"wave-s16"},d))),(c||s)&&t.createElement("div",{className:ft.body},c&&t.createElement("div",{className:ft.content},t.createElement(Pe,{source:c})),s&&t.createElement(Ee,{items:s}))),changed:n}});Q.register("tall_article_preview",Pm);const ya=F({card:{display:"flex",flexDirection:"column",padding:se.gap,position:"relative"},body:{position:"relative",display:"flex",flexGrow:1},value_overlay:{position:"absolute",top:0,right:0,bottom:0,left:0,display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center"},aux_value:{color:"var(--text7)"}}),Tm=V(({name:e,state:a,changed:n})=>({render:()=>{const l=N.unpack(a.data);return t.createElement("div",{"data-test":e,className:ya.card},t.createElement(ne,{data:l,format:a.title,className:"wave-s12 wave-w6"}),t.createElement("div",{className:ya.body},t.createElement(Fn,{thickness:2,color:f(a.plot_color),value:a.progress}),t.createElement("div",{className:ya.value_overlay},t.createElement(ne,{data:l,format:a.value,className:"wave-s24 wave-w3"}),t.createElement(ne,{data:l,format:a.aux_value,className:M(ya.aux_value,"wave-s12")}))))},changed:n}));Q.register("tall_gauge_stat",Tm);const Dm={root:{fontSize:48,color:f("$neutralPrimary")}},Ve=F({card:{padding:24},imgContainer:L({},Je()),textContainer:{textAlign:"center"},clickable:{cursor:"pointer"},header:{marginTop:16,marginBottom:8},title:{color:f("$neutralPrimary")},category:{marginTop:-2,color:f("$themeDark")},iconWrapper:L({background:f("$text1"),height:80,width:80,boxSizing:"border-box",borderRadius:Ne(50)},Je()),img:{flexGrow:1,backgroundSize:"cover",backgroundRepeat:"no-repeat",backgroundPosition:"center"}}),Lm=V(({name:e,state:a,changed:n})=>{const{title:r,caption:l,icon:i,image:o,category:s,name:c,image_height:d="150px",label:m}=a,u=()=>{if(c.startsWith("#")){window.location.hash=c.substring(1);return}x.args[c]=c,x.push()};return{render:()=>t.createElement("div",{"data-test":e,onClick:c&&!m?u:void 0,className:M(Ve.card,c&&!m?Ve.clickable:"")},t.createElement("div",{className:Ve.imgContainer},o?t.createElement("div",{className:Ve.img,style:{backgroundImage:`url('${o}')`,height:d}}):t.createElement("div",{className:Ve.iconWrapper},t.createElement($e,{iconName:i||"MiniExpand",styles:Dm}))),t.createElement("div",{className:Ve.textContainer},t.createElement("div",{className:Ve.header},t.createElement("div",{className:M("wave-s20 wave-w6 wave-t9",Ve.title)},r),s&&t.createElement("div",{className:M("wave-s14 wave-w4 wave-t5",Ve.category)},s)),l&&t.createElement("div",{className:"wave-s14 wave-w4 wave-t7"},t.createElement(Pe,{source:l})),m&&t.createElement(Ue,{text:m,styles:{root:{marginTop:16}},onClick:u}))),changed:n}});Q.register("tall_info",Lm);const sn=F({card:{display:"flex",flexDirection:"column"},text:{padding:se.gap},aux_value:{color:"var(--text7)"}}),Am=V(({name:e,state:a,changed:n})=>({render:()=>{const l=N.unpack(a.data),i=a.plot_type==="interval"?t.createElement(On,{data:N.unpack(a.plot_data),category:a.plot_category,value:a.plot_value,color:f(a.plot_color),zeroValue:a.plot_zero_value}):t.createElement(Hn,{data:N.unpack(a.plot_data),value:a.plot_value,color:f(a.plot_color),zeroValue:a.plot_zero_value,curve:a.plot_curve||"linear"});return t.createElement("div",{"data-test":e,className:sn.card},t.createElement("div",{className:sn.text},t.createElement(ne,{data:l,format:a.title||"Untitled",className:"wave-s12 wave-w6"}),t.createElement(ne,{data:l,format:a.value,className:"wave-s24 wave-w3"}),t.createElement(ne,{data:l,format:a.aux_value,className:M(sn.aux_value,"wave-s12")})),i)},changed:n}));Q.register("tall_series_stat",Am);const Mr=F({card:{display:"flex",flexDirection:"column",textAlign:"center",padding:24,justifyContent:"space-around"},value:{color:f("$themePrimary")}}),Rm=V(({name:e,state:a,changed:n})=>({render:()=>t.createElement("div",{"data-test":e,className:Mr.card},a.items.map(({label:l,value:i},o)=>t.createElement("div",{key:`${o}-${l}`},i&&t.createElement("div",{className:M(Mr.value,"wave-s40 wave-w4")},i),t.createElement("div",{className:"wave-s14 wave-w2"},l)))),changed:n}));Q.register("tall_stats",Rm);const va=F({card:{padding:se.gap,display:"flex",flexDirection:"column"},content:{flexGrow:1,display:"flex",flexDirection:"column",justifyContent:"flex-end"},values:{display:"flex",alignItems:"baseline"},aux_value:{marginLeft:5,color:f("$text7")}}),Im=V(({name:e,state:a,changed:n})=>({render:()=>{const l=N.unpack(a.data);return t.createElement("div",{"data-test":e,className:va.card},t.createElement(ne,{data:l,format:a.title,className:"wave-s12 wave-w6"}),t.createElement("div",{className:va.content},t.createElement("div",{className:va.values},t.createElement(ne,{data:l,format:a.value,className:"wave-s18 wave-w3"}),t.createElement(ne,{data:l,format:a.aux_value,className:M(va.aux_value,"wave-s13")})),t.createElement(gi,{thickness:2,color:f(a.plot_color),value:a.progress})))},changed:n}));Q.register("wide_bar_stat",Im);const Ke=F({card:{display:"flex",padding:be(8,se.gap)},lhs:{position:"relative",width:"100%"},rhs:{marginLeft:se.gap,alignSelf:"center"},values:{display:"flex",alignItems:"baseline"},percentContainer:L({position:"absolute",top:0,right:0,bottom:0,left:0},Je()),percent:{opacity:.5},title:{overflow:"visible"},aux_value:{color:f("$text7"),marginLeft:5}}),zm=14,Bm=9,Fr=4,Mm=V(({name:e,state:a,changed:n})=>({render:()=>{const l=N.unpack(a.data),i=Ze(a.value,a.data),o=Ze(a.aux_value,a.data),s=i.match(/[^0-9-]/g).length,c=o.match(/[^0-9-]/g).length,d=zm*Math.max(i.length,Fr+s),m=Bm*Math.max(o.length,Fr+c);return t.createElement("div",{"data-test":e,className:Ke.card},t.createElement("div",{className:Ke.lhs},t.createElement(Fn,{thickness:2,color:f(a.plot_color),value:a.progress}),t.createElement("div",{className:Ke.percentContainer},t.createElement("div",{className:Ke.percent},`${Math.round(a.progress*100)}%`))),t.createElement("div",{className:Ke.rhs},t.createElement(ne,{data:l,format:a.title,className:M(Ke.title,"wave-s12 wave-w6")}),t.createElement("div",{className:Ke.values},t.createElement(ne,{data:l,format:a.value,style:{minWidth:d},className:"wave-s24 wave-w3"}),t.createElement(ne,{data:l,format:a.aux_value,style:{minWidth:m},className:M(Ke.aux_value,"wave-s13")}))))},changed:n}));Q.register("wide_gauge_stat",Mm);const Fm={root:{fontSize:48,color:f("$neutralPrimary"),fontWeight:600}},De=F({card:{display:"flex",padding:24},right:{flexDirection:"row-reverse"},rhs:{display:"flex",flexDirection:"column"},lhs:{textAlign:"center",display:"flex",marginRight:16},imgSpecified:{width:Ne(50),minWidth:Ne(50)},clickable:{cursor:"pointer"},title:{color:f("$neutralPrimary")},subtitle:{marginTop:1},category:{color:f("$themeDark"),marginBottom:-1},header:{marginTop:-5,marginBottom:13},iconWrapper:Z(L({},Je()),{background:f("$text1"),height:80,width:80,padding:8,boxSizing:"border-box",borderRadius:Ne(50)}),img:{flexGrow:1,backgroundSize:"cover",backgroundRepeat:"no-repeat",backgroundPosition:"center",borderRadius:4}}),Wm=V(({name:e,state:a,changed:n})=>{const{title:r,caption:l,icon:i,image:o,category:s,name:c,subtitle:d,label:m,align:u="left"}=a,g=()=>{if(c.startsWith("#")){window.location.hash=c.substring(1);return}x.args[c]=c,x.push()};return{render:()=>t.createElement("div",{"data-test":e,onClick:c&&!m?g:void 0,className:M(De.card,c&&!m?De.clickable:"",u==="right"?De.right:"")},t.createElement("div",{className:M(De.lhs,!i&&o?De.imgSpecified:"")},o?t.createElement("div",{className:De.img,style:{backgroundImage:`url('${o}')`}}):t.createElement($e,{iconName:i||"MiniExpand",className:De.iconWrapper,styles:Fm})),t.createElement("div",{className:De.rhs},t.createElement("div",{className:De.header},s&&t.createElement("div",{className:M("wave-s14 wave-w5 wave-t7",De.category)},s),t.createElement("div",{className:M("wave-s20 wave-w6",De.title)},r),d&&t.createElement("div",{className:M("wave-s14 wave-w5 wave-t7",De.subtitle)},d)),l&&t.createElement("div",{className:"wave-s14 wave-w4 wave-t7",style:{marginBottom:m?16:void 0}},t.createElement(Pe,{source:l})),m&&t.createElement(Oe,{onClick:g,text:m,styles:{root:{marginTop:"auto",alignSelf:"flex-start"}}}))),changed:n}});Q.register("wide_info",Wm);const Fe=F({card:{padding:24,display:"flex",justifyContent:"space-between",maxHeight:Ne(100)},lhs:{maxWidth:Ne(50),flexGrow:1},title:{color:f("$neutralPrimary"),marginBottom:24,marginTop:-7},value:{color:f("$neutralPrimary"),marginTop:-5},description:{marginLeft:4,marginBottom:16},label:{marginTop:-3,marginBottom:4},pie:{maxWidth:Ne(65),flexGrow:1,display:"flex"},pieText:{textAnchor:"middle",fontSize:10,fill:f("$neutralLighterAlt")},pieLegend:{display:"flex"},colorPreview:{borderRadius:4,minWidth:16,height:16}}),Hm=V(({name:e,state:a,changed:n})=>({render:()=>{const{title:l,pies:i}=a,o=ho().domain(i.map(({label:m})=>m)).range(i.map(({color:m})=>m)),s=0,c=50,d=Ea();return t.createElement("div",{"data-test":e,className:Fe.card},t.createElement("div",{className:Fe.lhs},t.createElement("div",{className:M("wave-s20 wave-w6",Fe.title)},l),i.map(({label:m,aux_value:u},g)=>t.createElement("div",{key:g,className:Fe.pieLegend},t.createElement("div",{className:Fe.colorPreview,style:{background:f(o(m))}}),t.createElement("div",{className:Fe.description},t.createElement("div",{className:M("wave-s16 wave-w6 wave-t7",Fe.label)},m),u&&t.createElement("div",{className:M("wave-s24 wave-w7",Fe.value)},u))))),t.createElement("div",{className:Fe.pie},t.createElement("svg",{viewBox:"0 0 100 100",width:"100%",height:"100%"},yo().value(m=>m.fraction)(i).map(({startAngle:m,endAngle:u,data:g},h)=>{const[y,k]=d.centroid({innerRadius:s,outerRadius:c,startAngle:m,endAngle:u});return t.createElement(t.Fragment,{key:h},t.createElement("path",{d:d({innerRadius:s,outerRadius:c,startAngle:m,endAngle:u}),fill:f(o(g.label)),transform:`translate(${c}, ${c})`}),t.createElement("text",{className:Fe.pieText,transform:`translate(${y+c}, ${k+c})`},g.value))}))))},changed:n}));Q.register("wide_pie_stat",Hm);const xa=F({card:{display:"flex",padding:24},lhs:{marginTop:-5,marginRight:16,width:Ne(35)},rhs:{width:Ne(65)},title:{color:f("$neutralPrimary"),marginBottom:13}}),Om=V(({name:e,state:a,changed:n})=>({render:()=>{const{title:l,caption:i,data:o,plot:s}=a;return t.createElement("div",{"data-test":e,className:xa.card},t.createElement("div",{className:xa.lhs},t.createElement("div",{className:M("wave-s20 wave-w5 wave-t9",xa.title)},l),i&&t.createElement("div",{className:"wave-s14 wave-w4 wave-t7"},i)),t.createElement("div",{className:xa.rhs},t.createElement(Mn,{model:{data:o,plot:s}})))},changed:n}));Q.register("wide_plot",Om);const ht=F({card:{display:"flex",padding:se.gap},plot:{width:"100%"},text:{paddingLeft:se.gap,alignSelf:"center"},values:{display:"flex",alignItems:"baseline"},value:{lineHeight:"28px"},aux_value:{color:f("$text7"),marginLeft:5}}),Vm=14,jm=9,Wr=4,Xm=V(({name:e,state:a,changed:n})=>({render:()=>{const l=N.unpack(a.data),i=a.plot_type==="interval"?t.createElement(On,{data:N.unpack(a.plot_data),category:a.plot_category,value:a.plot_value,color:f(a.plot_color),zeroValue:a.plot_zero_value}):t.createElement(Hn,{data:N.unpack(a.plot_data),value:a.plot_value,color:f(a.plot_color),zeroValue:a.plot_zero_value,curve:a.plot_curve||"linear"}),o=Ze(a.value,a.data),s=Ze(a.aux_value,a.data),c=o.match(/[^0-9-]/g).length,d=s.match(/[^0-9-]/g).length,m=Vm*Math.max(o.length,Wr+c),u=jm*Math.max(s.length,Wr+d);return t.createElement("div",{"data-test":e,className:ht.card},t.createElement("div",{className:ht.plot},i),t.createElement("div",{className:ht.text},t.createElement(ne,{data:l,format:a.title,className:"wave-s12 wave-w6"}),t.createElement("div",{className:ht.values},t.createElement(ne,{data:l,format:a.value,style:{minWidth:m},className:M(ht.value,"wave-s24 wave-w3")}),t.createElement(ne,{data:l,format:a.aux_value,style:{minWidth:u},className:M(ht.aux_value,"wave-s13")}))))},changed:n}));Q.register("wide_series_stat",Xm);const je=F({card:{display:"flex",flexDirection:"column",padding:24},clickable:{cursor:"pointer"},header:{display:"flex",justifyContent:"space-between",alignItems:"flex-end",marginBottom:24,$nest:{".ms-Persona-primaryText":{fontSize:16,lineHeight:ge(22),fontWeight:500},".ms-Persona-secondaryText":{fontSize:14,lineHeight:ge(20),color:f("$text7")},".ms-Persona-image":{height:ye("40px"),width:ye("40px")},".ms-Persona-imageArea":{height:ye("40px"),width:ye("40px")}}},aux_value:{marginBottom:4},content:{flex:1,display:"flex"},img:{marginRight:24,flex:1,backgroundSize:"cover",backgroundRepeat:"no-repeat",backgroundPosition:"center"},rhs:{flex:1,display:"flex",flexDirection:"column",justifyContent:"space-between"},items:{$nest:{"& .ms-Icon, & .ms-Button-label":{color:f("$text")}}},title:{marginBottom:8,lineHeight:.6}}),Um=V(({name:e,state:a,changed:n})=>({render:()=>{const{persona:l,aux_value:i,name:o,image:s,title:c,caption:d,items:m,content:u}=a,g=()=>{if(!!o){if(o.startsWith("#")){window.location.hash=o.substring(1);return}x.args[o]=o,x.push()}};return l.persona&&(l.persona.size="xs"),t.createElement("div",{"data-test":e,onClick:g,className:M(je.card,o?je.clickable:"")},t.createElement("div",{className:je.header},l.persona&&t.createElement(na,{model:l.persona}),i&&t.createElement("div",{className:M("wave-s12 wave-t7",je.aux_value)},i)),t.createElement("div",{className:je.content},t.createElement("div",{className:je.img,style:{backgroundImage:`url('${s}')`}}),t.createElement("div",{className:je.rhs},t.createElement("div",null,c&&t.createElement("div",{className:M("wave-s16 wave-w6",je.title)},c),(u||d)&&t.createElement("div",{style:{marginBottom:m?24:0},className:"wave-s14 wave-w4 wave-t7"},u?t.createElement(Pe,{source:u}):d)),m&&t.createElement("div",{className:je.items},t.createElement(Ee,{items:m})))))},changed:n}));Q.register("wide_article_preview",Um);const Gm=F({live:{backgroundColor:"#ff2938",color:"#fff",fontSize:11,fontWeight:700,letterSpacing:4,textAlign:"center",margin:ve(5,0,10),padding:be(2,0),borderRadius:2}}),qm=()=>t.createElement("div",null,t.createElement("svg",{width:"35.964439mm",height:"9.0737419mm",viewBox:"0 0 35.964439 9.0737419"},t.createElement("g",{transform:"matrix(0.54446153,0,0,0.54446153,-16.152559,-20.599374)"},t.createElement("path",{d:"m 44.823532,48.430372 q 0,0.633406 -0.452432,1.085839 -0.429811,0.429811 -1.063217,0.429811 h -5.564924 l -5.632788,4.230247 q -0.384568,0.294081 -0.837,0.316703 -0.452433,0.04524 -0.859623,-0.203595 -0.339324,-0.203595 -0.542919,-0.54292 -0.203595,-0.339324 -0.203595,-0.769135 v -9.093899 q 0,-0.633406 0.429811,-1.063217 0.452433,-0.452433 1.085839,-0.452433 0.633406,0 1.063217,0.452433 0.452433,0.429811 0.452433,1.063217 v 6.062599 l 3.642084,-2.737218 q 0.407189,-0.294082 0.904865,-0.294082 h 4.54695 v -3.031299 q 0,-0.633406 0.429811,-1.063217 0.452433,-0.452433 1.085839,-0.452433 0.633406,0 1.063217,0.452433 0.452432,0.429811 0.452432,1.063217 z"}),t.createElement("path",{d:"m 61.789719,48.430372 q 0,0.633406 -0.452433,1.085839 -0.429811,0.429811 -1.063217,0.429811 -0.633406,0 -1.085839,-0.429811 -0.429811,-0.452433 -0.429811,-1.085839 v -6.062599 l -9.704683,7.261546 q -0.520298,0.384568 -1.153704,0.316703 -0.633405,-0.09049 -1.017973,-0.633406 -0.384568,-0.520298 -0.27146,-1.10846 0.09049,-0.610784 0.588163,-0.995352 l 12.14782,-9.071278 q 0.361946,-0.271459 0.791757,-0.294081 0.429811,-0.04524 0.791758,0.13573 0.384568,0.158351 0.610784,0.520298 0.248838,0.361946 0.248838,0.837 z"}),t.createElement("path",{d:"m 78.507067,43.001179 q 0.384568,0.520297 0.27146,1.131082 -0.09049,0.588162 -0.588162,0.97273 l -12.147821,9.071278 q -0.384568,0.271459 -0.814379,0.294081 -0.407189,0.04524 -0.791757,-0.13573 -0.361946,-0.158351 -0.610784,-0.520298 -0.226217,-0.361946 -0.226217,-0.837 v -9.093899 q 0,-0.633406 0.429811,-1.063217 0.452433,-0.452433 1.085839,-0.452433 0.633406,0 1.063217,0.452433 0.452433,0.429811 0.452433,1.063217 v 6.062599 l 9.704683,-7.261546 q 0.520298,-0.384568 1.153704,-0.294081 0.633406,0.06786 1.017973,0.610784 z"}),t.createElement("path",{d:"m 95.722092,52.977322 q 0,0.633406 -0.452433,1.063217 -0.429811,0.452433 -1.063217,0.452433 h -6.062599 q -0.633406,0 -1.085839,-0.452433 -0.429811,-0.429811 -0.429811,-1.063217 v -3.0313 h -4.546949 q -0.633406,0 -1.085839,-0.429811 -0.429811,-0.452433 -0.429811,-1.085839 v -4.546949 q 0,-0.633406 0.429811,-1.063217 0.452433,-0.452433 1.085839,-0.452433 h 12.125198 q 0.633406,0 1.063217,0.452433 0.452433,0.429811 0.452433,1.063217 0,0.633406 -0.452433,1.085838 -0.429811,0.429812 -1.063217,0.429812 H 83.596893 v 1.515649 h 4.54695 q 0.633406,0 1.063217,0.452433 0.452433,0.429811 0.452433,1.063217 v 3.0313 h 4.546949 q 0.633406,0 1.063217,0.429811 0.452433,0.452433 0.452433,1.085839 z"}))),t.createElement("div",{className:M("wave-pulse",Gm.live)},"LIVE")),Qm={xs:"0px",s:"576px",m:"768px",l:"992px",xl:"1200px"},Hr=N.box([]),Cn=N.box(null),fi=N.box(),Or=e=>{var a;return parseInt((a=Qm[e])!=null?a:e,10)},Vr={order:0},Km=({zone:e,order:a,size:n,width:r,height:l})=>({zone:e,order:a||0,grow:n?N.parseU(n):NaN,width:r,height:l}),Ym=(e,a)=>{try{if(a[0]==="["){const n=JSON.parse(a);if(a=n[e],a||(a=n[0]),!a)return Vr}return a[0]==="{"?Km(JSON.parse(a)):{zone:a,order:0}}catch{return Vr}},Jm=(e,a)=>{const n=[],r=[];for(const l of e)(a(l)?n:r).push(l);return[n,r]};N.on(Ba,e=>{const a=e.map((n,r)=>{const l=e[r+1],i=Or(n.breakpoint),o=l?Or(l.breakpoint)-1:0,s=window.matchMedia(o?`(min-width:${i}px) and (max-width:${o}.98px)`:`(min-width:${i}px)`),c=m=>{m.matches&&(Cn({layout:n,index:r}),fi({}))},d={layout:n,min:i,max:o,mq:s,listener:c};return s.addListener(c),s.matches&&Cn({layout:n,index:r}),d});for(const{mq:n,listener:r}of Hr())n.removeListener(r);Hr(a)});const Zm=F({flex:{position:"relative",display:"flex"}}),eu=(e,a)=>{var r,l,i;const n={flexDirection:e.direction==="row"?"row":"column",justifyContent:Dn[(r=e.justify)!=null?r:""],alignItems:hl[(l=e.align)!=null?l:""],alignContent:yl[(i=e.wrap)!=null?i:""],flexWrap:e.wrap?"wrap":void 0};if(e.size){const o=N.parseU(e.size);isNaN(o)?a==="row"?(n.width=e.size,n.minWidth=e.size):(n.height=e.size,n.minHeight=e.size):o>0&&(n.flexGrow=o)}else a==="row"&&(n.flexGrow=1);return n},tu=({card:e,slot:a})=>{const{width:n,height:r,grow:l}=a,i=e.name==="__unhandled_error__"?1:void 0,o={position:"relative",zIndex:i};return l||l===0||n||r?(l&&(o.flexGrow=l),n&&(o.width=n),r&&(o.height=r),(n==="0px"||r==="0px")&&(o.margin=0)):o.flexGrow=1,o},hi=e=>{var a;return{zone:e,sections:(a=e.zones)==null?void 0:a.map(hi),cardslots:[]}},yi=(e,a)=>{const{zone:n,sections:r}=e;if(n.name===a)return e;if(r)for(const l of r){const i=yi(l,a);if(i)return i}return null},vi=e=>{const{sections:a}=e;if(a)for(const n of a)vi(n);e.cardslots.sort((n,r)=>n.slot.order-r.slot.order)},xi=({section:e,hasEditor:a,direction:n})=>{const{zone:r,cardslots:l,sections:i}=e,o=i?i.map(s=>t.createElement(xi,{key:s.zone.name,section:s,hasEditor:a,direction:r.direction})):l.length?l.map(s=>{const{card:c}=s;return t.createElement("div",{key:c.id,className:Sl(c),style:tu(s)},t.createElement(aa,{card:c}),t.createElement(An,{name:c.name,commands:c.state.commands,changedB:c.changed,canEdit:a}))}):null;return t.createElement("div",{"data-test":r.name,className:Zm.flex,style:eu(r,n)},o)},au=({name:e,cards:a})=>{var y;const n=Cn();if(!n)return t.createElement(t.Fragment,null);const{layout:r,index:l}=n,i=hi({name:"__main__",zones:r.zones,size:"1"}),{width:o,min_width:s,max_width:c,height:d,min_height:m,max_height:u}=r,g=a.find(k=>k.state.view==="editor");for(const k of a){const _=Ym(l,k.state.box),b=yi(i,(y=_.zone)!=null?y:"");b==null||b.cardslots.push({card:k,slot:_})}vi(i);const h={display:"flex",flexDirection:"column",width:o!=null?o:"100%",minWidth:s,maxWidth:c,height:d,minHeight:m,maxHeight:u};return d==="100%"&&(h.display="flex",h.flexDirection="column"),t.createElement("div",{"data-test":e,style:h},t.createElement(xi,{section:i,hasEditor:!!g}),g&&t.createElement(aa,{card:g}))},nu=V(({page:e})=>{let a=null,n=null;const{changed:r}=e;return{render:()=>{const i=e.items(),[o,s]=Jm(i,c=>c.state.view==="meta");return o.length&&(n==null||n.dispose(),a=o[0],Lr(a),n=N.on(a.changed,()=>Lr(a))),Ba().length?t.createElement(au,{name:e.key,cards:s}):t.createElement(Go,{name:e.key,cards:s})},changed:r,resizedB:fi}}),Se=F({app:{position:"absolute",left:0,top:0,right:0,bottom:0,backgroundColor:f("$page"),color:f("$text"),display:"flex",justifyContent:"center",overflow:"auto"},centerFullHeight:{height:Ne(100),display:"flex",justifyContent:"center",alignItems:"center",backgroundColor:f("$page"),color:f("$text")},freeOverlay:{position:"fixed",left:0,top:0,right:0,bottom:0,opacity:0,zIndex:-1},busyOverlay:{position:"fixed",left:0,top:0,right:0,bottom:0,opacity:.8,zIndex:999,transition:"opacity 500ms 500ms"},notFoundOverlay:{display:"flex",flexDirection:"column",alignItems:"center"}}),ru=V(()=>({render:()=>t.createElement("div",{className:$a()?Se.busyOverlay:Se.freeOverlay},t.createElement(_n,{className:Se.centerFullHeight,label:"Loading...",size:Pn.large})),busyB:$a})),lu=V(()=>{const e=N.box(!1),a=()=>{e(!0)};return{render:()=>t.createElement("div",{className:Se.notFoundOverlay},t.createElement(qm,null),Na.editable&&t.createElement(t.Fragment,null,t.createElement(Ue,{onClick:a},"Edit this page..."),t.createElement(Ud,{visibleB:e})))}}),iu=V(()=>{const e=()=>x.push(),a=({detail:i})=>{x.args[i]=!0,x.push()};return{init:()=>{Bo(x.socketURL),window.addEventListener("hashchange",e),window.addEventListener("md-link-click",a)},render:()=>{const i=Ca();if(i)switch(i.t){case N.WaveEventType.Page:{const o=i.page,s=Ct();return t.createElement(vo,null,t.createElement("div",{className:Se.app},t.createElement(nu,{key:o.key,page:o}),t.createElement(ru,null),t.createElement(Sd,null),t.createElement(Id,null),t.createElement(Nd,null),s&&t.createElement(Es,L({},s))))}case N.WaveEventType.Error:{const o=i.code===N.WaveErrorCode.PageNotFound?t.createElement(lu,null):"Unknown Remote Error";return t.createElement("div",{className:M(Se.centerFullHeight,Se.app)},o)}case N.WaveEventType.Exception:{const o=`Unhandled exception: ${i.error}`;return t.createElement("div",{className:M(Se.centerFullHeight,Se.app)},o)}case N.WaveEventType.Disconnect:{const o=`Disconnected. Reconnecting in ${i.retry}s`;return t.createElement("div",{className:M(Se.centerFullHeight,Se.app,Se.notFoundOverlay)},t.createElement("div",null,o),t.createElement("div",null,"Make sure your Wave server is running and the environment network policies allow websocket connections."))}}return t.createElement(_n,{className:Se.centerFullHeight,size:Pn.large,label:"Loading ..."})},dispose:()=>{window.removeEventListener("hashchange",e),window.removeEventListener("md-link-click",a)},contentB:Ca,lightboxB:Ct}}),ou=F({login:{width:"100%",minHeight:"100vh",display:"flex",alignItems:"center",justifyContent:"center",flexDirection:"column"}}),su=()=>{const e=`${x.initURL}${window.location.search}`;return t.createElement("div",{className:ou.login},t.createElement("form",{action:e,method:"POST"},t.createElement(dn,{type:"default",secondaryText:"using OpenID Connect."},"Log In")))},cu=()=>{const e=[{path:x.loginURL,exact:!0,render:()=>t.createElement(su,null)},{path:x.baseURL,exact:!1,render:()=>t.createElement(iu,null)}];return t.createElement(xo,null,t.createElement(bo,null,e.map((a,n)=>t.createElement(Eo,{key:n,path:a.path,exact:a.exact,render:a.render}))))};Boolean(window.location.hostname==="localhost"||window.location.hostname==="[::1]"||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function du(){"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(e=>{e.unregister()}).catch(e=>{console.error(e.message)})}Xr({defaultFontStyle:{fontFamily:"Inter"},palette:No.fluentPalette});const mu=Object.entries(wo).reduce((e,[a,n])=>("displayName"in n&&(e[a.slice(0,-4)]=t.createElement(n)),e),{});ko({icons:mu});Zr.render(t.createElement(cu,null),document.getElementById("root"));du();export{gu as __vite_legacy_guard};
